{"file_contents":{"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = await res.text();\n    try {\n      const json = JSON.parse(text);\n      throw json;\n    } catch (e) {\n      if (e instanceof SyntaxError) {\n        throw new Error(`${res.status}: ${text || res.statusText}`);\n      }\n      throw e;\n    }\n  }\n}\n\nfunction getAuthHeaders(): Record<string, string> {\n  const token = localStorage.getItem(\"authToken\");\n  const headers: Record<string, string> = {};\n  if (token) {\n    headers[\"Authorization\"] = `Bearer ${token}`;\n  }\n  return headers;\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<unknown> {\n  const headers: Record<string, string> = {\n    ...getAuthHeaders(),\n  };\n  if (data) {\n    headers[\"Content-Type\"] = \"application/json\";\n  }\n  \n  const res = await fetch(url, {\n    method,\n    headers,\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res.json();\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey[0] as string, {\n      headers: getAuthHeaders(),\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","path":null,"size_bytes":1899,"size_tokens":null},"client/src/components/language-selector.tsx":{"content":"import { useTranslation } from \"react-i18next\";\nimport { Globe } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\n\nconst languages = [\n  { code: \"en\", name: \"English\", flag: \"GB\" },\n  { code: \"tr\", name: \"Turkce\", flag: \"TR\" },\n  { code: \"de\", name: \"Deutsch\", flag: \"DE\" },\n];\n\nexport function LanguageSelector() {\n  const { i18n } = useTranslation();\n\n  const currentLanguage = languages.find((l) => l.code === i18n.language) || languages[0];\n\n  return (\n    <DropdownMenu>\n      <DropdownMenuTrigger asChild>\n        <Button variant=\"ghost\" size=\"icon\" data-testid=\"button-language-selector\">\n          <Globe className=\"h-5 w-5\" />\n          <span className=\"sr-only\">Select language</span>\n        </Button>\n      </DropdownMenuTrigger>\n      <DropdownMenuContent align=\"end\">\n        {languages.map((language) => (\n          <DropdownMenuItem\n            key={language.code}\n            onClick={() => i18n.changeLanguage(language.code)}\n            className={language.code === currentLanguage.code ? \"bg-accent\" : \"\"}\n            data-testid={`menu-item-language-${language.code}`}\n          >\n            <span className=\"mr-2 text-lg\">{language.flag === \"GB\" ? \"ðŸ‡¬ðŸ‡§\" : language.flag === \"TR\" ? \"ðŸ‡¹ðŸ‡·\" : \"ðŸ‡©ðŸ‡ª\"}</span>\n            {language.name}\n          </DropdownMenuItem>\n        ))}\n      </DropdownMenuContent>\n    </DropdownMenu>\n  );\n}\n","path":null,"size_bytes":1519,"size_tokens":null},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\" +\n  \" hover-elevate active-elevate-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"bg-primary text-primary-foreground border border-primary-border\",\n        destructive:\n          \"bg-destructive text-destructive-foreground border border-destructive-border\",\n        outline:\n          // Shows the background color of whatever card / sidebar / accent background it is inside of.\n          // Inherits the current text color.\n          \" border [border-color:var(--button-outline)]  shadow-xs active:shadow-none \",\n        secondary: \"border bg-secondary text-secondary-foreground border border-secondary-border \",\n        // Add a transparent border so that when someone toggles a border on later, it doesn't shift layout/size.\n        ghost: \"border border-transparent\",\n      },\n      // Heights are set as \"min\" heights, because sometimes Ai will place large amount of content\n      // inside buttons. With a min-height they will look appropriate with small amounts of content,\n      // but will expand to fit large amounts of content.\n      size: {\n        default: \"min-h-9 px-4 py-2\",\n        sm: \"min-h-8 rounded-md px-3 text-xs\",\n        lg: \"min-h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  },\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  },\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","path":null,"size_bytes":2359,"size_tokens":null},"server/db.ts":{"content":"import { drizzle } from \"drizzle-orm/node-postgres\";\nimport pg from \"pg\";\nimport * as schema from \"@shared/schema\";\n\nconst { Pool } = pg;\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\n    \"DATABASE_URL must be set. Did you forget to provision a database?\",\n  );\n}\n\nexport const pool = new Pool({ connectionString: process.env.DATABASE_URL });\nexport const db = drizzle(pool, { schema });\n","path":null,"size_bytes":395,"size_tokens":null},"client/src/pages/tutorials.tsx":{"content":"import { useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { \n  PlayCircle, \n  FileText, \n  Bell, \n  ExternalLink,\n  Download,\n  Clock\n} from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardFooter, CardHeader } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport type { Tutorial } from \"@shared/schema\";\n\nexport default function TutorialsPage() {\n  const { t } = useTranslation();\n  const [activeTab, setActiveTab] = useState<\"video\" | \"pdf\" | \"announcement\">(\"video\");\n\n  const { data: tutorials, isLoading } = useQuery<Tutorial[]>({\n    queryKey: [\"/api/tutorials\"],\n  });\n\n  const filteredTutorials = tutorials?.filter((tutorial) => tutorial.type === activeTab);\n\n  const formatDate = (date: string | Date) => {\n    return new Date(date).toLocaleDateString(undefined, {\n      year: \"numeric\",\n      month: \"short\",\n      day: \"numeric\",\n    });\n  };\n\n  const getTypeIcon = (type: string) => {\n    switch (type) {\n      case \"video\":\n        return <PlayCircle className=\"h-5 w-5\" />;\n      case \"pdf\":\n        return <FileText className=\"h-5 w-5\" />;\n      case \"announcement\":\n        return <Bell className=\"h-5 w-5\" />;\n      default:\n        return <FileText className=\"h-5 w-5\" />;\n    }\n  };\n\n  const renderVideoTutorial = (tutorial: Tutorial) => (\n    <Card key={tutorial.id} className=\"overflow-hidden\" data-testid={`card-tutorial-${tutorial.id}`}>\n      <CardHeader className=\"p-0 relative\">\n        <div className=\"aspect-video bg-muted flex items-center justify-center relative\">\n          {tutorial.thumbnailUrl ? (\n            <img\n              src={tutorial.thumbnailUrl}\n              alt={tutorial.title}\n              className=\"w-full h-full object-cover\"\n            />\n          ) : (\n            <PlayCircle className=\"h-16 w-16 text-muted-foreground\" />\n          )}\n          <div className=\"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity\">\n            <PlayCircle className=\"h-16 w-16 text-white\" />\n          </div>\n        </div>\n      </CardHeader>\n      <CardContent className=\"p-4\">\n        <h3 className=\"font-medium line-clamp-2\" data-testid={`text-tutorial-title-${tutorial.id}`}>\n          {tutorial.title}\n        </h3>\n        {tutorial.description && (\n          <p className=\"text-sm text-muted-foreground line-clamp-2 mt-2\">\n            {tutorial.description}\n          </p>\n        )}\n        <div className=\"flex items-center gap-2 mt-3 text-xs text-muted-foreground\">\n          <Clock className=\"h-3 w-3\" />\n          <span>{formatDate(tutorial.createdAt)}</span>\n        </div>\n      </CardContent>\n      <CardFooter className=\"p-4 pt-0\">\n        <Button className=\"w-full\" asChild data-testid={`button-watch-${tutorial.id}`}>\n          <a href={tutorial.contentUrl || \"#\"} target=\"_blank\" rel=\"noopener noreferrer\">\n            <PlayCircle className=\"h-4 w-4 mr-2\" />\n            {t(\"tutorials.watch\")}\n          </a>\n        </Button>\n      </CardFooter>\n    </Card>\n  );\n\n  const renderPdfTutorial = (tutorial: Tutorial) => (\n    <Card key={tutorial.id} data-testid={`card-tutorial-${tutorial.id}`}>\n      <CardHeader className=\"flex flex-row items-start gap-4\">\n        <div className=\"flex h-12 w-12 items-center justify-center rounded-md bg-primary/10 text-primary\">\n          <FileText className=\"h-6 w-6\" />\n        </div>\n        <div className=\"flex-1 min-w-0\">\n          <h3 className=\"font-medium line-clamp-1\" data-testid={`text-tutorial-title-${tutorial.id}`}>\n            {tutorial.title}\n          </h3>\n          {tutorial.description && (\n            <p className=\"text-sm text-muted-foreground line-clamp-2 mt-1\">\n              {tutorial.description}\n            </p>\n          )}\n        </div>\n      </CardHeader>\n      <CardContent>\n        <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n          <Clock className=\"h-3 w-3\" />\n          <span>{formatDate(tutorial.createdAt)}</span>\n        </div>\n      </CardContent>\n      <CardFooter className=\"gap-2\">\n        <Button variant=\"outline\" className=\"flex-1\" asChild data-testid={`button-view-${tutorial.id}`}>\n          <a href={tutorial.contentUrl || \"#\"} target=\"_blank\" rel=\"noopener noreferrer\">\n            <ExternalLink className=\"h-4 w-4 mr-2\" />\n            {t(\"common.view\")}\n          </a>\n        </Button>\n        <Button className=\"flex-1\" asChild data-testid={`button-download-${tutorial.id}`}>\n          <a href={tutorial.contentUrl || \"#\"} download>\n            <Download className=\"h-4 w-4 mr-2\" />\n            {t(\"tutorials.download\")}\n          </a>\n        </Button>\n      </CardFooter>\n    </Card>\n  );\n\n  const renderAnnouncement = (tutorial: Tutorial) => (\n    <Card key={tutorial.id} data-testid={`card-tutorial-${tutorial.id}`}>\n      <CardHeader>\n        <div className=\"flex items-center gap-2\">\n          <Badge variant=\"secondary\">\n            <Bell className=\"h-3 w-3 mr-1\" />\n            Announcement\n          </Badge>\n          <span className=\"text-xs text-muted-foreground\">{formatDate(tutorial.createdAt)}</span>\n        </div>\n        <h3 className=\"font-medium text-lg\" data-testid={`text-tutorial-title-${tutorial.id}`}>\n          {tutorial.title}\n        </h3>\n      </CardHeader>\n      <CardContent>\n        <p className=\"text-muted-foreground\">{tutorial.description}</p>\n      </CardContent>\n      {tutorial.contentUrl && (\n        <CardFooter>\n          <Button variant=\"outline\" asChild data-testid={`button-read-more-${tutorial.id}`}>\n            <a href={tutorial.contentUrl} target=\"_blank\" rel=\"noopener noreferrer\">\n              {t(\"tutorials.readMore\")}\n              <ExternalLink className=\"h-4 w-4 ml-2\" />\n            </a>\n          </Button>\n        </CardFooter>\n      )}\n    </Card>\n  );\n\n  const renderTutorials = () => {\n    if (isLoading) {\n      return (\n        <div className={activeTab === \"video\" \n          ? \"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\"\n          : \"grid grid-cols-1 md:grid-cols-2 gap-6\"\n        }>\n          {Array.from({ length: 6 }).map((_, i) => (\n            <Card key={i}>\n              <CardHeader className={activeTab === \"video\" ? \"p-0\" : \"\"}>\n                {activeTab === \"video\" ? (\n                  <Skeleton className=\"aspect-video w-full\" />\n                ) : (\n                  <div className=\"flex items-center gap-4\">\n                    <Skeleton className=\"h-12 w-12 rounded-md\" />\n                    <div className=\"flex-1\">\n                      <Skeleton className=\"h-4 w-3/4 mb-2\" />\n                      <Skeleton className=\"h-3 w-1/2\" />\n                    </div>\n                  </div>\n                )}\n              </CardHeader>\n              {activeTab === \"video\" && (\n                <CardContent className=\"p-4\">\n                  <Skeleton className=\"h-4 w-3/4 mb-2\" />\n                  <Skeleton className=\"h-3 w-full\" />\n                </CardContent>\n              )}\n            </Card>\n          ))}\n        </div>\n      );\n    }\n\n    if (!filteredTutorials?.length) {\n      return (\n        <div className=\"flex flex-col items-center justify-center h-64 text-muted-foreground\">\n          {getTypeIcon(activeTab)}\n          <p className=\"mt-4\">{t(\"tutorials.noTutorials\")}</p>\n        </div>\n      );\n    }\n\n    if (activeTab === \"video\") {\n      return (\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n          {filteredTutorials.map(renderVideoTutorial)}\n        </div>\n      );\n    }\n\n    if (activeTab === \"pdf\") {\n      return (\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          {filteredTutorials.map(renderPdfTutorial)}\n        </div>\n      );\n    }\n\n    return (\n      <div className=\"space-y-4\">\n        {filteredTutorials.map(renderAnnouncement)}\n      </div>\n    );\n  };\n\n  return (\n    <div className=\"flex flex-col h-full\">\n      <div className=\"flex items-center justify-between gap-4 p-6 border-b\">\n        <h1 className=\"text-2xl font-semibold\" data-testid=\"text-page-title\">\n          {t(\"tutorials.title\")}\n        </h1>\n      </div>\n\n      <div className=\"flex-1 overflow-auto p-6\">\n        <Tabs value={activeTab} onValueChange={(v) => setActiveTab(v as \"video\" | \"pdf\" | \"announcement\")}>\n          <TabsList className=\"mb-6\">\n            <TabsTrigger value=\"video\" data-testid=\"tab-videos\">\n              <PlayCircle className=\"h-4 w-4 mr-2\" />\n              {t(\"tutorials.videos\")}\n            </TabsTrigger>\n            <TabsTrigger value=\"pdf\" data-testid=\"tab-documents\">\n              <FileText className=\"h-4 w-4 mr-2\" />\n              {t(\"tutorials.documents\")}\n            </TabsTrigger>\n            <TabsTrigger value=\"announcement\" data-testid=\"tab-announcements\">\n              <Bell className=\"h-4 w-4 mr-2\" />\n              {t(\"tutorials.announcements\")}\n            </TabsTrigger>\n          </TabsList>\n\n          <TabsContent value={activeTab} className=\"mt-0\">\n            {renderTutorials()}\n          </TabsContent>\n        </Tabs>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":9308,"size_tokens":null},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","path":null,"size_bytes":261,"size_tokens":null},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","path":null,"size_bytes":10481,"size_tokens":null},"server/storage.ts":{"content":"import { eq, and, or, desc, ilike } from \"drizzle-orm\";\nimport { db } from \"./db\";\nimport {\n  users, tenants, subscriptions, products, templates,\n  campaigns, campaignProducts, messages, suggestions, tutorials, systemConfig, productConnectors, joinRequests,\n  type User, type InsertUser, type Tenant, type InsertTenant,\n  type Subscription, type InsertSubscription, type Product, type InsertProduct,\n  type Template, type InsertTemplate, type Campaign, type InsertCampaign,\n  type CampaignProduct, type InsertCampaignProduct, type Message, type InsertMessage,\n  type Suggestion, type InsertSuggestion, type Tutorial, type InsertTutorial,\n  type SystemConfig, type InsertSystemConfig, type ProductConnector, type InsertProductConnector,\n  type JoinRequest, type InsertJoinRequest\n} from \"@shared/schema\";\n\nexport interface IStorage {\n  getUser(id: string): Promise<User | undefined>;\n  getUserByEmail(email: string): Promise<User | undefined>;\n  getUserByActivationToken(token: string): Promise<User | undefined>;\n  createUser(user: InsertUser): Promise<User>;\n  updateUser(id: string, data: Partial<InsertUser>): Promise<User | undefined>;\n  deleteUser(id: string): Promise<boolean>;\n  getUsersByTenant(tenantId: string): Promise<User[]>;\n\n  getTenant(id: string): Promise<Tenant | undefined>;\n  getTenantBySlug(slug: string): Promise<Tenant | undefined>;\n  getAllTenants(): Promise<Tenant[]>;\n  createTenant(tenant: InsertTenant): Promise<Tenant>;\n  updateTenant(id: string, data: Partial<InsertTenant>): Promise<Tenant | undefined>;\n  deleteTenant(id: string): Promise<boolean>;\n\n  getSubscription(id: string): Promise<Subscription | undefined>;\n  getSubscriptionByTenant(tenantId: string): Promise<Subscription | undefined>;\n  createSubscription(subscription: InsertSubscription): Promise<Subscription>;\n  updateSubscription(id: string, data: Partial<InsertSubscription>): Promise<Subscription | undefined>;\n\n  getProduct(id: string): Promise<Product | undefined>;\n  getProductsByTenant(tenantId: string): Promise<Product[]>;\n  createProduct(product: InsertProduct): Promise<Product>;\n  updateProduct(id: string, data: Partial<InsertProduct>): Promise<Product | undefined>;\n  deleteProduct(id: string): Promise<boolean>;\n\n  getTemplate(id: string): Promise<Template | undefined>;\n  getTemplatesByTenant(tenantId: string): Promise<Template[]>;\n  getGlobalTemplates(): Promise<Template[]>;\n  createTemplate(template: InsertTemplate): Promise<Template>;\n  updateTemplate(id: string, data: Partial<InsertTemplate>): Promise<Template | undefined>;\n  deleteTemplate(id: string): Promise<boolean>;\n\n  getCampaign(id: string): Promise<Campaign | undefined>;\n  getCampaignsByTenant(tenantId: string): Promise<Campaign[]>;\n  createCampaign(campaign: InsertCampaign): Promise<Campaign>;\n  updateCampaign(id: string, data: Partial<InsertCampaign>): Promise<Campaign | undefined>;\n  deleteCampaign(id: string): Promise<boolean>;\n\n  getCampaignProducts(campaignId: string): Promise<CampaignProduct[]>;\n  addCampaignProduct(data: InsertCampaignProduct): Promise<CampaignProduct>;\n  removeCampaignProduct(id: string): Promise<boolean>;\n\n  getMessage(id: string): Promise<Message | undefined>;\n  getMessagesByUser(userId: string): Promise<Message[]>;\n  getMessagesByTenant(tenantId: string): Promise<Message[]>;\n  createMessage(message: InsertMessage): Promise<Message>;\n  markMessageRead(id: string): Promise<Message | undefined>;\n  deleteMessage(id: string): Promise<boolean>;\n\n  getSuggestion(id: string): Promise<Suggestion | undefined>;\n  getSuggestionsByTenant(tenantId: string): Promise<Suggestion[]>;\n  getAllSuggestions(): Promise<Suggestion[]>;\n  createSuggestion(suggestion: InsertSuggestion): Promise<Suggestion>;\n  updateSuggestion(id: string, data: Partial<InsertSuggestion>): Promise<Suggestion | undefined>;\n  deleteSuggestion(id: string): Promise<boolean>;\n\n  getTutorial(id: string): Promise<Tutorial | undefined>;\n  getAllTutorials(): Promise<Tutorial[]>;\n  createTutorial(tutorial: InsertTutorial): Promise<Tutorial>;\n  updateTutorial(id: string, data: Partial<InsertTutorial>): Promise<Tutorial | undefined>;\n  deleteTutorial(id: string): Promise<boolean>;\n\n  getSystemConfig(key: string): Promise<SystemConfig | undefined>;\n  setSystemConfig(key: string, value: any): Promise<SystemConfig>;\n\n  getProductConnector(id: string): Promise<ProductConnector | undefined>;\n  getAllProductConnectors(): Promise<ProductConnector[]>;\n  getEnabledProductConnectors(): Promise<ProductConnector[]>;\n  createProductConnector(connector: InsertProductConnector): Promise<ProductConnector>;\n  updateProductConnector(id: string, data: Partial<InsertProductConnector>): Promise<ProductConnector | undefined>;\n  deleteProductConnector(id: string): Promise<boolean>;\n\n  getTenantByCode(code: string): Promise<Tenant | undefined>;\n  \n  getJoinRequest(id: string): Promise<JoinRequest | undefined>;\n  getJoinRequestsByTenant(tenantId: string): Promise<JoinRequest[]>;\n  getJoinRequestsByUser(userId: string): Promise<JoinRequest[]>;\n  getPendingJoinRequestsByTenant(tenantId: string): Promise<JoinRequest[]>;\n  createJoinRequest(request: InsertJoinRequest): Promise<JoinRequest>;\n  updateJoinRequest(id: string, data: Partial<InsertJoinRequest>): Promise<JoinRequest | undefined>;\n  deleteJoinRequest(id: string): Promise<boolean>;\n}\n\nexport class DatabaseStorage implements IStorage {\n  async getUser(id: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.id, id));\n    return user;\n  }\n\n  async getUserByEmail(email: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.email, email));\n    return user;\n  }\n\n  async getUserByActivationToken(token: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.activationToken, token));\n    return user;\n  }\n\n  async createUser(user: InsertUser): Promise<User> {\n    const [created] = await db.insert(users).values(user).returning();\n    return created;\n  }\n\n  async updateUser(id: string, data: Partial<InsertUser>): Promise<User | undefined> {\n    const [updated] = await db.update(users).set(data).where(eq(users.id, id)).returning();\n    return updated;\n  }\n\n  async deleteUser(id: string): Promise<boolean> {\n    const result = await db.delete(users).where(eq(users.id, id));\n    return true;\n  }\n\n  async getUsersByTenant(tenantId: string): Promise<User[]> {\n    return db.select().from(users).where(eq(users.tenantId, tenantId));\n  }\n\n  async getTenant(id: string): Promise<Tenant | undefined> {\n    const [tenant] = await db.select().from(tenants).where(eq(tenants.id, id));\n    return tenant;\n  }\n\n  async getTenantBySlug(slug: string): Promise<Tenant | undefined> {\n    const [tenant] = await db.select().from(tenants).where(eq(tenants.slug, slug));\n    return tenant;\n  }\n\n  async createTenant(tenant: InsertTenant): Promise<Tenant> {\n    const [created] = await db.insert(tenants).values(tenant).returning();\n    return created;\n  }\n\n  async updateTenant(id: string, data: Partial<InsertTenant>): Promise<Tenant | undefined> {\n    const [updated] = await db.update(tenants).set(data).where(eq(tenants.id, id)).returning();\n    return updated;\n  }\n\n  async getAllTenants(): Promise<Tenant[]> {\n    return db.select().from(tenants).orderBy(desc(tenants.createdAt));\n  }\n\n  async deleteTenant(id: string): Promise<boolean> {\n    await db.delete(tenants).where(eq(tenants.id, id));\n    return true;\n  }\n\n  async getSubscription(id: string): Promise<Subscription | undefined> {\n    const [subscription] = await db.select().from(subscriptions).where(eq(subscriptions.id, id));\n    return subscription;\n  }\n\n  async getSubscriptionByTenant(tenantId: string): Promise<Subscription | undefined> {\n    const [subscription] = await db.select().from(subscriptions)\n      .where(eq(subscriptions.tenantId, tenantId))\n      .orderBy(desc(subscriptions.createdAt))\n      .limit(1);\n    return subscription;\n  }\n\n  async createSubscription(subscription: InsertSubscription): Promise<Subscription> {\n    const [created] = await db.insert(subscriptions).values(subscription).returning();\n    return created;\n  }\n\n  async updateSubscription(id: string, data: Partial<InsertSubscription>): Promise<Subscription | undefined> {\n    const [updated] = await db.update(subscriptions).set(data).where(eq(subscriptions.id, id)).returning();\n    return updated;\n  }\n\n  async getProduct(id: string): Promise<Product | undefined> {\n    const [product] = await db.select().from(products).where(eq(products.id, id));\n    return product;\n  }\n\n  async getProductsByTenant(tenantId: string): Promise<Product[]> {\n    return db.select().from(products).where(\n      or(eq(products.tenantId, tenantId), eq(products.isGlobal, true))\n    ).orderBy(desc(products.createdAt));\n  }\n\n  async createProduct(product: InsertProduct): Promise<Product> {\n    const [created] = await db.insert(products).values(product).returning();\n    return created;\n  }\n\n  async updateProduct(id: string, data: Partial<InsertProduct>): Promise<Product | undefined> {\n    const [updated] = await db.update(products).set(data).where(eq(products.id, id)).returning();\n    return updated;\n  }\n\n  async deleteProduct(id: string): Promise<boolean> {\n    await db.delete(products).where(eq(products.id, id));\n    return true;\n  }\n\n  async getTemplate(id: string): Promise<Template | undefined> {\n    const [template] = await db.select().from(templates).where(eq(templates.id, id));\n    return template;\n  }\n\n  async getTemplatesByTenant(tenantId: string): Promise<Template[]> {\n    return db.select().from(templates).where(\n      or(eq(templates.tenantId, tenantId), eq(templates.isGlobal, true))\n    ).orderBy(desc(templates.createdAt));\n  }\n\n  async getGlobalTemplates(): Promise<Template[]> {\n    return db.select().from(templates).where(eq(templates.isGlobal, true));\n  }\n\n  async createTemplate(template: InsertTemplate): Promise<Template> {\n    const [created] = await db.insert(templates).values(template).returning();\n    return created;\n  }\n\n  async updateTemplate(id: string, data: Partial<InsertTemplate>): Promise<Template | undefined> {\n    const [updated] = await db.update(templates).set(data).where(eq(templates.id, id)).returning();\n    return updated;\n  }\n\n  async deleteTemplate(id: string): Promise<boolean> {\n    await db.delete(templates).where(eq(templates.id, id));\n    return true;\n  }\n\n  async getCampaign(id: string): Promise<Campaign | undefined> {\n    const [campaign] = await db.select().from(campaigns).where(eq(campaigns.id, id));\n    return campaign;\n  }\n\n  async getCampaignsByTenant(tenantId: string): Promise<Campaign[]> {\n    return db.select().from(campaigns)\n      .where(eq(campaigns.tenantId, tenantId))\n      .orderBy(desc(campaigns.updatedAt));\n  }\n\n  async createCampaign(campaign: InsertCampaign): Promise<Campaign> {\n    const [created] = await db.insert(campaigns).values(campaign).returning();\n    return created;\n  }\n\n  async updateCampaign(id: string, data: Partial<InsertCampaign>): Promise<Campaign | undefined> {\n    const [updated] = await db.update(campaigns)\n      .set({ ...data, updatedAt: new Date() })\n      .where(eq(campaigns.id, id))\n      .returning();\n    return updated;\n  }\n\n  async deleteCampaign(id: string): Promise<boolean> {\n    await db.delete(campaignProducts).where(eq(campaignProducts.campaignId, id));\n    await db.delete(campaigns).where(eq(campaigns.id, id));\n    return true;\n  }\n\n  async getCampaignProducts(campaignId: string): Promise<CampaignProduct[]> {\n    return db.select().from(campaignProducts).where(eq(campaignProducts.campaignId, campaignId));\n  }\n\n  async addCampaignProduct(data: InsertCampaignProduct): Promise<CampaignProduct> {\n    const [created] = await db.insert(campaignProducts).values(data).returning();\n    return created;\n  }\n\n  async removeCampaignProduct(id: string): Promise<boolean> {\n    await db.delete(campaignProducts).where(eq(campaignProducts.id, id));\n    return true;\n  }\n\n  async getMessage(id: string): Promise<Message | undefined> {\n    const [message] = await db.select().from(messages).where(eq(messages.id, id));\n    return message;\n  }\n\n  async getMessagesByUser(userId: string): Promise<Message[]> {\n    return db.select().from(messages).where(\n      or(eq(messages.senderId, userId), eq(messages.receiverId, userId))\n    ).orderBy(desc(messages.createdAt));\n  }\n\n  async getMessagesByTenant(tenantId: string): Promise<Message[]> {\n    return db.select().from(messages)\n      .where(eq(messages.tenantId, tenantId))\n      .orderBy(desc(messages.createdAt));\n  }\n\n  async createMessage(message: InsertMessage): Promise<Message> {\n    const [created] = await db.insert(messages).values(message).returning();\n    return created;\n  }\n\n  async markMessageRead(id: string): Promise<Message | undefined> {\n    const [updated] = await db.update(messages)\n      .set({ isRead: true })\n      .where(eq(messages.id, id))\n      .returning();\n    return updated;\n  }\n\n  async deleteMessage(id: string): Promise<boolean> {\n    await db.delete(messages).where(eq(messages.id, id));\n    return true;\n  }\n\n  async getSuggestion(id: string): Promise<Suggestion | undefined> {\n    const [suggestion] = await db.select().from(suggestions).where(eq(suggestions.id, id));\n    return suggestion;\n  }\n\n  async getSuggestionsByTenant(tenantId: string): Promise<Suggestion[]> {\n    return db.select().from(suggestions)\n      .where(eq(suggestions.tenantId, tenantId))\n      .orderBy(desc(suggestions.createdAt));\n  }\n\n  async createSuggestion(suggestion: InsertSuggestion): Promise<Suggestion> {\n    const [created] = await db.insert(suggestions).values(suggestion).returning();\n    return created;\n  }\n\n  async updateSuggestion(id: string, data: Partial<InsertSuggestion>): Promise<Suggestion | undefined> {\n    const [updated] = await db.update(suggestions).set(data).where(eq(suggestions.id, id)).returning();\n    return updated;\n  }\n\n  async getAllSuggestions(): Promise<Suggestion[]> {\n    return db.select().from(suggestions).orderBy(desc(suggestions.createdAt));\n  }\n\n  async deleteSuggestion(id: string): Promise<boolean> {\n    await db.delete(suggestions).where(eq(suggestions.id, id));\n    return true;\n  }\n\n  async getTutorial(id: string): Promise<Tutorial | undefined> {\n    const [tutorial] = await db.select().from(tutorials).where(eq(tutorials.id, id));\n    return tutorial;\n  }\n\n  async getAllTutorials(): Promise<Tutorial[]> {\n    return db.select().from(tutorials)\n      .where(eq(tutorials.isPublished, true))\n      .orderBy(tutorials.order);\n  }\n\n  async createTutorial(tutorial: InsertTutorial): Promise<Tutorial> {\n    const [created] = await db.insert(tutorials).values(tutorial).returning();\n    return created;\n  }\n\n  async updateTutorial(id: string, data: Partial<InsertTutorial>): Promise<Tutorial | undefined> {\n    const [updated] = await db.update(tutorials).set(data).where(eq(tutorials.id, id)).returning();\n    return updated;\n  }\n\n  async deleteTutorial(id: string): Promise<boolean> {\n    await db.delete(tutorials).where(eq(tutorials.id, id));\n    return true;\n  }\n\n  async getSystemConfig(key: string): Promise<SystemConfig | undefined> {\n    const [config] = await db.select().from(systemConfig).where(eq(systemConfig.key, key));\n    return config;\n  }\n\n  async setSystemConfig(key: string, value: any): Promise<SystemConfig> {\n    const existing = await this.getSystemConfig(key);\n    if (existing) {\n      const [updated] = await db.update(systemConfig)\n        .set({ value, updatedAt: new Date() })\n        .where(eq(systemConfig.key, key))\n        .returning();\n      return updated;\n    }\n    const [created] = await db.insert(systemConfig).values({ key, value }).returning();\n    return created;\n  }\n\n  async getProductConnector(id: string): Promise<ProductConnector | undefined> {\n    const [connector] = await db.select().from(productConnectors).where(eq(productConnectors.id, id));\n    return connector;\n  }\n\n  async getAllProductConnectors(): Promise<ProductConnector[]> {\n    return db.select().from(productConnectors).orderBy(desc(productConnectors.createdAt));\n  }\n\n  async getEnabledProductConnectors(): Promise<ProductConnector[]> {\n    return db.select().from(productConnectors)\n      .where(eq(productConnectors.isEnabled, true))\n      .orderBy(desc(productConnectors.createdAt));\n  }\n\n  async createProductConnector(connector: InsertProductConnector): Promise<ProductConnector> {\n    const [created] = await db.insert(productConnectors).values(connector).returning();\n    return created;\n  }\n\n  async updateProductConnector(id: string, data: Partial<InsertProductConnector>): Promise<ProductConnector | undefined> {\n    const [updated] = await db.update(productConnectors)\n      .set({ ...data, updatedAt: new Date() })\n      .where(eq(productConnectors.id, id))\n      .returning();\n    return updated;\n  }\n\n  async deleteProductConnector(id: string): Promise<boolean> {\n    await db.delete(productConnectors).where(eq(productConnectors.id, id));\n    return true;\n  }\n\n  async getTenantByCode(code: string): Promise<Tenant | undefined> {\n    const [tenant] = await db.select().from(tenants).where(eq(tenants.code, code));\n    return tenant;\n  }\n\n  async getJoinRequest(id: string): Promise<JoinRequest | undefined> {\n    const [request] = await db.select().from(joinRequests).where(eq(joinRequests.id, id));\n    return request;\n  }\n\n  async getJoinRequestsByTenant(tenantId: string): Promise<JoinRequest[]> {\n    return db.select().from(joinRequests)\n      .where(eq(joinRequests.tenantId, tenantId))\n      .orderBy(desc(joinRequests.createdAt));\n  }\n\n  async getJoinRequestsByUser(userId: string): Promise<JoinRequest[]> {\n    return db.select().from(joinRequests)\n      .where(eq(joinRequests.userId, userId))\n      .orderBy(desc(joinRequests.createdAt));\n  }\n\n  async getPendingJoinRequestsByTenant(tenantId: string): Promise<JoinRequest[]> {\n    return db.select().from(joinRequests)\n      .where(and(eq(joinRequests.tenantId, tenantId), eq(joinRequests.status, \"pending\")))\n      .orderBy(desc(joinRequests.createdAt));\n  }\n\n  async createJoinRequest(request: InsertJoinRequest): Promise<JoinRequest> {\n    const [created] = await db.insert(joinRequests).values(request).returning();\n    return created;\n  }\n\n  async updateJoinRequest(id: string, data: Partial<InsertJoinRequest>): Promise<JoinRequest | undefined> {\n    const [updated] = await db.update(joinRequests).set(data).where(eq(joinRequests.id, id)).returning();\n    return updated;\n  }\n\n  async deleteJoinRequest(id: string): Promise<boolean> {\n    await db.delete(joinRequests).where(eq(joinRequests.id, id));\n    return true;\n  }\n}\n\nexport const storage = new DatabaseStorage();\n","path":null,"size_bytes":18719,"size_tokens":null},"client/src/pages/subscription.tsx":{"content":"import { useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { useLocation } from \"wouter\";\nimport { Check, Loader2, CreditCard } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { ThemeToggle } from \"@/components/theme-toggle\";\nimport { LanguageSelector } from \"@/components/language-selector\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\n\nconst plans = [\n  {\n    id: \"monthly\",\n    price: 300,\n    period: 1,\n    popular: false,\n    bestValue: false,\n  },\n  {\n    id: \"six_month\",\n    price: 250,\n    period: 6,\n    popular: true,\n    bestValue: false,\n  },\n  {\n    id: \"yearly\",\n    price: 200,\n    period: 12,\n    popular: false,\n    bestValue: true,\n  },\n];\n\nconst features = [\n  \"unlimitedCampaigns\",\n  \"allTemplates\",\n  \"prioritySupport\",\n  \"teamMembers\",\n  \"analytics\",\n  \"socialIntegration\",\n];\n\nexport default function SubscriptionPage() {\n  const { t } = useTranslation();\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const [selectedPlan, setSelectedPlan] = useState<string | null>(null);\n\n  const subscribeMutation = useMutation({\n    mutationFn: async (plan: string) => {\n      const response = await apiRequest(\"POST\", \"/api/subscription/create\", { plan });\n      return response;\n    },\n    onSuccess: () => {\n      toast({\n        title: t(\"common.success\"),\n        description: \"Subscription activated successfully!\",\n      });\n      setLocation(\"/dashboard\");\n    },\n    onError: () => {\n      toast({\n        variant: \"destructive\",\n        title: t(\"common.error\"),\n        description: t(\"errors.somethingWentWrong\"),\n      });\n    },\n  });\n\n  const handleSelectPlan = (planId: string) => {\n    setSelectedPlan(planId);\n    subscribeMutation.mutate(planId);\n  };\n\n  const getPlanName = (id: string) => {\n    switch (id) {\n      case \"monthly\":\n        return t(\"subscription.monthly\");\n      case \"six_month\":\n        return t(\"subscription.sixMonth\");\n      case \"yearly\":\n        return t(\"subscription.yearly\");\n      default:\n        return id;\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <div className=\"flex justify-end items-center gap-2 p-4\">\n        <LanguageSelector />\n        <ThemeToggle />\n      </div>\n\n      <div className=\"max-w-6xl mx-auto px-4 py-12\">\n        <div className=\"text-center mb-12\">\n          <div className=\"flex justify-center mb-6\">\n            <div className=\"flex h-14 w-14 items-center justify-center rounded-lg bg-primary text-primary-foreground font-bold text-2xl\">\n              eB\n            </div>\n          </div>\n          <h1 className=\"text-4xl font-bold mb-4\">{t(\"subscription.title\")}</h1>\n          <p className=\"text-lg text-muted-foreground\">{t(\"subscription.subtitle\")}</p>\n        </div>\n\n        <div className=\"grid md:grid-cols-3 gap-6\">\n          {plans.map((plan) => (\n            <Card\n              key={plan.id}\n              className={`relative flex flex-col ${\n                plan.popular ? \"border-primary shadow-lg scale-105\" : \"\"\n              }`}\n            >\n              {plan.popular && (\n                <div className=\"absolute -top-3 left-1/2 -translate-x-1/2\">\n                  <Badge className=\"px-3 py-1\">{t(\"subscription.popular\")}</Badge>\n                </div>\n              )}\n              {plan.bestValue && (\n                <div className=\"absolute -top-3 left-1/2 -translate-x-1/2\">\n                  <Badge variant=\"secondary\" className=\"px-3 py-1\">\n                    {t(\"subscription.bestValue\")}\n                  </Badge>\n                </div>\n              )}\n              <CardHeader className=\"text-center pt-8\">\n                <CardTitle className=\"text-xl\">{getPlanName(plan.id)}</CardTitle>\n                <CardDescription>\n                  {plan.period === 1 ? \"Billed monthly\" : `Billed every ${plan.period} months`}\n                </CardDescription>\n                <div className=\"mt-4\">\n                  <span className=\"text-4xl font-bold\">â‚¬{plan.price}</span>\n                  <span className=\"text-muted-foreground\">{t(\"subscription.perMonth\")}</span>\n                </div>\n                {plan.period > 1 && (\n                  <p className=\"text-sm text-muted-foreground mt-2\">\n                    Total: â‚¬{plan.price * plan.period}\n                  </p>\n                )}\n              </CardHeader>\n              <CardContent className=\"flex-1\">\n                <ul className=\"space-y-3\">\n                  {features.map((feature) => (\n                    <li key={feature} className=\"flex items-center gap-3\">\n                      <div className=\"flex h-5 w-5 items-center justify-center rounded-full bg-primary/10\">\n                        <Check className=\"h-3 w-3 text-primary\" />\n                      </div>\n                      <span className=\"text-sm\">\n                        {t(`subscription.features.${feature}`)}\n                      </span>\n                    </li>\n                  ))}\n                </ul>\n              </CardContent>\n              <CardFooter>\n                <Button\n                  className=\"w-full\"\n                  variant={plan.popular ? \"default\" : \"outline\"}\n                  onClick={() => handleSelectPlan(plan.id)}\n                  disabled={subscribeMutation.isPending && selectedPlan === plan.id}\n                  data-testid={`button-select-${plan.id}`}\n                >\n                  {subscribeMutation.isPending && selectedPlan === plan.id ? (\n                    <>\n                      <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                      Processing...\n                    </>\n                  ) : (\n                    <>\n                      <CreditCard className=\"mr-2 h-4 w-4\" />\n                      {t(\"subscription.selectPlan\")}\n                    </>\n                  )}\n                </Button>\n              </CardFooter>\n            </Card>\n          ))}\n        </div>\n\n        <p className=\"text-center text-sm text-muted-foreground mt-8\">\n          Payment will be processed securely through our payment provider.\n        </p>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":6401,"size_tokens":null},"server/routes.ts":{"content":"import type { Express, Request, Response, NextFunction } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { storage } from \"./storage\";\nimport bcrypt from \"bcryptjs\";\nimport jwt from \"jsonwebtoken\";\nimport speakeasy from \"speakeasy\";\nimport session from \"express-session\";\nimport multer from \"multer\";\nimport path from \"path\";\nimport fs from \"fs\";\nimport {\n  loginSchema, registerSchema, resetPasswordSchema, verifyTotpSchema, tenantSetupSchema,\n  insertProductSchema, insertTemplateSchema, insertCampaignSchema,\n  insertMessageSchema, insertSuggestionSchema, insertTutorialSchema\n} from \"@shared/schema\";\nimport { z } from \"zod\";\nimport { generateActivationToken, getActivationTokenExpiry, sendActivationEmail } from \"./email\";\n\nconst uploadsDir = path.join(process.cwd(), \"uploads\");\nif (!fs.existsSync(uploadsDir)) {\n  fs.mkdirSync(uploadsDir, { recursive: true });\n}\n\nconst fileStorage = multer.diskStorage({\n  destination: (_req, _file, cb) => {\n    cb(null, uploadsDir);\n  },\n  filename: (_req, file, cb) => {\n    const uniqueSuffix = Date.now() + \"-\" + Math.round(Math.random() * 1e9);\n    const ext = path.extname(file.originalname);\n    cb(null, `${uniqueSuffix}${ext}`);\n  },\n});\n\nconst upload = multer({\n  storage: fileStorage,\n  limits: { fileSize: 5 * 1024 * 1024 },\n  fileFilter: (_req, file, cb) => {\n    const allowedTypes = [\"image/jpeg\", \"image/png\", \"image/gif\", \"image/webp\"];\n    if (allowedTypes.includes(file.mimetype)) {\n      cb(null, true);\n    } else {\n      cb(new Error(\"Only image files are allowed\"));\n    }\n  },\n});\n\nconst JWT_SECRET = process.env.SESSION_SECRET || \"your-secret-key\";\n\nasync function seedSuperAdmin() {\n  try {\n    const existingAdmin = await storage.getUserByEmail(\"superadmin@example.com\");\n    if (!existingAdmin) {\n      const hashedPassword = await bcrypt.hash(\"Super12345\", 12);\n      await storage.createUser({\n        email: \"superadmin@example.com\",\n        password: hashedPassword,\n        firstName: \"Super\",\n        lastName: \"Admin\",\n        mobilePhone: null,\n        tenantId: null,\n        role: \"super_admin\",\n        totpSecret: null,\n        totpEnabled: false,\n        isActive: true\n      });\n      console.log(\"Super admin user created successfully\");\n    }\n  } catch (error) {\n    console.error(\"Error seeding super admin:\", error);\n  }\n}\n\ndeclare module \"express-session\" {\n  interface SessionData {\n    userId?: string;\n    tenantId?: string;\n    role?: string;\n  }\n}\n\ninterface AuthRequest extends Request {\n  user?: {\n    id: string;\n    email: string;\n    firstName: string;\n    lastName: string;\n    tenantId: string | null;\n    role: string;\n  };\n}\n\nconst authenticate = async (req: AuthRequest, res: Response, next: NextFunction) => {\n  try {\n    const authHeader = req.headers.authorization;\n    if (!authHeader?.startsWith(\"Bearer \")) {\n      return res.status(401).json({ error: \"No token provided\" });\n    }\n\n    const token = authHeader.substring(7);\n    const decoded = jwt.verify(token, JWT_SECRET) as any;\n    const user = await storage.getUser(decoded.userId);\n\n    if (!user) {\n      return res.status(401).json({ error: \"User not found\" });\n    }\n\n    req.user = {\n      id: user.id,\n      email: user.email,\n      firstName: user.firstName,\n      lastName: user.lastName,\n      tenantId: user.tenantId,\n      role: user.role\n    };\n\n    next();\n  } catch (error) {\n    return res.status(401).json({ error: \"Invalid token\" });\n  }\n};\n\nconst requireTenant = (req: AuthRequest, res: Response, next: NextFunction) => {\n  if (req.user?.role === \"super_admin\") {\n    return next();\n  }\n  if (!req.user?.tenantId) {\n    return res.status(403).json({ error: \"Tenant access required\" });\n  }\n  next();\n};\n\nconst requireRole = (...roles: string[]) => {\n  return (req: AuthRequest, res: Response, next: NextFunction) => {\n    if (!req.user || !roles.includes(req.user.role)) {\n      return res.status(403).json({ error: \"Insufficient permissions\" });\n    }\n    next();\n  };\n};\n\nexport async function registerRoutes(\n  httpServer: Server,\n  app: Express\n): Promise<Server> {\n  await seedSuperAdmin();\n  \n  app.use(session({\n    secret: JWT_SECRET,\n    resave: false,\n    saveUninitialized: false,\n    cookie: { secure: false, maxAge: 24 * 60 * 60 * 1000 }\n  }));\n\n  app.use(\"/uploads\", (await import(\"express\")).default.static(uploadsDir));\n\n  app.post(\"/api/upload\", authenticate, upload.single(\"file\"), (req: AuthRequest, res: Response) => {\n    if (!req.file) {\n      return res.status(400).json({ error: \"No file uploaded\" });\n    }\n    const fileUrl = `/uploads/${req.file.filename}`;\n    res.json({ url: fileUrl });\n  });\n\n  app.post(\"/api/auth/register\", async (req: Request, res: Response) => {\n    try {\n      const data = registerSchema.parse(req.body);\n      const existingUser = await storage.getUserByEmail(data.email);\n      if (existingUser) {\n        return res.status(400).json({ error: \"Email already registered\" });\n      }\n\n      const hashedPassword = await bcrypt.hash(data.password, 12);\n      const totpSecret = speakeasy.generateSecret({ name: `eBrochure:${data.email}` });\n      const activationToken = generateActivationToken();\n      const activationTokenExpiry = getActivationTokenExpiry();\n\n      const user = await storage.createUser({\n        email: data.email,\n        password: hashedPassword,\n        firstName: data.firstName,\n        lastName: data.lastName,\n        mobilePhone: data.mobilePhone || null,\n        tenantId: null,\n        role: \"tenant_admin\",\n        totpSecret: totpSecret.base32,\n        totpEnabled: false,\n        isActive: false,\n        activationToken,\n        activationTokenExpiry\n      });\n\n      await sendActivationEmail(data.email, data.firstName, activationToken, storage);\n\n      res.json({\n        userId: user.id,\n        message: \"Registration successful. Please check your email to verify your account.\",\n        requiresVerification: true\n      });\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ error: error.errors });\n      }\n      console.error(\"Register error:\", error);\n      res.status(500).json({ error: \"Registration failed\" });\n    }\n  });\n\n  app.post(\"/api/auth/login\", async (req: Request, res: Response) => {\n    try {\n      const data = loginSchema.parse(req.body);\n      const user = await storage.getUserByEmail(data.email);\n\n      if (!user) {\n        return res.status(401).json({ error: \"Invalid credentials\" });\n      }\n\n      const validPassword = await bcrypt.compare(data.password, user.password);\n      if (!validPassword) {\n        return res.status(401).json({ error: \"Invalid credentials\" });\n      }\n\n      if (!user.isActive) {\n        return res.status(401).json({ \n          error: \"Please verify your email address\",\n          requiresVerification: true,\n          email: user.email\n        });\n      }\n\n      if (user.totpEnabled) {\n        return res.json({\n          requiresTotp: true,\n          userId: user.id\n        });\n      }\n\n      const token = jwt.sign({ userId: user.id }, JWT_SECRET, { expiresIn: \"24h\" });\n      const { password, totpSecret, ...safeUser } = user;\n\n      res.json({\n        user: safeUser,\n        token,\n        requiresTotp: false\n      });\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ error: error.errors });\n      }\n      console.error(\"Login error:\", error);\n      res.status(500).json({ error: \"Login failed\" });\n    }\n  });\n\n  app.get(\"/api/auth/setup-2fa\", async (req: Request, res: Response) => {\n    try {\n      const userId = req.query.userId as string;\n      if (!userId) {\n        return res.status(400).json({ error: \"User ID required\" });\n      }\n\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ error: \"User not found\" });\n      }\n\n      const otpauthUrl = speakeasy.otpauthURL({\n        secret: user.totpSecret || \"\",\n        label: `eBrochure:${user.email}`,\n        issuer: \"eBrochure\",\n        encoding: \"base32\"\n      });\n\n      res.json({\n        secret: user.totpSecret,\n        otpauthUrl\n      });\n    } catch (error) {\n      console.error(\"Setup 2FA error:\", error);\n      res.status(500).json({ error: \"Failed to setup 2FA\" });\n    }\n  });\n\n  app.post(\"/api/auth/verify-2fa-setup\", async (req: Request, res: Response) => {\n    try {\n      const { userId, token } = req.body;\n      const user = await storage.getUser(userId);\n\n      if (!user) {\n        return res.status(404).json({ error: \"User not found\" });\n      }\n\n      const verified = speakeasy.totp.verify({\n        secret: user.totpSecret || \"\",\n        encoding: \"base32\",\n        token,\n        window: 2\n      });\n\n      if (!verified) {\n        return res.status(400).json({ error: \"Invalid verification code\" });\n      }\n\n      await storage.updateUser(userId, { totpEnabled: true });\n\n      const jwtToken = jwt.sign({ userId: user.id }, JWT_SECRET, { expiresIn: \"24h\" });\n      const { password, totpSecret, ...safeUser } = user;\n\n      res.json({\n        user: { ...safeUser, totpEnabled: true },\n        token: jwtToken\n      });\n    } catch (error) {\n      console.error(\"Verify 2FA setup error:\", error);\n      res.status(500).json({ error: \"Failed to verify 2FA\" });\n    }\n  });\n\n  app.post(\"/api/auth/verify-2fa\", async (req: Request, res: Response) => {\n    try {\n      const { userId, token } = req.body;\n      const user = await storage.getUser(userId);\n\n      if (!user) {\n        return res.status(404).json({ error: \"User not found\" });\n      }\n\n      const verified = speakeasy.totp.verify({\n        secret: user.totpSecret || \"\",\n        encoding: \"base32\",\n        token,\n        window: 2\n      });\n\n      if (!verified) {\n        return res.status(400).json({ error: \"Invalid verification code\" });\n      }\n\n      const jwtToken = jwt.sign({ userId: user.id }, JWT_SECRET, { expiresIn: \"24h\" });\n      const { password, totpSecret, ...safeUser } = user;\n\n      res.json({\n        user: safeUser,\n        token: jwtToken\n      });\n    } catch (error) {\n      console.error(\"Verify 2FA error:\", error);\n      res.status(500).json({ error: \"Failed to verify 2FA\" });\n    }\n  });\n\n  app.post(\"/api/auth/reset-password\", async (req: Request, res: Response) => {\n    try {\n      const data = resetPasswordSchema.parse(req.body);\n      const user = await storage.getUserByEmail(data.email);\n\n      res.json({ message: \"If an account exists, a reset email has been sent.\" });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to process reset request\" });\n    }\n  });\n\n  app.get(\"/api/auth/verify-email\", async (req: Request, res: Response) => {\n    try {\n      const token = req.query.token as string;\n      if (!token) {\n        return res.status(400).json({ error: \"Verification token is required\" });\n      }\n\n      const user = await storage.getUserByActivationToken(token);\n      if (!user) {\n        return res.status(400).json({ error: \"Invalid or expired verification token\" });\n      }\n\n      if (user.activationTokenExpiry && new Date() > new Date(user.activationTokenExpiry)) {\n        return res.status(400).json({ error: \"Verification token has expired. Please request a new one.\" });\n      }\n\n      await storage.updateUser(user.id, {\n        isActive: true,\n        activationToken: null,\n        activationTokenExpiry: null\n      });\n\n      res.json({ \n        message: \"Email verified successfully. You can now log in.\",\n        verified: true\n      });\n    } catch (error) {\n      console.error(\"Verify email error:\", error);\n      res.status(500).json({ error: \"Failed to verify email\" });\n    }\n  });\n\n  app.post(\"/api/auth/resend-verification\", async (req: Request, res: Response) => {\n    try {\n      const { email } = req.body;\n      if (!email) {\n        return res.status(400).json({ error: \"Email is required\" });\n      }\n\n      const user = await storage.getUserByEmail(email);\n      if (!user) {\n        return res.json({ message: \"If an account exists, a verification email has been sent.\" });\n      }\n\n      if (user.isActive) {\n        return res.status(400).json({ error: \"Email is already verified\" });\n      }\n\n      const activationToken = generateActivationToken();\n      const activationTokenExpiry = getActivationTokenExpiry();\n\n      await storage.updateUser(user.id, {\n        activationToken,\n        activationTokenExpiry\n      });\n\n      await sendActivationEmail(user.email, user.firstName, activationToken, storage);\n\n      res.json({ message: \"Verification email sent. Please check your inbox.\" });\n    } catch (error) {\n      console.error(\"Resend verification error:\", error);\n      res.status(500).json({ error: \"Failed to resend verification email\" });\n    }\n  });\n\n  app.get(\"/api/auth/me\", authenticate, async (req: AuthRequest, res: Response) => {\n    try {\n      const user = await storage.getUser(req.user!.id);\n      if (!user) {\n        return res.status(404).json({ error: \"User not found\" });\n      }\n      const { password, totpSecret, ...safeUser } = user;\n      res.json(safeUser);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to get user\" });\n    }\n  });\n\n  app.post(\"/api/tenant/setup\", authenticate, async (req: AuthRequest, res: Response) => {\n    try {\n      const data = tenantSetupSchema.parse(req.body);\n\n      if (req.user!.tenantId) {\n        return res.status(400).json({ error: \"User already has an organization\" });\n      }\n\n      const existingTenant = await storage.getTenantBySlug(data.slug);\n      if (existingTenant) {\n        return res.status(400).json({ error: \"This organization URL is already taken\" });\n      }\n\n      const generateTenantCode = () => {\n        const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789';\n        let code = '';\n        for (let i = 0; i < 8; i++) {\n          code += chars.charAt(Math.floor(Math.random() * chars.length));\n        }\n        return code;\n      };\n\n      let tenantCode = generateTenantCode();\n      let existingCodeTenant = await storage.getTenantByCode(tenantCode);\n      while (existingCodeTenant) {\n        tenantCode = generateTenantCode();\n        existingCodeTenant = await storage.getTenantByCode(tenantCode);\n      }\n\n      const tenant = await storage.createTenant({ name: data.name, slug: data.slug, code: tenantCode });\n      await storage.updateUser(req.user!.id, { tenantId: tenant.id });\n\n      res.json({ tenant, message: \"Organization created successfully\" });\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ error: error.errors[0]?.message || \"Invalid input\" });\n      }\n      console.error(\"Tenant setup error:\", error);\n      res.status(500).json({ error: \"Failed to create organization\" });\n    }\n  });\n\n  app.get(\"/api/tenant/current\", authenticate, requireTenant, async (req: AuthRequest, res: Response) => {\n    try {\n      const tenant = await storage.getTenant(req.user!.tenantId!);\n      if (!tenant) {\n        return res.status(404).json({ error: \"Organization not found\" });\n      }\n      res.json({ \n        id: tenant.id, \n        name: tenant.name, \n        slug: tenant.slug,\n        code: tenant.code,\n        logoUrl: tenant.logoUrl \n      });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to get organization info\" });\n    }\n  });\n\n  app.post(\"/api/tenant/logo\", authenticate, requireTenant, upload.single(\"logo\"), async (req: AuthRequest, res: Response) => {\n    try {\n      if (req.user!.role !== \"tenant_admin\" && req.user!.role !== \"super_admin\") {\n        return res.status(403).json({ error: \"Only admins can upload organization logo\" });\n      }\n\n      if (!req.file) {\n        return res.status(400).json({ error: \"No file uploaded\" });\n      }\n\n      const logoUrl = `/uploads/${req.file.filename}`;\n      await storage.updateTenant(req.user!.tenantId!, { logoUrl });\n      \n      res.json({ logoUrl, message: \"Logo uploaded successfully\" });\n    } catch (error) {\n      console.error(\"Logo upload error:\", error);\n      res.status(500).json({ error: \"Failed to upload logo\" });\n    }\n  });\n\n  app.delete(\"/api/tenant/logo\", authenticate, requireTenant, async (req: AuthRequest, res: Response) => {\n    try {\n      if (req.user!.role !== \"tenant_admin\" && req.user!.role !== \"super_admin\") {\n        return res.status(403).json({ error: \"Only admins can remove organization logo\" });\n      }\n\n      const tenant = await storage.getTenant(req.user!.tenantId!);\n      if (tenant?.logoUrl) {\n        const filename = tenant.logoUrl.replace(\"/uploads/\", \"\");\n        const filePath = path.join(uploadsDir, filename);\n        if (fs.existsSync(filePath)) {\n          fs.unlinkSync(filePath);\n        }\n      }\n\n      await storage.updateTenant(req.user!.tenantId!, { logoUrl: null });\n      \n      res.json({ message: \"Logo removed successfully\" });\n    } catch (error) {\n      console.error(\"Logo remove error:\", error);\n      res.status(500).json({ error: \"Failed to remove logo\" });\n    }\n  });\n\n  app.get(\"/api/tenant/by-code/:code\", async (req: Request, res: Response) => {\n    try {\n      const tenant = await storage.getTenantByCode(req.params.code.toUpperCase());\n      if (!tenant) {\n        return res.status(404).json({ error: \"Organization not found with this code\" });\n      }\n      res.json({ id: tenant.id, name: tenant.name });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to find organization\" });\n    }\n  });\n\n  app.post(\"/api/join-requests\", authenticate, async (req: AuthRequest, res: Response) => {\n    try {\n      const { tenantCode, message } = req.body;\n      \n      if (req.user!.tenantId) {\n        return res.status(400).json({ error: \"You are already a member of an organization\" });\n      }\n\n      const tenant = await storage.getTenantByCode(tenantCode.toUpperCase());\n      if (!tenant) {\n        return res.status(404).json({ error: \"Organization not found with this code\" });\n      }\n\n      const existingRequests = await storage.getJoinRequestsByUser(req.user!.id);\n      const pendingRequest = existingRequests.find(r => r.tenantId === tenant.id && r.status === \"pending\");\n      if (pendingRequest) {\n        return res.status(400).json({ error: \"You already have a pending request to join this organization\" });\n      }\n\n      const joinRequest = await storage.createJoinRequest({\n        userId: req.user!.id,\n        tenantId: tenant.id,\n        message: message || null,\n        status: \"pending\",\n        reviewedBy: null\n      });\n\n      res.json({ joinRequest, message: \"Join request submitted successfully\" });\n    } catch (error) {\n      console.error(\"Create join request error:\", error);\n      res.status(500).json({ error: \"Failed to submit join request\" });\n    }\n  });\n\n  app.get(\"/api/join-requests\", authenticate, requireTenant, async (req: AuthRequest, res: Response) => {\n    try {\n      if (req.user!.role !== \"tenant_admin\" && req.user!.role !== \"super_admin\") {\n        return res.status(403).json({ error: \"Only admins can view join requests\" });\n      }\n      const requests = await storage.getPendingJoinRequestsByTenant(req.user!.tenantId!);\n      const requestsWithUsers = await Promise.all(requests.map(async (request) => {\n        const user = await storage.getUser(request.userId);\n        return {\n          ...request,\n          user: user ? { id: user.id, email: user.email, firstName: user.firstName, lastName: user.lastName } : null\n        };\n      }));\n      res.json(requestsWithUsers);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to get join requests\" });\n    }\n  });\n\n  app.get(\"/api/join-requests/my\", authenticate, async (req: AuthRequest, res: Response) => {\n    try {\n      const requests = await storage.getJoinRequestsByUser(req.user!.id);\n      const requestsWithTenants = await Promise.all(requests.map(async (request) => {\n        const tenant = await storage.getTenant(request.tenantId);\n        return {\n          ...request,\n          tenant: tenant ? { id: tenant.id, name: tenant.name } : null\n        };\n      }));\n      res.json(requestsWithTenants);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to get your join requests\" });\n    }\n  });\n\n  app.post(\"/api/join-requests/:id/approve\", authenticate, requireTenant, async (req: AuthRequest, res: Response) => {\n    try {\n      if (req.user!.role !== \"tenant_admin\" && req.user!.role !== \"super_admin\") {\n        return res.status(403).json({ error: \"Only admins can approve join requests\" });\n      }\n\n      const request = await storage.getJoinRequest(req.params.id);\n      if (!request) {\n        return res.status(404).json({ error: \"Join request not found\" });\n      }\n\n      if (request.tenantId !== req.user!.tenantId && req.user!.role !== \"super_admin\") {\n        return res.status(403).json({ error: \"You can only approve requests for your organization\" });\n      }\n\n      if (request.status !== \"pending\") {\n        return res.status(400).json({ error: \"This request has already been processed\" });\n      }\n\n      await storage.updateJoinRequest(req.params.id, {\n        status: \"approved\",\n        reviewedBy: req.user!.id,\n        reviewedAt: new Date()\n      } as any);\n\n      await storage.updateUser(request.userId, { tenantId: request.tenantId, role: \"tenant_user\" });\n\n      res.json({ message: \"Join request approved successfully\" });\n    } catch (error) {\n      console.error(\"Approve join request error:\", error);\n      res.status(500).json({ error: \"Failed to approve join request\" });\n    }\n  });\n\n  app.post(\"/api/join-requests/:id/reject\", authenticate, requireTenant, async (req: AuthRequest, res: Response) => {\n    try {\n      if (req.user!.role !== \"tenant_admin\" && req.user!.role !== \"super_admin\") {\n        return res.status(403).json({ error: \"Only admins can reject join requests\" });\n      }\n\n      const request = await storage.getJoinRequest(req.params.id);\n      if (!request) {\n        return res.status(404).json({ error: \"Join request not found\" });\n      }\n\n      if (request.tenantId !== req.user!.tenantId && req.user!.role !== \"super_admin\") {\n        return res.status(403).json({ error: \"You can only reject requests for your organization\" });\n      }\n\n      if (request.status !== \"pending\") {\n        return res.status(400).json({ error: \"This request has already been processed\" });\n      }\n\n      await storage.updateJoinRequest(req.params.id, {\n        status: \"rejected\",\n        reviewedBy: req.user!.id,\n        reviewedAt: new Date()\n      } as any);\n\n      res.json({ message: \"Join request rejected\" });\n    } catch (error) {\n      console.error(\"Reject join request error:\", error);\n      res.status(500).json({ error: \"Failed to reject join request\" });\n    }\n  });\n\n  app.post(\"/api/subscription/create\", authenticate, async (req: AuthRequest, res: Response) => {\n    try {\n      const { plan } = req.body;\n      const tenantId = req.user!.tenantId;\n\n      if (!tenantId) {\n        return res.status(400).json({ error: \"No tenant associated\" });\n      }\n\n      const prices: Record<string, string> = {\n        monthly: \"300.00\",\n        six_month: \"250.00\",\n        yearly: \"200.00\"\n      };\n\n      const periods: Record<string, number> = {\n        monthly: 1,\n        six_month: 6,\n        yearly: 12\n      };\n\n      const subscription = await storage.createSubscription({\n        tenantId,\n        plan,\n        status: \"active\",\n        pricePerMonth: prices[plan] || \"300.00\",\n        startDate: new Date(),\n        endDate: new Date(Date.now() + periods[plan] * 30 * 24 * 60 * 60 * 1000)\n      });\n\n      res.json(subscription);\n    } catch (error) {\n      console.error(\"Create subscription error:\", error);\n      res.status(500).json({ error: \"Failed to create subscription\" });\n    }\n  });\n\n  app.get(\"/api/subscription\", authenticate, requireTenant, async (req: AuthRequest, res: Response) => {\n    try {\n      const subscription = await storage.getSubscriptionByTenant(req.user!.tenantId!);\n      res.json(subscription || null);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to get subscription\" });\n    }\n  });\n\n  app.get(\"/api/products\", authenticate, requireTenant, async (req: AuthRequest, res: Response) => {\n    try {\n      const products = await storage.getProductsByTenant(req.user!.tenantId!);\n      res.json(products);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to get products\" });\n    }\n  });\n\n  // Product search from connectors - MUST be before /api/products/:id to avoid route conflict\n  app.get(\"/api/products/search\", authenticate, async (req: AuthRequest, res: Response) => {\n    try {\n      const { q } = req.query;\n      const searchQuery = (q as string) || \"\";\n      console.log(\"[DEBUG] /api/products/search called with q:\", searchQuery);\n      \n      const connectors = await storage.getEnabledProductConnectors();\n      console.log(\"[DEBUG] Found connectors:\", connectors.length);\n      if (connectors.length === 0) {\n        return res.json([]);\n      }\n\n      const allProducts: any[] = [];\n      for (const connector of connectors) {\n        try {\n          const products = await executeConnectorSearch(connector, searchQuery);\n          allProducts.push(...products.map((p: any) => ({ ...p, connectorId: connector.id, connectorName: connector.name })));\n        } catch (err) {\n          console.error(`Connector ${connector.name} failed:`, err);\n        }\n      }\n\n      console.log(\"[DEBUG] Returning products:\", allProducts.length);\n      res.json(allProducts);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to search products\" });\n    }\n  });\n\n  app.get(\"/api/products/:id\", authenticate, requireTenant, async (req: AuthRequest, res: Response) => {\n    try {\n      const product = await storage.getProduct(req.params.id);\n      if (!product) {\n        return res.status(404).json({ error: \"Product not found\" });\n      }\n      if (product.tenantId !== req.user!.tenantId && !product.isGlobal) {\n        return res.status(403).json({ error: \"Access denied\" });\n      }\n      res.json(product);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to get product\" });\n    }\n  });\n\n  app.post(\"/api/products\", authenticate, requireTenant, async (req: AuthRequest, res: Response) => {\n    try {\n      const data = insertProductSchema.parse({ ...req.body, tenantId: req.user!.tenantId });\n      const product = await storage.createProduct(data);\n      res.json(product);\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ error: error.errors });\n      }\n      res.status(500).json({ error: \"Failed to create product\" });\n    }\n  });\n\n  app.patch(\"/api/products/:id\", authenticate, requireTenant, async (req: AuthRequest, res: Response) => {\n    try {\n      const product = await storage.getProduct(req.params.id);\n      if (!product || product.tenantId !== req.user!.tenantId) {\n        return res.status(404).json({ error: \"Product not found\" });\n      }\n      const updated = await storage.updateProduct(req.params.id, req.body);\n      res.json(updated);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to update product\" });\n    }\n  });\n\n  app.delete(\"/api/products/:id\", authenticate, requireTenant, async (req: AuthRequest, res: Response) => {\n    try {\n      const product = await storage.getProduct(req.params.id);\n      if (!product || product.tenantId !== req.user!.tenantId) {\n        return res.status(404).json({ error: \"Product not found\" });\n      }\n      await storage.deleteProduct(req.params.id);\n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to delete product\" });\n    }\n  });\n\n  app.get(\"/api/templates\", authenticate, requireTenant, async (req: AuthRequest, res: Response) => {\n    try {\n      const templates = await storage.getTemplatesByTenant(req.user!.tenantId!);\n      res.json(templates);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to get templates\" });\n    }\n  });\n\n  app.get(\"/api/templates/:id\", authenticate, requireTenant, async (req: AuthRequest, res: Response) => {\n    try {\n      const template = await storage.getTemplate(req.params.id);\n      if (!template) {\n        return res.status(404).json({ error: \"Template not found\" });\n      }\n      if (template.tenantId !== req.user!.tenantId && !template.isGlobal) {\n        return res.status(403).json({ error: \"Access denied\" });\n      }\n      res.json(template);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to get template\" });\n    }\n  });\n\n  app.post(\"/api/templates\", authenticate, requireTenant, async (req: AuthRequest, res: Response) => {\n    try {\n      const data = insertTemplateSchema.parse({ ...req.body, tenantId: req.user!.tenantId });\n      const template = await storage.createTemplate(data);\n      res.json(template);\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ error: error.errors });\n      }\n      res.status(500).json({ error: \"Failed to create template\" });\n    }\n  });\n\n  app.patch(\"/api/templates/:id\", authenticate, requireTenant, async (req: AuthRequest, res: Response) => {\n    try {\n      const template = await storage.getTemplate(req.params.id);\n      if (!template || template.tenantId !== req.user!.tenantId) {\n        return res.status(404).json({ error: \"Template not found\" });\n      }\n      const updated = await storage.updateTemplate(req.params.id, req.body);\n      res.json(updated);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to update template\" });\n    }\n  });\n\n  app.delete(\"/api/templates/:id\", authenticate, requireTenant, async (req: AuthRequest, res: Response) => {\n    try {\n      const template = await storage.getTemplate(req.params.id);\n      if (!template || template.tenantId !== req.user!.tenantId) {\n        return res.status(404).json({ error: \"Template not found\" });\n      }\n      await storage.deleteTemplate(req.params.id);\n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to delete template\" });\n    }\n  });\n\n  app.get(\"/api/campaigns\", authenticate, requireTenant, async (req: AuthRequest, res: Response) => {\n    try {\n      const campaigns = await storage.getCampaignsByTenant(req.user!.tenantId!);\n      res.json(campaigns);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to get campaigns\" });\n    }\n  });\n\n  app.get(\"/api/campaigns/:id\", authenticate, requireTenant, async (req: AuthRequest, res: Response) => {\n    try {\n      const campaign = await storage.getCampaign(req.params.id);\n      if (!campaign || campaign.tenantId !== req.user!.tenantId) {\n        return res.status(404).json({ error: \"Campaign not found\" });\n      }\n      res.json(campaign);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to get campaign\" });\n    }\n  });\n\n  app.post(\"/api/campaigns\", authenticate, requireTenant, async (req: AuthRequest, res: Response) => {\n    try {\n      if (!req.user!.tenantId) {\n        return res.status(400).json({ error: \"You must belong to an organization to create campaigns\" });\n      }\n      const data = insertCampaignSchema.parse({\n        ...req.body,\n        tenantId: req.user!.tenantId,\n        createdBy: req.user!.id\n      });\n      const campaign = await storage.createCampaign(data);\n      res.json(campaign);\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ error: error.errors });\n      }\n      res.status(500).json({ error: \"Failed to create campaign\" });\n    }\n  });\n\n  app.patch(\"/api/campaigns/:id\", authenticate, requireTenant, async (req: AuthRequest, res: Response) => {\n    try {\n      const campaign = await storage.getCampaign(req.params.id);\n      if (!campaign || campaign.tenantId !== req.user!.tenantId) {\n        return res.status(404).json({ error: \"Campaign not found\" });\n      }\n      const updated = await storage.updateCampaign(req.params.id, req.body);\n      res.json(updated);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to update campaign\" });\n    }\n  });\n\n  app.delete(\"/api/campaigns/:id\", authenticate, requireTenant, async (req: AuthRequest, res: Response) => {\n    try {\n      const campaign = await storage.getCampaign(req.params.id);\n      if (!campaign || campaign.tenantId !== req.user!.tenantId) {\n        return res.status(404).json({ error: \"Campaign not found\" });\n      }\n      await storage.deleteCampaign(req.params.id);\n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to delete campaign\" });\n    }\n  });\n\n  app.get(\"/api/campaigns/:id/products\", authenticate, requireTenant, async (req: AuthRequest, res: Response) => {\n    try {\n      const campaign = await storage.getCampaign(req.params.id);\n      if (!campaign || campaign.tenantId !== req.user!.tenantId) {\n        return res.status(404).json({ error: \"Campaign not found\" });\n      }\n      const campaignProducts = await storage.getCampaignProducts(req.params.id);\n      res.json(campaignProducts);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to get campaign products\" });\n    }\n  });\n\n  app.post(\"/api/campaigns/:id/products\", authenticate, requireTenant, async (req: AuthRequest, res: Response) => {\n    try {\n      const campaign = await storage.getCampaign(req.params.id);\n      if (!campaign || campaign.tenantId !== req.user!.tenantId) {\n        return res.status(404).json({ error: \"Campaign not found\" });\n      }\n      const campaignProduct = await storage.addCampaignProduct({\n        ...req.body,\n        campaignId: req.params.id\n      });\n      res.json(campaignProduct);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to add campaign product\" });\n    }\n  });\n\n  app.delete(\"/api/campaigns/:campaignId/products/:productId\", authenticate, requireTenant, async (req: AuthRequest, res: Response) => {\n    try {\n      await storage.removeCampaignProduct(req.params.productId);\n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to remove campaign product\" });\n    }\n  });\n\n  app.get(\"/api/messages\", authenticate, requireTenant, async (req: AuthRequest, res: Response) => {\n    try {\n      const messages = await storage.getMessagesByTenant(req.user!.tenantId!);\n      res.json(messages);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to get messages\" });\n    }\n  });\n\n  app.post(\"/api/messages\", authenticate, requireTenant, async (req: AuthRequest, res: Response) => {\n    try {\n      const data = insertMessageSchema.parse({\n        ...req.body,\n        tenantId: req.user!.tenantId,\n        senderId: req.user!.id\n      });\n      const message = await storage.createMessage(data);\n      res.json(message);\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ error: error.errors });\n      }\n      res.status(500).json({ error: \"Failed to send message\" });\n    }\n  });\n\n  app.patch(\"/api/messages/:id/read\", authenticate, async (req: AuthRequest, res: Response) => {\n    try {\n      const message = await storage.markMessageRead(req.params.id);\n      res.json(message);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to mark message read\" });\n    }\n  });\n\n  app.delete(\"/api/messages/:id\", authenticate, async (req: AuthRequest, res: Response) => {\n    try {\n      await storage.deleteMessage(req.params.id);\n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to delete message\" });\n    }\n  });\n\n  app.get(\"/api/suggestions\", authenticate, requireTenant, async (req: AuthRequest, res: Response) => {\n    try {\n      const suggestions = await storage.getSuggestionsByTenant(req.user!.tenantId!);\n      res.json(suggestions);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to get suggestions\" });\n    }\n  });\n\n  app.post(\"/api/suggestions\", authenticate, requireTenant, async (req: AuthRequest, res: Response) => {\n    try {\n      const data = insertSuggestionSchema.parse({\n        ...req.body,\n        tenantId: req.user!.tenantId,\n        userId: req.user!.id\n      });\n      const suggestion = await storage.createSuggestion(data);\n      res.json(suggestion);\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ error: error.errors });\n      }\n      res.status(500).json({ error: \"Failed to create suggestion\" });\n    }\n  });\n\n  app.patch(\"/api/suggestions/:id\", authenticate, requireRole(\"super_admin\", \"tenant_admin\"), async (req: AuthRequest, res: Response) => {\n    try {\n      const suggestion = await storage.updateSuggestion(req.params.id, req.body);\n      res.json(suggestion);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to update suggestion\" });\n    }\n  });\n\n  app.get(\"/api/tutorials\", authenticate, async (req: AuthRequest, res: Response) => {\n    try {\n      const tutorials = await storage.getAllTutorials();\n      res.json(tutorials);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to get tutorials\" });\n    }\n  });\n\n  app.post(\"/api/tutorials\", authenticate, requireRole(\"super_admin\"), async (req: AuthRequest, res: Response) => {\n    try {\n      const data = insertTutorialSchema.parse(req.body);\n      const tutorial = await storage.createTutorial(data);\n      res.json(tutorial);\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ error: error.errors });\n      }\n      res.status(500).json({ error: \"Failed to create tutorial\" });\n    }\n  });\n\n  app.patch(\"/api/tutorials/:id\", authenticate, requireRole(\"super_admin\"), async (req: AuthRequest, res: Response) => {\n    try {\n      const tutorial = await storage.updateTutorial(req.params.id, req.body);\n      res.json(tutorial);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to update tutorial\" });\n    }\n  });\n\n  app.delete(\"/api/tutorials/:id\", authenticate, requireRole(\"super_admin\"), async (req: AuthRequest, res: Response) => {\n    try {\n      await storage.deleteTutorial(req.params.id);\n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to delete tutorial\" });\n    }\n  });\n\n  app.get(\"/api/users\", authenticate, requireTenant, requireRole(\"super_admin\", \"tenant_admin\"), async (req: AuthRequest, res: Response) => {\n    try {\n      const users = await storage.getUsersByTenant(req.user!.tenantId!);\n      const safeUsers = users.map(({ password, totpSecret, ...u }) => u);\n      res.json(safeUsers);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to get users\" });\n    }\n  });\n\n  app.post(\"/api/users\", authenticate, requireTenant, requireRole(\"super_admin\", \"tenant_admin\"), async (req: AuthRequest, res: Response) => {\n    try {\n      const { email, firstName, lastName, password, role, mobilePhone } = req.body;\n      const existingUser = await storage.getUserByEmail(email);\n      if (existingUser) {\n        return res.status(400).json({ error: \"Email already exists\" });\n      }\n\n      const hashedPassword = await bcrypt.hash(password, 12);\n      const totpSecret = speakeasy.generateSecret({ name: `eBrochure:${email}` });\n\n      const user = await storage.createUser({\n        email,\n        firstName,\n        lastName,\n        password: hashedPassword,\n        role: role || \"tenant_user\",\n        tenantId: req.user!.tenantId,\n        mobilePhone: mobilePhone || null,\n        totpSecret: totpSecret.base32,\n        totpEnabled: false,\n        isActive: true\n      });\n\n      const { password: _, totpSecret: __, ...safeUser } = user;\n      res.json(safeUser);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to create user\" });\n    }\n  });\n\n  app.patch(\"/api/users/:id\", authenticate, requireTenant, requireRole(\"super_admin\", \"tenant_admin\"), async (req: AuthRequest, res: Response) => {\n    try {\n      const user = await storage.getUser(req.params.id);\n      if (!user || user.tenantId !== req.user!.tenantId) {\n        return res.status(404).json({ error: \"User not found\" });\n      }\n      \n      const updateData: any = { ...req.body };\n      if (updateData.password) {\n        updateData.password = await bcrypt.hash(updateData.password, 12);\n      }\n      \n      const updated = await storage.updateUser(req.params.id, updateData);\n      if (updated) {\n        const { password, totpSecret, ...safeUser } = updated;\n        res.json(safeUser);\n      } else {\n        res.status(404).json({ error: \"User not found\" });\n      }\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to update user\" });\n    }\n  });\n\n  app.delete(\"/api/users/:id\", authenticate, requireTenant, requireRole(\"super_admin\", \"tenant_admin\"), async (req: AuthRequest, res: Response) => {\n    try {\n      const user = await storage.getUser(req.params.id);\n      if (!user || user.tenantId !== req.user!.tenantId) {\n        return res.status(404).json({ error: \"User not found\" });\n      }\n      if (user.id === req.user!.id) {\n        return res.status(400).json({ error: \"Cannot delete yourself\" });\n      }\n      await storage.deleteUser(req.params.id);\n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to delete user\" });\n    }\n  });\n\n  app.patch(\"/api/account\", authenticate, async (req: AuthRequest, res: Response) => {\n    try {\n      const updateData: any = { ...req.body };\n      if (updateData.password) {\n        updateData.password = await bcrypt.hash(updateData.password, 12);\n      }\n      \n      const updated = await storage.updateUser(req.user!.id, updateData);\n      if (updated) {\n        const { password, totpSecret, ...safeUser } = updated;\n        res.json(safeUser);\n      } else {\n        res.status(404).json({ error: \"User not found\" });\n      }\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to update account\" });\n    }\n  });\n\n  app.get(\"/api/dashboard/stats\", authenticate, async (req: AuthRequest, res: Response) => {\n    try {\n      if (req.user!.role === \"super_admin\") {\n        const tenants = await storage.getAllTenants();\n        const allSuggestions = await storage.getAllSuggestions();\n        res.json({\n          totalTenants: tenants.length,\n          totalSuggestions: allSuggestions.length,\n          pendingSuggestions: allSuggestions.filter(s => s.status === \"pending\").length,\n          recentTenants: tenants.slice(0, 5)\n        });\n      } else {\n        const [products, campaigns, templates] = await Promise.all([\n          storage.getProductsByTenant(req.user!.tenantId!),\n          storage.getCampaignsByTenant(req.user!.tenantId!),\n          storage.getTemplatesByTenant(req.user!.tenantId!)\n        ]);\n\n        const activeCampaigns = campaigns.filter(c => c.status === \"active\").length;\n        const draftCampaigns = campaigns.filter(c => c.status === \"draft\").length;\n\n        // Generate monthly campaign data for the last 6 months\n        const now = new Date();\n        const monthNames = [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"];\n        const campaignChartData = [];\n        for (let i = 5; i >= 0; i--) {\n          const date = new Date(now.getFullYear(), now.getMonth() - i, 1);\n          const monthStart = new Date(date.getFullYear(), date.getMonth(), 1);\n          const monthEnd = new Date(date.getFullYear(), date.getMonth() + 1, 0);\n          const count = campaigns.filter(c => {\n            const createdAt = new Date(c.createdAt);\n            return createdAt >= monthStart && createdAt <= monthEnd;\n          }).length;\n          campaignChartData.push({\n            month: monthNames[date.getMonth()],\n            campaigns: count\n          });\n        }\n\n        // Generate product category breakdown\n        const categoryMap = new Map<string, number>();\n        products.forEach(p => {\n          const category = p.category || \"Uncategorized\";\n          categoryMap.set(category, (categoryMap.get(category) || 0) + 1);\n        });\n        const productCategoryData = Array.from(categoryMap.entries())\n          .map(([name, value]) => ({ name, value }))\n          .sort((a, b) => b.value - a.value)\n          .slice(0, 4);\n\n        // Generate recent activity from campaigns\n        const recentActivity = campaigns\n          .sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime())\n          .slice(0, 5)\n          .map(c => {\n            const createdAt = new Date(c.createdAt);\n            const diffMs = now.getTime() - createdAt.getTime();\n            const diffHours = Math.floor(diffMs / (1000 * 60 * 60));\n            const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));\n            let timeAgo = \"\";\n            if (diffHours < 1) timeAgo = \"Just now\";\n            else if (diffHours < 24) timeAgo = `${diffHours} hour${diffHours > 1 ? 's' : ''} ago`;\n            else timeAgo = `${diffDays} day${diffDays > 1 ? 's' : ''} ago`;\n            \n            return {\n              id: c.id,\n              action: c.status === \"active\" ? \"Published campaign\" : c.status === \"draft\" ? \"Created campaign\" : \"Updated campaign\",\n              item: c.name,\n              time: timeAgo,\n              type: \"campaign\"\n            };\n          });\n\n        res.json({\n          totalProducts: products.length,\n          totalCampaigns: campaigns.length,\n          activeCampaigns,\n          draftCampaigns,\n          totalTemplates: templates.length,\n          recentCampaigns: campaigns.slice(0, 5),\n          campaignChartData,\n          productCategoryData,\n          recentActivity\n        });\n      }\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to get dashboard stats\" });\n    }\n  });\n\n  app.get(\"/api/admin/tenants\", authenticate, requireRole(\"super_admin\"), async (req: AuthRequest, res: Response) => {\n    try {\n      const tenants = await storage.getAllTenants();\n      const tenantsWithDetails = await Promise.all(\n        tenants.map(async (tenant) => {\n          const users = await storage.getUsersByTenant(tenant.id);\n          const subscription = await storage.getSubscriptionByTenant(tenant.id);\n          return {\n            ...tenant,\n            userCount: users.length,\n            subscription\n          };\n        })\n      );\n      res.json(tenantsWithDetails);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to get tenants\" });\n    }\n  });\n\n  app.get(\"/api/admin/tenants/:id\", authenticate, requireRole(\"super_admin\"), async (req: AuthRequest, res: Response) => {\n    try {\n      const tenant = await storage.getTenant(req.params.id);\n      if (!tenant) {\n        return res.status(404).json({ error: \"Tenant not found\" });\n      }\n      const users = await storage.getUsersByTenant(tenant.id);\n      const subscription = await storage.getSubscriptionByTenant(tenant.id);\n      const campaigns = await storage.getCampaignsByTenant(tenant.id);\n      res.json({\n        ...tenant,\n        users: users.map(({ password, totpSecret, ...u }) => u),\n        subscription,\n        campaignCount: campaigns.length\n      });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to get tenant\" });\n    }\n  });\n\n  app.post(\"/api/admin/tenants\", authenticate, requireRole(\"super_admin\"), async (req: AuthRequest, res: Response) => {\n    try {\n      const { name, slug } = req.body;\n      const existingTenant = await storage.getTenantBySlug(slug);\n      if (existingTenant) {\n        return res.status(400).json({ error: \"Tenant slug already exists\" });\n      }\n      \n      const generateTenantCode = () => {\n        const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789';\n        let code = '';\n        for (let i = 0; i < 8; i++) {\n          code += chars.charAt(Math.floor(Math.random() * chars.length));\n        }\n        return code;\n      };\n\n      let tenantCode = generateTenantCode();\n      let existingCodeTenant = await storage.getTenantByCode(tenantCode);\n      while (existingCodeTenant) {\n        tenantCode = generateTenantCode();\n        existingCodeTenant = await storage.getTenantByCode(tenantCode);\n      }\n      \n      const tenant = await storage.createTenant({ name, slug, code: tenantCode });\n      res.json(tenant);\n    } catch (error) {\n      console.error(\"Failed to create tenant:\", error);\n      res.status(500).json({ error: \"Failed to create tenant\" });\n    }\n  });\n\n  app.patch(\"/api/admin/tenants/:id\", authenticate, requireRole(\"super_admin\"), async (req: AuthRequest, res: Response) => {\n    try {\n      const tenant = await storage.updateTenant(req.params.id, req.body);\n      res.json(tenant);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to update tenant\" });\n    }\n  });\n\n  app.delete(\"/api/admin/tenants/:id\", authenticate, requireRole(\"super_admin\"), async (req: AuthRequest, res: Response) => {\n    try {\n      await storage.deleteTenant(req.params.id);\n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to delete tenant\" });\n    }\n  });\n\n  app.post(\"/api/admin/tenants/:id/impersonate\", authenticate, requireRole(\"super_admin\"), async (req: AuthRequest, res: Response) => {\n    try {\n      const tenant = await storage.getTenant(req.params.id);\n      if (!tenant) {\n        return res.status(404).json({ error: \"Tenant not found\" });\n      }\n      \n      const users = await storage.getUsersByTenant(tenant.id);\n      const tenantAdmin = users.find(u => u.role === \"tenant_admin\");\n      \n      if (!tenantAdmin) {\n        return res.status(400).json({ error: \"No tenant admin found for this tenant\" });\n      }\n      \n      const impersonationToken = jwt.sign(\n        { \n          userId: tenantAdmin.id,\n          impersonatedBy: req.user!.id,\n          isImpersonation: true\n        },\n        JWT_SECRET,\n        { expiresIn: \"2h\" }\n      );\n      \n      const { password, totpSecret, ...safeUser } = tenantAdmin;\n      res.json({ \n        user: safeUser, \n        token: impersonationToken,\n        tenant\n      });\n    } catch (error) {\n      console.error(\"Failed to impersonate tenant:\", error);\n      res.status(500).json({ error: \"Failed to impersonate tenant\" });\n    }\n  });\n\n  app.get(\"/api/admin/suggestions\", authenticate, requireRole(\"super_admin\"), async (req: AuthRequest, res: Response) => {\n    try {\n      const allSuggestions = await storage.getAllSuggestions();\n      res.json(allSuggestions);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to get suggestions\" });\n    }\n  });\n\n  app.delete(\"/api/admin/suggestions/:id\", authenticate, requireRole(\"super_admin\"), async (req: AuthRequest, res: Response) => {\n    try {\n      await storage.deleteSuggestion(req.params.id);\n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to delete suggestion\" });\n    }\n  });\n\n  app.get(\"/api/admin/settings/:key\", authenticate, requireRole(\"super_admin\"), async (req: AuthRequest, res: Response) => {\n    try {\n      const config = await storage.getSystemConfig(req.params.key);\n      res.json(config?.value || null);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to get setting\" });\n    }\n  });\n\n  app.get(\"/api/admin/settings\", authenticate, requireRole(\"super_admin\"), async (req: AuthRequest, res: Response) => {\n    try {\n      const [iyzicoConfig, productApiConfig, emailConfig] = await Promise.all([\n        storage.getSystemConfig(\"iyzico\"),\n        storage.getSystemConfig(\"product_api\"),\n        storage.getSystemConfig(\"email\")\n      ]);\n      res.json({\n        iyzico: iyzicoConfig?.value || null,\n        productApi: productApiConfig?.value || null,\n        email: emailConfig?.value || null\n      });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to get settings\" });\n    }\n  });\n\n  app.post(\"/api/admin/settings/:key\", authenticate, requireRole(\"super_admin\"), async (req: AuthRequest, res: Response) => {\n    try {\n      const config = await storage.setSystemConfig(req.params.key, req.body.value);\n      res.json(config);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to save setting\" });\n    }\n  });\n\n  app.post(\"/api/admin/sync-products\", authenticate, requireRole(\"super_admin\"), async (req: AuthRequest, res: Response) => {\n    try {\n      const productApiConfig = await storage.getSystemConfig(\"product_api\");\n      if (!productApiConfig?.value) {\n        return res.status(400).json({ error: \"Product API not configured\" });\n      }\n      res.json({ success: true, message: \"Product sync initiated\" });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to sync products\" });\n    }\n  });\n\n  app.post(\"/api/admin/test-email\", authenticate, requireRole(\"super_admin\"), async (req: AuthRequest, res: Response) => {\n    try {\n      const { sendTestEmail } = await import(\"./email\");\n      const user = req.user!;\n      const success = await sendTestEmail(user.email, user.firstName, storage);\n      if (success) {\n        res.json({ success: true, message: \"Test email sent\" });\n      } else {\n        res.status(500).json({ error: \"Failed to send test email\" });\n      }\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to send test email\" });\n    }\n  });\n\n  // Product Connector routes\n  app.get(\"/api/admin/product-connectors\", authenticate, requireRole(\"super_admin\"), async (req: AuthRequest, res: Response) => {\n    try {\n      const connectors = await storage.getAllProductConnectors();\n      res.json(connectors);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to get product connectors\" });\n    }\n  });\n\n  app.get(\"/api/admin/product-connectors/:id\", authenticate, requireRole(\"super_admin\"), async (req: AuthRequest, res: Response) => {\n    try {\n      const connector = await storage.getProductConnector(req.params.id);\n      if (!connector) {\n        return res.status(404).json({ error: \"Connector not found\" });\n      }\n      res.json(connector);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to get product connector\" });\n    }\n  });\n\n  app.post(\"/api/admin/product-connectors\", authenticate, requireRole(\"super_admin\"), async (req: AuthRequest, res: Response) => {\n    try {\n      const connector = await storage.createProductConnector(req.body);\n      res.status(201).json(connector);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to create product connector\" });\n    }\n  });\n\n  app.patch(\"/api/admin/product-connectors/:id\", authenticate, requireRole(\"super_admin\"), async (req: AuthRequest, res: Response) => {\n    try {\n      const connector = await storage.updateProductConnector(req.params.id, req.body);\n      if (!connector) {\n        return res.status(404).json({ error: \"Connector not found\" });\n      }\n      res.json(connector);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to update product connector\" });\n    }\n  });\n\n  app.delete(\"/api/admin/product-connectors/:id\", authenticate, requireRole(\"super_admin\"), async (req: AuthRequest, res: Response) => {\n    try {\n      await storage.deleteProductConnector(req.params.id);\n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to delete product connector\" });\n    }\n  });\n\n  app.post(\"/api/admin/product-connectors/:id/test\", authenticate, requireRole(\"super_admin\"), async (req: AuthRequest, res: Response) => {\n    try {\n      const connector = await storage.getProductConnector(req.params.id);\n      if (!connector) {\n        return res.status(404).json({ error: \"Connector not found\" });\n      }\n      \n      const { searchQuery } = req.body;\n      const result = await executeConnectorSearch(connector, searchQuery || \"test\");\n      res.json({ success: true, products: result });\n    } catch (error: any) {\n      res.status(500).json({ error: error.message || \"Failed to test connector\" });\n    }\n  });\n\n  return httpServer;\n}\n\nasync function executeConnectorSearch(connector: any, searchQuery: string): Promise<any[]> {\n  const { requestMethod, requestUrl, requestHeaders, requestParams, requestBody, responseParser, fieldMappings } = connector;\n  \n  console.log(\"[DEBUG] executeConnectorSearch called with searchQuery:\", searchQuery);\n  console.log(\"[DEBUG] Connector config:\", { requestMethod, requestUrl, requestParams, responseParser, fieldMappings });\n  \n  // Build URL with parameters\n  // First, extract base URL (remove any existing query string that might have empty placeholders)\n  let baseUrl = requestUrl;\n  const existingParams = new URLSearchParams();\n  \n  // Parse existing URL to separate base and query params\n  if (requestUrl.includes(\"?\")) {\n    const urlParts = requestUrl.split(\"?\");\n    baseUrl = urlParts[0];\n    // Parse existing query string but ignore empty values\n    const existingQuery = new URLSearchParams(urlParts[1]);\n    existingQuery.forEach((value, key) => {\n      if (value && value.trim()) {\n        existingParams.append(key, value);\n      }\n    });\n  }\n  \n  // Add request params, replacing empty/placeholder values with search query\n  if (requestParams && Array.isArray(requestParams)) {\n    for (const param of requestParams) {\n      let value = param.value;\n      console.log(\"[DEBUG] Processing param:\", param, \"original value:\", value);\n      // Use search query if value is empty, matches the key, or is a placeholder\n      if (!value || value === param.key || value === \"{{search}}\" || value === \"q\") {\n        value = searchQuery;\n        console.log(\"[DEBUG] Replaced with searchQuery:\", value);\n      }\n      existingParams.set(param.key, value); // Use set to override any existing empty param\n    }\n  }\n  \n  // If no requestParams but URL had an empty q= parameter, add search query\n  if ((!requestParams || requestParams.length === 0) && requestUrl.includes(\"?q=\")) {\n    existingParams.set(\"q\", searchQuery);\n    console.log(\"[DEBUG] No requestParams, but URL has q= placeholder, setting q to:\", searchQuery);\n  }\n  \n  // Build final URL\n  let url = baseUrl;\n  if (existingParams.toString()) {\n    url += \"?\" + existingParams.toString();\n  }\n\n  console.log(\"[DEBUG] Final request URL:\", url);\n\n  // Prepare headers\n  const headers: Record<string, string> = { \"Content-Type\": \"application/json\" };\n  if (requestHeaders && typeof requestHeaders === \"object\") {\n    Object.assign(headers, requestHeaders);\n  }\n\n  // Prepare request body\n  let body: string | undefined;\n  if (requestMethod !== \"GET\" && requestBody) {\n    body = requestBody.replace(/\\{\\{search\\}\\}/g, searchQuery);\n  }\n\n  // Make the request\n  console.log(\"[DEBUG] Making fetch request to:\", url);\n  const response = await fetch(url, {\n    method: requestMethod,\n    headers,\n    body,\n  });\n\n  console.log(\"[DEBUG] Response status:\", response.status, response.statusText);\n\n  if (!response.ok) {\n    throw new Error(`API request failed: ${response.status} ${response.statusText}`);\n  }\n\n  const data = await response.json();\n  console.log(\"[DEBUG] Response data:\", JSON.stringify(data).substring(0, 500));\n  \n  // Parse response using JSONPath-like expression\n  let products = parseJsonPath(data, responseParser);\n  \n  if (!Array.isArray(products)) {\n    products = [products];\n  }\n\n  // Map fields according to fieldMappings\n  const mappings = fieldMappings as { name: string; image: string; price?: string; sku?: string };\n  return products.map((item: any) => ({\n    id: `external-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n    name: getValueByPath(item, mappings.name || \"\") || \"Unknown Product\",\n    imageUrl: getValueByPath(item, mappings.image || \"\") || \"\",\n    price: getValueByPath(item, mappings.price || \"\") || \"0\",\n    sku: getValueByPath(item, mappings.sku || \"\") || \"\",\n    isExternal: true,\n  }));\n}\n\nfunction parseJsonPath(data: any, path: string): any {\n  if (!path || path === \"$\" || path === \".\") {\n    return data;\n  }\n  \n  // Handle jq-like syntax: .data.products or $.data.products\n  const cleanPath = path.replace(/^\\$\\.?/, \"\").replace(/^\\./, \"\");\n  if (!cleanPath) return data;\n  \n  const parts = cleanPath.split(/\\.|\\[|\\]/).filter(Boolean);\n  let result = data;\n  \n  for (const part of parts) {\n    if (result === undefined || result === null) break;\n    if (Array.isArray(result) && part === \"*\") {\n      continue;\n    }\n    result = result[part];\n  }\n  \n  return result;\n}\n\nfunction getValueByPath(obj: any, path: string): any {\n  if (!path) return undefined;\n  const cleanPath = path.replace(/^\\$\\.?/, \"\").replace(/^\\./, \"\");\n  const parts = cleanPath.split(/\\.|\\[|\\]/).filter(Boolean);\n  let result = obj;\n  \n  for (const part of parts) {\n    if (result === undefined || result === null) break;\n    result = result[part];\n  }\n  \n  return result;\n}\n","path":null,"size_bytes":60813,"size_tokens":null},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","path":null,"size_bytes":1280,"size_tokens":null},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","path":null,"size_bytes":3895,"size_tokens":null},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","path":null,"size_bytes":1056,"size_tokens":null},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","path":null,"size_bytes":4845,"size_tokens":null},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","path":null,"size_bytes":4420,"size_tokens":null},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","path":null,"size_bytes":2765,"size_tokens":null},"client/src/components/app-sidebar.tsx":{"content":"import { useTranslation } from \"react-i18next\";\nimport { Link, useLocation } from \"wouter\";\nimport { \n  LayoutDashboard, \n  Package, \n  FileText, \n  Megaphone, \n  Share2, \n  MessageSquare, \n  Lightbulb, \n  BookOpen, \n  Settings, \n  Users,\n  LogOut,\n  Building2,\n  Settings2,\n  Building\n} from \"lucide-react\";\nimport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarMenu,\n  SidebarMenuButton,\n  SidebarMenuItem,\n} from \"@/components/ui/sidebar\";\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { useAuth } from \"@/lib/auth-context\";\n\nexport function AppSidebar() {\n  const { t } = useTranslation();\n  const [location] = useLocation();\n  const { user, logout } = useAuth();\n\n  const mainNavItems = [\n    { title: t(\"nav.dashboard\"), url: \"/dashboard\", icon: LayoutDashboard },\n    { title: t(\"nav.products\"), url: \"/products\", icon: Package },\n    { title: t(\"nav.templates\"), url: \"/templates\", icon: FileText },\n    { title: t(\"nav.campaigns\"), url: \"/campaigns\", icon: Megaphone },\n    { title: t(\"nav.sharing\"), url: \"/sharing\", icon: Share2 },\n  ];\n\n  const communicationItems = [\n    { title: t(\"nav.messages\"), url: \"/messages\", icon: MessageSquare },\n    { title: t(\"nav.suggestions\"), url: \"/suggestions\", icon: Lightbulb },\n    { title: t(\"nav.tutorials\"), url: \"/tutorials\", icon: BookOpen },\n  ];\n\n  const adminItems = [\n    { title: t(\"nav.users\"), url: \"/users\", icon: Users },\n    { title: t(\"nav.organization\"), url: \"/organization\", icon: Building },\n  ];\n\n  const superAdminItems = [\n    { title: t(\"nav.tenants\"), url: \"/tenants\", icon: Building2 },\n    { title: t(\"nav.settings\"), url: \"/settings\", icon: Settings2 },\n  ];\n\n  const isActive = (url: string) => location === url || (url !== \"/dashboard\" && location.startsWith(url));\n\n  const roleLabel = user?.role === \"super_admin\" \n    ? t(\"users.superAdmin\") \n    : user?.role === \"tenant_admin\" \n    ? t(\"users.tenantAdmin\") \n    : t(\"users.tenantUser\");\n\n  const roleVariant = user?.role === \"super_admin\" \n    ? \"default\" \n    : user?.role === \"tenant_admin\" \n    ? \"secondary\" \n    : \"outline\";\n\n  return (\n    <Sidebar>\n      <SidebarHeader className=\"p-4 border-b border-sidebar-border\">\n        <div className=\"flex items-center gap-3\">\n          <div className=\"flex h-10 w-10 items-center justify-center rounded-md bg-primary text-primary-foreground font-bold text-lg\">\n            eB\n          </div>\n          <div className=\"flex flex-col\">\n            <span className=\"font-semibold text-lg\">{t(\"app.name\")}</span>\n            <span className=\"text-xs text-muted-foreground\">{t(\"app.tagline\")}</span>\n          </div>\n        </div>\n      </SidebarHeader>\n\n      <SidebarContent className=\"px-2\">\n        <SidebarGroup>\n          <SidebarGroupLabel className=\"px-2 text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n            Main\n          </SidebarGroupLabel>\n          <SidebarGroupContent>\n            <SidebarMenu>\n              {mainNavItems.map((item) => (\n                <SidebarMenuItem key={item.title}>\n                  <SidebarMenuButton\n                    asChild\n                    isActive={isActive(item.url)}\n                    data-testid={`nav-${item.url.slice(1)}`}\n                  >\n                    <Link href={item.url}>\n                      <item.icon className=\"h-4 w-4\" />\n                      <span>{item.title}</span>\n                    </Link>\n                  </SidebarMenuButton>\n                </SidebarMenuItem>\n              ))}\n            </SidebarMenu>\n          </SidebarGroupContent>\n        </SidebarGroup>\n\n        <SidebarGroup>\n          <SidebarGroupLabel className=\"px-2 text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n            Communication\n          </SidebarGroupLabel>\n          <SidebarGroupContent>\n            <SidebarMenu>\n              {communicationItems.map((item) => (\n                <SidebarMenuItem key={item.title}>\n                  <SidebarMenuButton\n                    asChild\n                    isActive={isActive(item.url)}\n                    data-testid={`nav-${item.url.slice(1)}`}\n                  >\n                    <Link href={item.url}>\n                      <item.icon className=\"h-4 w-4\" />\n                      <span>{item.title}</span>\n                    </Link>\n                  </SidebarMenuButton>\n                </SidebarMenuItem>\n              ))}\n            </SidebarMenu>\n          </SidebarGroupContent>\n        </SidebarGroup>\n\n        {(user?.role === \"super_admin\" || user?.role === \"tenant_admin\") && (\n          <SidebarGroup>\n            <SidebarGroupLabel className=\"px-2 text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n              Administration\n            </SidebarGroupLabel>\n            <SidebarGroupContent>\n              <SidebarMenu>\n                {adminItems.map((item) => (\n                  <SidebarMenuItem key={item.title}>\n                    <SidebarMenuButton\n                      asChild\n                      isActive={isActive(item.url)}\n                      data-testid={`nav-${item.url.slice(1)}`}\n                    >\n                      <Link href={item.url}>\n                        <item.icon className=\"h-4 w-4\" />\n                        <span>{item.title}</span>\n                      </Link>\n                    </SidebarMenuButton>\n                  </SidebarMenuItem>\n                ))}\n              </SidebarMenu>\n            </SidebarGroupContent>\n          </SidebarGroup>\n        )}\n\n        {user?.role === \"super_admin\" && (\n          <SidebarGroup>\n            <SidebarGroupLabel className=\"px-2 text-xs font-medium text-muted-foreground uppercase tracking-wider\" data-testid=\"nav-superadmin-section\">\n              {t(\"nav.superAdmin\")}\n            </SidebarGroupLabel>\n            <SidebarGroupContent>\n              <SidebarMenu>\n                {superAdminItems.map((item) => (\n                  <SidebarMenuItem key={item.title}>\n                    <SidebarMenuButton\n                      asChild\n                      isActive={isActive(item.url)}\n                      data-testid={`nav-${item.url.slice(1)}`}\n                    >\n                      <Link href={item.url}>\n                        <item.icon className=\"h-4 w-4\" />\n                        <span>{item.title}</span>\n                      </Link>\n                    </SidebarMenuButton>\n                  </SidebarMenuItem>\n                ))}\n              </SidebarMenu>\n            </SidebarGroupContent>\n          </SidebarGroup>\n        )}\n      </SidebarContent>\n\n      <SidebarFooter className=\"p-4 border-t border-sidebar-border\">\n        <div className=\"flex items-center gap-3 mb-3\">\n          <Avatar className=\"h-9 w-9\">\n            <AvatarFallback className=\"bg-primary/10 text-primary text-sm\">\n              {user?.firstName?.[0]}{user?.lastName?.[0]}\n            </AvatarFallback>\n          </Avatar>\n          <div className=\"flex flex-col flex-1 min-w-0\">\n            <span className=\"text-sm font-medium truncate\">\n              {user?.firstName} {user?.lastName}\n            </span>\n            <Badge variant={roleVariant} className=\"w-fit text-xs\">\n              {roleLabel}\n            </Badge>\n          </div>\n        </div>\n        <div className=\"flex gap-2\">\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            className=\"flex-1 justify-start\"\n            asChild\n            data-testid=\"nav-account\"\n          >\n            <Link href=\"/account\">\n              <Settings className=\"h-4 w-4 mr-2\" />\n              {t(\"nav.account\")}\n            </Link>\n          </Button>\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            onClick={logout}\n            data-testid=\"button-logout\"\n          >\n            <LogOut className=\"h-4 w-4\" />\n          </Button>\n        </div>\n      </SidebarFooter>\n    </Sidebar>\n  );\n}\n","path":null,"size_bytes":8102,"size_tokens":null},"client/src/components/ui/sidebar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, VariantProps } from \"class-variance-authority\"\nimport { PanelLeftIcon } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nfunction SidebarProvider({\n  defaultOpen = true,\n  open: openProp,\n  onOpenChange: setOpenProp,\n  className,\n  style,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  defaultOpen?: boolean\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n}) {\n  const isMobile = useIsMobile()\n  const [openMobile, setOpenMobile] = React.useState(false)\n\n  // This is the internal state of the sidebar.\n  // We use openProp and setOpenProp for control from outside the component.\n  const [_open, _setOpen] = React.useState(defaultOpen)\n  const open = openProp ?? _open\n  const setOpen = React.useCallback(\n    (value: boolean | ((value: boolean) => boolean)) => {\n      const openState = typeof value === \"function\" ? value(open) : value\n      if (setOpenProp) {\n        setOpenProp(openState)\n      } else {\n        _setOpen(openState)\n      }\n\n      // This sets the cookie to keep the sidebar state.\n      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n    },\n    [setOpenProp, open]\n  )\n\n  // Helper to toggle the sidebar.\n  const toggleSidebar = React.useCallback(() => {\n    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open)\n  }, [isMobile, setOpen, setOpenMobile])\n\n  // Adds a keyboard shortcut to toggle the sidebar.\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (\n        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n        (event.metaKey || event.ctrlKey)\n      ) {\n        event.preventDefault()\n        toggleSidebar()\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown)\n  }, [toggleSidebar])\n\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n  // This makes it easier to style the sidebar with Tailwind classes.\n  const state = open ? \"expanded\" : \"collapsed\"\n\n  const contextValue = React.useMemo<SidebarContextProps>(\n    () => ({\n      state,\n      open,\n      setOpen,\n      isMobile,\n      openMobile,\n      setOpenMobile,\n      toggleSidebar,\n    }),\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n  )\n\n  return (\n    <SidebarContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          data-slot=\"sidebar-wrapper\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH,\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n              ...style,\n            } as React.CSSProperties\n          }\n          className={cn(\n            \"group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full\",\n            className\n          )}\n          {...props}\n        >\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidebarContext.Provider>\n  )\n}\n\nfunction Sidebar({\n  side = \"left\",\n  variant = \"sidebar\",\n  collapsible = \"offcanvas\",\n  className,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  side?: \"left\" | \"right\"\n  variant?: \"sidebar\" | \"floating\" | \"inset\"\n  collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n}) {\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n  if (collapsible === \"none\") {\n    return (\n      <div\n        data-slot=\"sidebar\"\n        className={cn(\n          \"bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n      </div>\n    )\n  }\n\n  if (isMobile) {\n    return (\n      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n        <SheetContent\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar\"\n          data-mobile=\"true\"\n          className=\"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n            } as React.CSSProperties\n          }\n          side={side}\n        >\n          <SheetHeader className=\"sr-only\">\n            <SheetTitle>Sidebar</SheetTitle>\n            <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n          </SheetHeader>\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>\n    )\n  }\n\n  return (\n    <div\n      className=\"group peer text-sidebar-foreground hidden md:block\"\n      data-state={state}\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n      data-variant={variant}\n      data-side={side}\n      data-slot=\"sidebar\"\n    >\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        data-slot=\"sidebar-gap\"\n        className={cn(\n          \"relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear\",\n          \"group-data-[collapsible=offcanvas]:w-0\",\n          \"group-data-[side=right]:rotate-180\",\n          variant === \"floating\" || variant === \"inset\"\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]\"\n        )}\n      />\n      <div\n        data-slot=\"sidebar-container\"\n        className={cn(\n          \"fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex\",\n          side === \"left\"\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n          // Adjust the padding for floating and inset variants.\n          variant === \"floating\" || variant === \"inset\"\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n          className\n        )}\n        {...props}\n      >\n        <div\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar-inner\"\n          className=\"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm\"\n        >\n          {children}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction SidebarTrigger({\n  className,\n  onClick,\n  ...props\n}: React.ComponentProps<typeof Button>) {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      data-sidebar=\"trigger\"\n      data-slot=\"sidebar-trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeftIcon />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n}\n\nfunction SidebarRail({ className, ...props }: React.ComponentProps<\"button\">) {\n  const { toggleSidebar } = useSidebar()\n\n  // Note: Tailwind v3.4 doesn't support \"in-\" selectors. So the rail won't work perfectly.\n  return (\n    <button\n      data-sidebar=\"rail\"\n      data-slot=\"sidebar-rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex\",\n        \"in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInset({ className, ...props }: React.ComponentProps<\"main\">) {\n  return (\n    <main\n      data-slot=\"sidebar-inset\"\n      className={cn(\n        \"bg-background relative flex w-full flex-1 flex-col\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInput({\n  className,\n  ...props\n}: React.ComponentProps<typeof Input>) {\n  return (\n    <Input\n      data-slot=\"sidebar-input\"\n      data-sidebar=\"input\"\n      className={cn(\"bg-background h-8 w-full shadow-none\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-header\"\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-footer\"\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"sidebar-separator\"\n      data-sidebar=\"separator\"\n      className={cn(\"bg-sidebar-border mx-2 w-auto\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-content\"\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group\"\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupLabel({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-label\"\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupAction({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-action\"\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupContent({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group-content\"\n      data-sidebar=\"group-content\"\n      className={cn(\"w-full text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenu({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu\"\n      data-sidebar=\"menu\"\n      className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuItem({ className, ...props }: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-item\"\n      data-sidebar=\"menu-item\"\n      className={cn(\"group/menu-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:p-0!\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction SidebarMenuButton({\n  asChild = false,\n  isActive = false,\n  variant = \"default\",\n  size = \"default\",\n  tooltip,\n  className,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  isActive?: boolean\n  tooltip?: string | React.ComponentProps<typeof TooltipContent>\n} & VariantProps<typeof sidebarMenuButtonVariants>) {\n  const Comp = asChild ? Slot : \"button\"\n  const { isMobile, state } = useSidebar()\n\n  const button = (\n    <Comp\n      data-slot=\"sidebar-menu-button\"\n      data-sidebar=\"menu-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n      {...props}\n    />\n  )\n\n  if (!tooltip) {\n    return button\n  }\n\n  if (typeof tooltip === \"string\") {\n    tooltip = {\n      children: tooltip,\n    }\n  }\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\n      <TooltipContent\n        side=\"right\"\n        align=\"center\"\n        hidden={state !== \"collapsed\" || isMobile}\n        {...tooltip}\n      />\n    </Tooltip>\n  )\n}\n\nfunction SidebarMenuAction({\n  className,\n  asChild = false,\n  showOnHover = false,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  showOnHover?: boolean\n}) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-action\"\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuBadge({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-menu-badge\"\n      data-sidebar=\"menu-badge\"\n      className={cn(\n        \"text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none\",\n        \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSkeleton({\n  className,\n  showIcon = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  showIcon?: boolean\n}) {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      data-slot=\"sidebar-menu-skeleton\"\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[var(--skeleton-width)] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n}\n\nfunction SidebarMenuSub({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu-sub\"\n      data-sidebar=\"menu-sub\"\n      className={cn(\n        \"border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubItem({\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-sub-item\"\n      data-sidebar=\"menu-sub-item\"\n      className={cn(\"group/menu-sub-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubButton({\n  asChild = false,\n  size = \"md\",\n  isActive = false,\n  className,\n  ...props\n}: React.ComponentProps<\"a\"> & {\n  asChild?: boolean\n  size?: \"sm\" | \"md\"\n  isActive?: boolean\n}) {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-sub-button\"\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline outline-2 outline-transparent outline-offset-2 focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","path":null,"size_bytes":21846,"size_tokens":null},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","path":null,"size_bytes":1883,"size_tokens":null},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  // Whitespace-nowrap: Badges should never wrap.\n  \"whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\" +\n  \" hover-elevate \" ,\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground shadow-xs\",\n        secondary: \"border-transparent bg-secondary text-secondary-foreground\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground shadow-xs\",\n\n        outline: \" border [border-color:var(--badge-outline)] shadow-xs\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  },\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  );\n}\n\nexport { Badge, badgeVariants }\n","path":null,"size_bytes":1202,"size_tokens":null},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","path":null,"size_bytes":325,"size_tokens":null},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","path":null,"size_bytes":5741,"size_tokens":null},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","path":null,"size_bytes":1527,"size_tokens":null},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","path":null,"size_bytes":1977,"size_tokens":null},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","path":null,"size_bytes":2154,"size_tokens":null},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { serveStatic } from \"./static\";\nimport { createServer } from \"http\";\n\nconst app = express();\nconst httpServer = createServer(app);\n\ndeclare module \"http\" {\n  interface IncomingMessage {\n    rawBody: unknown;\n  }\n}\n\napp.use(\n  express.json({\n    verify: (req, _res, buf) => {\n      req.rawBody = buf;\n    },\n  }),\n);\n\napp.use(express.urlencoded({ extended: false }));\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  await registerRoutes(httpServer, app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (process.env.NODE_ENV === \"production\") {\n    serveStatic(app);\n  } else {\n    const { setupVite } = await import(\"./vite\");\n    await setupVite(httpServer, app);\n  }\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || \"5000\", 10);\n  httpServer.listen(\n    {\n      port,\n      host: \"0.0.0.0\",\n      reusePort: true,\n    },\n    () => {\n      log(`serving on port ${port}`);\n    },\n  );\n})();\n","path":null,"size_bytes":2560,"size_tokens":null},"shared/schema.ts":{"content":"import { sql } from \"drizzle-orm\";\nimport { pgTable, text, varchar, integer, boolean, timestamp, jsonb, decimal, pgEnum } from \"drizzle-orm/pg-core\";\nimport { relations } from \"drizzle-orm\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\nexport const userRoleEnum = pgEnum(\"user_role\", [\"super_admin\", \"tenant_admin\", \"tenant_user\"]);\nexport const subscriptionStatusEnum = pgEnum(\"subscription_status\", [\"active\", \"expired\", \"pending\", \"cancelled\"]);\nexport const subscriptionPlanEnum = pgEnum(\"subscription_plan\", [\"monthly\", \"six_month\", \"yearly\"]);\nexport const templateTypeEnum = pgEnum(\"template_type\", [\"single_page\", \"multi_page\"]);\nexport const campaignStatusEnum = pgEnum(\"campaign_status\", [\"draft\", \"active\", \"scheduled\", \"completed\", \"paused\"]);\nexport const tutorialTypeEnum = pgEnum(\"tutorial_type\", [\"video\", \"pdf\", \"announcement\"]);\nexport const joinRequestStatusEnum = pgEnum(\"join_request_status\", [\"pending\", \"approved\", \"rejected\"]);\n\nexport const tenants = pgTable(\"tenants\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  name: text(\"name\").notNull(),\n  slug: text(\"slug\").notNull().unique(),\n  code: text(\"code\").unique(),\n  logoUrl: text(\"logo_url\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").references(() => tenants.id),\n  email: text(\"email\").notNull().unique(),\n  password: text(\"password\").notNull(),\n  firstName: text(\"first_name\").notNull(),\n  lastName: text(\"last_name\").notNull(),\n  mobilePhone: text(\"mobile_phone\"),\n  role: userRoleEnum(\"role\").notNull().default(\"tenant_user\"),\n  totpSecret: text(\"totp_secret\"),\n  totpEnabled: boolean(\"totp_enabled\").default(false),\n  isActive: boolean(\"is_active\").default(false),\n  activationToken: text(\"activation_token\"),\n  activationTokenExpiry: timestamp(\"activation_token_expiry\"),\n  resetToken: text(\"reset_token\"),\n  resetTokenExpiry: timestamp(\"reset_token_expiry\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  language: text(\"language\").default(\"en\"),\n});\n\nexport const joinRequests = pgTable(\"join_requests\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").references(() => users.id).notNull(),\n  tenantId: varchar(\"tenant_id\").references(() => tenants.id).notNull(),\n  status: joinRequestStatusEnum(\"status\").notNull().default(\"pending\"),\n  message: text(\"message\"),\n  reviewedBy: varchar(\"reviewed_by\").references(() => users.id),\n  reviewedAt: timestamp(\"reviewed_at\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\nexport const subscriptions = pgTable(\"subscriptions\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").references(() => tenants.id).notNull(),\n  plan: subscriptionPlanEnum(\"plan\").notNull(),\n  status: subscriptionStatusEnum(\"status\").notNull().default(\"pending\"),\n  pricePerMonth: decimal(\"price_per_month\", { precision: 10, scale: 2 }).notNull(),\n  startDate: timestamp(\"start_date\"),\n  endDate: timestamp(\"end_date\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\nexport const products = pgTable(\"products\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").references(() => tenants.id),\n  name: text(\"name\").notNull(),\n  description: text(\"description\"),\n  category: text(\"category\"),\n  price: decimal(\"price\", { precision: 10, scale: 2 }).notNull(),\n  discountPrice: decimal(\"discount_price\", { precision: 10, scale: 2 }),\n  discountPercentage: integer(\"discount_percentage\"),\n  imageUrl: text(\"image_url\"),\n  sku: text(\"sku\"),\n  isGlobal: boolean(\"is_global\").default(false),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\nexport const templates = pgTable(\"templates\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").references(() => tenants.id),\n  title: text(\"title\").notNull(),\n  type: templateTypeEnum(\"type\").notNull(),\n  coverPageConfig: jsonb(\"cover_page_config\"),\n  innerPageConfig: jsonb(\"inner_page_config\"),\n  backPageConfig: jsonb(\"back_page_config\"),\n  priceTemplateConfig: jsonb(\"price_template_config\"),\n  fontFamily: text(\"font_family\").default(\"Inter\"),\n  textColor: text(\"text_color\").default(\"#000000\"),\n  backgroundColor: text(\"background_color\").default(\"#ffffff\"),\n  thumbnailUrl: text(\"thumbnail_url\"),\n  isGlobal: boolean(\"is_global\").default(false),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\nexport const campaigns = pgTable(\"campaigns\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").references(() => tenants.id).notNull(),\n  createdBy: varchar(\"created_by\").references(() => users.id).notNull(),\n  templateId: varchar(\"template_id\").references(() => templates.id),\n  name: text(\"name\").notNull(),\n  description: text(\"description\"),\n  status: campaignStatusEnum(\"status\").notNull().default(\"draft\"),\n  startDate: timestamp(\"start_date\"),\n  endDate: timestamp(\"end_date\"),\n  canvasData: jsonb(\"canvas_data\"),\n  thumbnailUrl: text(\"thumbnail_url\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\").defaultNow().notNull(),\n});\n\nexport const campaignProducts = pgTable(\"campaign_products\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  campaignId: varchar(\"campaign_id\").references(() => campaigns.id).notNull(),\n  productId: varchar(\"product_id\").references(() => products.id).notNull(),\n  positionX: integer(\"position_x\"),\n  positionY: integer(\"position_y\"),\n  width: integer(\"width\"),\n  height: integer(\"height\"),\n  pageNumber: integer(\"page_number\").default(1),\n});\n\nexport const messages = pgTable(\"messages\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").references(() => tenants.id),\n  senderId: varchar(\"sender_id\").references(() => users.id).notNull(),\n  receiverId: varchar(\"receiver_id\").references(() => users.id).notNull(),\n  subject: text(\"subject\"),\n  content: text(\"content\").notNull(),\n  isRead: boolean(\"is_read\").default(false),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\nexport const suggestions = pgTable(\"suggestions\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").references(() => tenants.id),\n  userId: varchar(\"user_id\").references(() => users.id).notNull(),\n  title: text(\"title\").notNull(),\n  content: text(\"content\").notNull(),\n  status: text(\"status\").default(\"pending\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\nexport const tutorials = pgTable(\"tutorials\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  title: text(\"title\").notNull(),\n  description: text(\"description\"),\n  type: tutorialTypeEnum(\"type\").notNull(),\n  contentUrl: text(\"content_url\"),\n  thumbnailUrl: text(\"thumbnail_url\"),\n  isPublished: boolean(\"is_published\").default(true),\n  order: integer(\"order\").default(0),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\nexport const systemConfig = pgTable(\"system_config\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  key: text(\"key\").notNull().unique(),\n  value: jsonb(\"value\"),\n  updatedAt: timestamp(\"updated_at\").defaultNow().notNull(),\n});\n\nexport const productConnectors = pgTable(\"product_connectors\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  name: text(\"name\").notNull(),\n  description: text(\"description\"),\n  isEnabled: boolean(\"is_enabled\").default(true),\n  requestMethod: text(\"request_method\").notNull().default(\"GET\"),\n  requestUrl: text(\"request_url\").notNull(),\n  requestHeaders: jsonb(\"request_headers\").default({}),\n  requestParams: jsonb(\"request_params\").default([]),\n  requestBody: text(\"request_body\"),\n  responseParser: text(\"response_parser\").notNull(),\n  fieldMappings: jsonb(\"field_mappings\").notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\").defaultNow().notNull(),\n});\n\nexport const tenantsRelations = relations(tenants, ({ many }) => ({\n  users: many(users),\n  subscriptions: many(subscriptions),\n  products: many(products),\n  templates: many(templates),\n  campaigns: many(campaigns),\n  joinRequests: many(joinRequests),\n}));\n\nexport const usersRelations = relations(users, ({ one, many }) => ({\n  tenant: one(tenants, { fields: [users.tenantId], references: [tenants.id] }),\n  campaigns: many(campaigns),\n  sentMessages: many(messages, { relationName: \"sender\" }),\n  receivedMessages: many(messages, { relationName: \"receiver\" }),\n  suggestions: many(suggestions),\n  joinRequests: many(joinRequests),\n}));\n\nexport const joinRequestsRelations = relations(joinRequests, ({ one }) => ({\n  user: one(users, { fields: [joinRequests.userId], references: [users.id] }),\n  tenant: one(tenants, { fields: [joinRequests.tenantId], references: [tenants.id] }),\n  reviewer: one(users, { fields: [joinRequests.reviewedBy], references: [users.id] }),\n}));\n\nexport const subscriptionsRelations = relations(subscriptions, ({ one }) => ({\n  tenant: one(tenants, { fields: [subscriptions.tenantId], references: [tenants.id] }),\n}));\n\nexport const productsRelations = relations(products, ({ one, many }) => ({\n  tenant: one(tenants, { fields: [products.tenantId], references: [tenants.id] }),\n  campaignProducts: many(campaignProducts),\n}));\n\nexport const templatesRelations = relations(templates, ({ one, many }) => ({\n  tenant: one(tenants, { fields: [templates.tenantId], references: [tenants.id] }),\n  campaigns: many(campaigns),\n}));\n\nexport const campaignsRelations = relations(campaigns, ({ one, many }) => ({\n  tenant: one(tenants, { fields: [campaigns.tenantId], references: [tenants.id] }),\n  creator: one(users, { fields: [campaigns.createdBy], references: [users.id] }),\n  template: one(templates, { fields: [campaigns.templateId], references: [templates.id] }),\n  campaignProducts: many(campaignProducts),\n}));\n\nexport const campaignProductsRelations = relations(campaignProducts, ({ one }) => ({\n  campaign: one(campaigns, { fields: [campaignProducts.campaignId], references: [campaigns.id] }),\n  product: one(products, { fields: [campaignProducts.productId], references: [products.id] }),\n}));\n\nexport const messagesRelations = relations(messages, ({ one }) => ({\n  tenant: one(tenants, { fields: [messages.tenantId], references: [tenants.id] }),\n  sender: one(users, { fields: [messages.senderId], references: [users.id], relationName: \"sender\" }),\n  receiver: one(users, { fields: [messages.receiverId], references: [users.id], relationName: \"receiver\" }),\n}));\n\nexport const suggestionsRelations = relations(suggestions, ({ one }) => ({\n  tenant: one(tenants, { fields: [suggestions.tenantId], references: [tenants.id] }),\n  user: one(users, { fields: [suggestions.userId], references: [users.id] }),\n}));\n\nexport const insertTenantSchema = createInsertSchema(tenants).omit({ id: true, createdAt: true });\nexport const insertUserSchema = createInsertSchema(users).omit({ id: true, createdAt: true });\nexport const insertJoinRequestSchema = createInsertSchema(joinRequests).omit({ id: true, createdAt: true, reviewedAt: true });\nexport const insertSubscriptionSchema = createInsertSchema(subscriptions).omit({ id: true, createdAt: true });\nexport const insertProductSchema = createInsertSchema(products).omit({ id: true, createdAt: true });\nexport const insertTemplateSchema = createInsertSchema(templates).omit({ id: true, createdAt: true });\nexport const insertCampaignSchema = createInsertSchema(campaigns).omit({ id: true, createdAt: true, updatedAt: true });\nexport const insertCampaignProductSchema = createInsertSchema(campaignProducts).omit({ id: true });\nexport const insertMessageSchema = createInsertSchema(messages).omit({ id: true, createdAt: true });\nexport const insertSuggestionSchema = createInsertSchema(suggestions).omit({ id: true, createdAt: true });\nexport const insertTutorialSchema = createInsertSchema(tutorials).omit({ id: true, createdAt: true });\nexport const insertSystemConfigSchema = createInsertSchema(systemConfig).omit({ id: true, updatedAt: true });\nexport const insertProductConnectorSchema = createInsertSchema(productConnectors).omit({ id: true, createdAt: true, updatedAt: true });\n\nexport type Tenant = typeof tenants.$inferSelect;\nexport type InsertTenant = z.infer<typeof insertTenantSchema>;\nexport type User = typeof users.$inferSelect;\nexport type InsertUser = z.infer<typeof insertUserSchema>;\nexport type JoinRequest = typeof joinRequests.$inferSelect;\nexport type InsertJoinRequest = z.infer<typeof insertJoinRequestSchema>;\nexport type Subscription = typeof subscriptions.$inferSelect;\nexport type InsertSubscription = z.infer<typeof insertSubscriptionSchema>;\nexport type Product = typeof products.$inferSelect;\nexport type InsertProduct = z.infer<typeof insertProductSchema>;\nexport type Template = typeof templates.$inferSelect;\nexport type InsertTemplate = z.infer<typeof insertTemplateSchema>;\nexport type Campaign = typeof campaigns.$inferSelect;\nexport type InsertCampaign = z.infer<typeof insertCampaignSchema>;\nexport type CampaignProduct = typeof campaignProducts.$inferSelect;\nexport type InsertCampaignProduct = z.infer<typeof insertCampaignProductSchema>;\nexport type Message = typeof messages.$inferSelect;\nexport type InsertMessage = z.infer<typeof insertMessageSchema>;\nexport type Suggestion = typeof suggestions.$inferSelect;\nexport type InsertSuggestion = z.infer<typeof insertSuggestionSchema>;\nexport type Tutorial = typeof tutorials.$inferSelect;\nexport type InsertTutorial = z.infer<typeof insertTutorialSchema>;\nexport type SystemConfig = typeof systemConfig.$inferSelect;\nexport type InsertSystemConfig = z.infer<typeof insertSystemConfigSchema>;\nexport type ProductConnector = typeof productConnectors.$inferSelect;\nexport type InsertProductConnector = z.infer<typeof insertProductConnectorSchema>;\n\nexport const loginSchema = z.object({\n  email: z.string().email(),\n  password: z.string().min(6),\n  captchaToken: z.string().optional(),\n});\n\nexport const registerSchema = z.object({\n  email: z.string().email(),\n  password: z.string().min(8),\n  firstName: z.string().min(1),\n  lastName: z.string().min(1),\n  mobilePhone: z.string().optional(),\n  captchaToken: z.string().optional(),\n  signupType: z.enum([\"create_tenant\", \"join_tenant\"]).optional(),\n  tenantCode: z.string().optional(),\n  joinMessage: z.string().optional(),\n});\n\nexport const resetPasswordSchema = z.object({\n  email: z.string().email(),\n  captchaToken: z.string().optional(),\n});\n\nexport const verifyTotpSchema = z.object({\n  token: z.string().length(6),\n});\n\nexport const tenantSetupSchema = z.object({\n  name: z.string().min(2, \"Organization name must be at least 2 characters\").max(100),\n  slug: z.string()\n    .min(3, \"Slug must be at least 3 characters\")\n    .max(50, \"Slug must be less than 50 characters\")\n    .regex(/^[a-z0-9-]+$/, \"Slug can only contain lowercase letters, numbers, and hyphens\")\n    .transform(val => val.toLowerCase().trim()),\n});\n\nexport type LoginInput = z.infer<typeof loginSchema>;\nexport type RegisterInput = z.infer<typeof registerSchema>;\nexport type ResetPasswordInput = z.infer<typeof resetPasswordSchema>;\nexport type VerifyTotpInput = z.infer<typeof verifyTotpSchema>;\n","path":null,"size_bytes":15510,"size_tokens":null},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":711,"size_tokens":null},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","path":null,"size_bytes":1584,"size_tokens":null},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n          await import(\"@replit/vite-plugin-dev-banner\").then((m) =>\n            m.devBanner(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","path":null,"size_bytes":1080,"size_tokens":null},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","path":null,"size_bytes":772,"size_tokens":null},"client/src/lib/auth-context.tsx":{"content":"import { createContext, useContext, useState, useEffect, useCallback } from \"react\";\nimport type { User } from \"@shared/schema\";\n\ninterface AuthContextType {\n  user: User | null;\n  isLoading: boolean;\n  isAuthenticated: boolean;\n  login: (user: User, token: string) => void;\n  logout: () => void;\n  updateUser: (user: User) => void;\n  token: string | null;\n  isImpersonating: boolean;\n  originalSuperAdmin: User | null;\n  startImpersonation: (tenantUser: User, tenantToken: string, originalUser: User, originalToken: string) => void;\n  stopImpersonation: () => void;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\nexport function AuthProvider({ children }: { children: React.ReactNode }) {\n  const [user, setUser] = useState<User | null>(null);\n  const [token, setToken] = useState<string | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [originalSuperAdmin, setOriginalSuperAdmin] = useState<User | null>(null);\n  const [originalToken, setOriginalToken] = useState<string | null>(null);\n\n  useEffect(() => {\n    const storedToken = localStorage.getItem(\"authToken\");\n    const storedUser = localStorage.getItem(\"authUser\");\n    const storedOriginalSuperAdmin = localStorage.getItem(\"originalSuperAdmin\");\n    const storedOriginalToken = localStorage.getItem(\"originalSuperAdminToken\");\n    \n    if (storedToken && storedUser) {\n      try {\n        setToken(storedToken);\n        setUser(JSON.parse(storedUser));\n        if (storedOriginalSuperAdmin && storedOriginalToken) {\n          setOriginalSuperAdmin(JSON.parse(storedOriginalSuperAdmin));\n          setOriginalToken(storedOriginalToken);\n        }\n      } catch {\n        localStorage.removeItem(\"authToken\");\n        localStorage.removeItem(\"authUser\");\n        localStorage.removeItem(\"originalSuperAdmin\");\n        localStorage.removeItem(\"originalSuperAdminToken\");\n      }\n    }\n    setIsLoading(false);\n  }, []);\n\n  const login = useCallback((user: User, authToken: string) => {\n    setUser(user);\n    setToken(authToken);\n    localStorage.setItem(\"authToken\", authToken);\n    localStorage.setItem(\"authUser\", JSON.stringify(user));\n  }, []);\n\n  const logout = useCallback(() => {\n    setUser(null);\n    setToken(null);\n    setOriginalSuperAdmin(null);\n    setOriginalToken(null);\n    localStorage.removeItem(\"authToken\");\n    localStorage.removeItem(\"authUser\");\n    localStorage.removeItem(\"originalSuperAdmin\");\n    localStorage.removeItem(\"originalSuperAdminToken\");\n  }, []);\n\n  const updateUser = useCallback((updatedUser: User) => {\n    setUser(updatedUser);\n    localStorage.setItem(\"authUser\", JSON.stringify(updatedUser));\n  }, []);\n\n  const startImpersonation = useCallback((tenantUser: User, tenantToken: string, origUser: User, origToken: string) => {\n    setOriginalSuperAdmin(origUser);\n    setOriginalToken(origToken);\n    setUser(tenantUser);\n    setToken(tenantToken);\n    localStorage.setItem(\"authToken\", tenantToken);\n    localStorage.setItem(\"authUser\", JSON.stringify(tenantUser));\n    localStorage.setItem(\"originalSuperAdmin\", JSON.stringify(origUser));\n    localStorage.setItem(\"originalSuperAdminToken\", origToken);\n  }, []);\n\n  const stopImpersonation = useCallback(() => {\n    if (originalSuperAdmin && originalToken) {\n      setUser(originalSuperAdmin);\n      setToken(originalToken);\n      localStorage.setItem(\"authToken\", originalToken);\n      localStorage.setItem(\"authUser\", JSON.stringify(originalSuperAdmin));\n    }\n    setOriginalSuperAdmin(null);\n    setOriginalToken(null);\n    localStorage.removeItem(\"originalSuperAdmin\");\n    localStorage.removeItem(\"originalSuperAdminToken\");\n  }, [originalSuperAdmin, originalToken]);\n\n  return (\n    <AuthContext.Provider\n      value={{\n        user,\n        isLoading,\n        isAuthenticated: !!user && !!token,\n        login,\n        logout,\n        updateUser,\n        token,\n        isImpersonating: !!originalSuperAdmin,\n        originalSuperAdmin,\n        startImpersonation,\n        stopImpersonation,\n      }}\n    >\n      {children}\n    </AuthContext.Provider>\n  );\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error(\"useAuth must be used within an AuthProvider\");\n  }\n  return context;\n}\n","path":null,"size_bytes":4261,"size_tokens":null},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","path":null,"size_bytes":3021,"size_tokens":null},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","path":null,"size_bytes":565,"size_tokens":null},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","path":null,"size_bytes":1642,"size_tokens":null},"client/src/pages/register.tsx":{"content":"import { useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { Link, useLocation } from \"wouter\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Eye, EyeOff, Mail, Lock, User, Phone, Loader2, CheckCircle } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { ThemeToggle } from \"@/components/theme-toggle\";\nimport { LanguageSelector } from \"@/components/language-selector\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\n\nconst registerSchema = z.object({\n  email: z.string().email(),\n  password: z.string().min(8, \"Password must be at least 8 characters\"),\n  confirmPassword: z.string(),\n  firstName: z.string().min(1, \"First name is required\"),\n  lastName: z.string().min(1, \"Last name is required\"),\n  mobilePhone: z.string().optional(),\n}).refine((data) => data.password === data.confirmPassword, {\n  message: \"Passwords don't match\",\n  path: [\"confirmPassword\"],\n});\n\ntype RegisterFormValues = z.infer<typeof registerSchema>;\n\nexport default function RegisterPage() {\n  const { t } = useTranslation();\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const [showPassword, setShowPassword] = useState(false);\n  const [showConfirmPassword, setShowConfirmPassword] = useState(false);\n  const [registrationSuccess, setRegistrationSuccess] = useState(false);\n\n  const form = useForm<RegisterFormValues>({\n    resolver: zodResolver(registerSchema),\n    defaultValues: {\n      email: \"\",\n      password: \"\",\n      confirmPassword: \"\",\n      firstName: \"\",\n      lastName: \"\",\n      mobilePhone: \"\",\n    },\n  });\n\n  const registerMutation = useMutation({\n    mutationFn: async (data: Omit<RegisterFormValues, \"confirmPassword\">) => {\n      const response = await apiRequest(\"POST\", \"/api/auth/register\", data);\n      return response;\n    },\n    onSuccess: () => {\n      setRegistrationSuccess(true);\n    },\n    onError: (error: any) => {\n      toast({\n        variant: \"destructive\",\n        title: t(\"common.error\"),\n        description: error.message || t(\"errors.somethingWentWrong\"),\n      });\n    },\n  });\n\n  const onSubmit = (data: RegisterFormValues) => {\n    const { confirmPassword, ...registerData } = data;\n    registerMutation.mutate(registerData);\n  };\n\n  if (registrationSuccess) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center p-4 bg-background\">\n        <Card className=\"w-full max-w-md\">\n          <CardHeader className=\"text-center\">\n            <div className=\"mx-auto mb-4 flex h-14 w-14 items-center justify-center rounded-full bg-green-100 dark:bg-green-900/30\">\n              <CheckCircle className=\"h-7 w-7 text-green-600 dark:text-green-400\" />\n            </div>\n            <CardTitle className=\"text-2xl\">{t(\"common.success\")}</CardTitle>\n            <CardDescription className=\"text-base\">\n              {t(\"auth.activationRequired\")}\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            <Button\n              className=\"w-full\"\n              onClick={() => setLocation(\"/login\")}\n              data-testid=\"button-go-to-login\"\n            >\n              {t(\"auth.signIn\")}\n            </Button>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen flex\">\n      <div className=\"hidden lg:flex lg:w-2/5 bg-gradient-to-br from-primary/90 to-primary/70 p-12 flex-col justify-between relative overflow-hidden\">\n        <div className=\"absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA2MCA2MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxnIGZpbGw9IiNmZmZmZmYiIGZpbGwtb3BhY2l0eT0iMC4wNSI+PHBhdGggZD0iTTM2IDM0djZoLTZ2LTZoNnptLTYtNnY2aC02di02aDZ6bTEyLTZ2Nmg2di02aC02em0tNiAwdi02aDZ2Nmg2djZoLTZ2NmgtNnYtNmgtNnYtNmg2em0tMTIgMHY2aC02di02aDZ6bTAgMTJ2LTZoNnY2aC02em0xMiAxMnYtNmg2djZoLTZ6Ii8+PC9nPjwvZz48L3N2Zz4=')] opacity-50\" />\n        <div className=\"relative z-10\">\n          <div className=\"flex items-center gap-3 mb-8\">\n            <div className=\"flex h-12 w-12 items-center justify-center rounded-lg bg-white/20 text-white font-bold text-xl backdrop-blur-sm\">\n              eB\n            </div>\n            <span className=\"text-white font-bold text-2xl\">{t(\"app.name\")}</span>\n          </div>\n          <h1 className=\"text-4xl font-bold text-white mb-4\">\n            Join thousands of creators\n          </h1>\n          <p className=\"text-white/80 text-lg\">\n            Start creating professional brochures and promotional materials in minutes.\n          </p>\n        </div>\n        <div className=\"relative z-10 space-y-4\">\n          <div className=\"flex items-center gap-3 text-white/90\">\n            <CheckCircle className=\"h-5 w-5\" />\n            <span>Unlimited brochure templates</span>\n          </div>\n          <div className=\"flex items-center gap-3 text-white/90\">\n            <CheckCircle className=\"h-5 w-5\" />\n            <span>Dynamic product placement</span>\n          </div>\n          <div className=\"flex items-center gap-3 text-white/90\">\n            <CheckCircle className=\"h-5 w-5\" />\n            <span>Social media integration</span>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"flex-1 flex flex-col\">\n        <div className=\"flex justify-end items-center gap-2 p-4\">\n          <LanguageSelector />\n          <ThemeToggle />\n        </div>\n        \n        <div className=\"flex-1 flex items-center justify-center p-8\">\n          <Card className=\"w-full max-w-md\">\n            <CardHeader className=\"space-y-1 text-center\">\n              <div className=\"flex justify-center lg:hidden mb-4\">\n                <div className=\"flex h-12 w-12 items-center justify-center rounded-lg bg-primary text-primary-foreground font-bold text-xl\">\n                  eB\n                </div>\n              </div>\n              <CardTitle className=\"text-2xl font-semibold\">{t(\"auth.register\")}</CardTitle>\n              <CardDescription>\n                {t(\"auth.hasAccount\")}{\" \"}\n                <Link href=\"/login\" className=\"text-primary hover:underline\" data-testid=\"link-login\">\n                  {t(\"auth.signIn\")}\n                </Link>\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <Form {...form}>\n                <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n                  <div className=\"grid grid-cols-2 gap-4\">\n                    <FormField\n                      control={form.control}\n                      name=\"firstName\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>{t(\"auth.firstName\")}</FormLabel>\n                          <FormControl>\n                            <div className=\"relative\">\n                              <User className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n                              <Input\n                                {...field}\n                                placeholder=\"John\"\n                                className=\"pl-10\"\n                                data-testid=\"input-first-name\"\n                              />\n                            </div>\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                    <FormField\n                      control={form.control}\n                      name=\"lastName\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>{t(\"auth.lastName\")}</FormLabel>\n                          <FormControl>\n                            <Input\n                              {...field}\n                              placeholder=\"Doe\"\n                              data-testid=\"input-last-name\"\n                            />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                  </div>\n\n                  <FormField\n                    control={form.control}\n                    name=\"email\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>{t(\"auth.email\")}</FormLabel>\n                        <FormControl>\n                          <div className=\"relative\">\n                            <Mail className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n                            <Input\n                              {...field}\n                              type=\"email\"\n                              placeholder=\"name@example.com\"\n                              className=\"pl-10\"\n                              data-testid=\"input-email\"\n                            />\n                          </div>\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"mobilePhone\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>{t(\"auth.mobilePhone\")} ({t(\"common.optional\")})</FormLabel>\n                        <FormControl>\n                          <div className=\"relative\">\n                            <Phone className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n                            <Input\n                              {...field}\n                              type=\"tel\"\n                              placeholder=\"+1 234 567 8900\"\n                              className=\"pl-10\"\n                              data-testid=\"input-phone\"\n                            />\n                          </div>\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"password\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>{t(\"auth.password\")}</FormLabel>\n                        <FormControl>\n                          <div className=\"relative\">\n                            <Lock className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n                            <Input\n                              {...field}\n                              type={showPassword ? \"text\" : \"password\"}\n                              placeholder=\"Min. 8 characters\"\n                              className=\"pl-10 pr-10\"\n                              data-testid=\"input-password\"\n                            />\n                            <button\n                              type=\"button\"\n                              className=\"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors\"\n                              onClick={() => setShowPassword(!showPassword)}\n                            >\n                              {showPassword ? (\n                                <EyeOff className=\"h-4 w-4\" />\n                              ) : (\n                                <Eye className=\"h-4 w-4\" />\n                              )}\n                            </button>\n                          </div>\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"confirmPassword\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>{t(\"auth.confirmPassword\")}</FormLabel>\n                        <FormControl>\n                          <div className=\"relative\">\n                            <Lock className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n                            <Input\n                              {...field}\n                              type={showConfirmPassword ? \"text\" : \"password\"}\n                              placeholder=\"Confirm your password\"\n                              className=\"pl-10 pr-10\"\n                              data-testid=\"input-confirm-password\"\n                            />\n                            <button\n                              type=\"button\"\n                              className=\"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors\"\n                              onClick={() => setShowConfirmPassword(!showConfirmPassword)}\n                            >\n                              {showConfirmPassword ? (\n                                <EyeOff className=\"h-4 w-4\" />\n                              ) : (\n                                <Eye className=\"h-4 w-4\" />\n                              )}\n                            </button>\n                          </div>\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <Button\n                    type=\"submit\"\n                    className=\"w-full min-w-[120px]\"\n                    disabled={registerMutation.isPending}\n                    data-testid=\"button-register\"\n                  >\n                    {registerMutation.isPending ? (\n                      <Loader2 className=\"h-4 w-4 animate-spin\" />\n                    ) : (\n                      t(\"auth.signUp\")\n                    )}\n                  </Button>\n                </form>\n              </Form>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":14464,"size_tokens":null},"client/src/pages/login.tsx":{"content":"import { useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { Link, useLocation } from \"wouter\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Eye, EyeOff, Mail, Lock, Loader2, AlertCircle } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { ThemeToggle } from \"@/components/theme-toggle\";\nimport { LanguageSelector } from \"@/components/language-selector\";\nimport { useAuth } from \"@/lib/auth-context\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\n\nconst loginSchema = z.object({\n  email: z.string().email(),\n  password: z.string().min(6),\n  rememberMe: z.boolean().optional(),\n});\n\ntype LoginFormValues = z.infer<typeof loginSchema>;\n\nexport default function LoginPage() {\n  const { t } = useTranslation();\n  const [, setLocation] = useLocation();\n  const { login } = useAuth();\n  const { toast } = useToast();\n  const [showPassword, setShowPassword] = useState(false);\n  const [requires2FA, setRequires2FA] = useState(false);\n  const [pendingLoginData, setPendingLoginData] = useState<{ userId: string; totpRequired: boolean } | null>(null);\n  const [requiresVerification, setRequiresVerification] = useState(false);\n  const [unverifiedEmail, setUnverifiedEmail] = useState(\"\");\n  const [resendLoading, setResendLoading] = useState(false);\n  const [resendSuccess, setResendSuccess] = useState(false);\n\n  const form = useForm<LoginFormValues>({\n    resolver: zodResolver(loginSchema),\n    defaultValues: {\n      email: \"\",\n      password: \"\",\n      rememberMe: false,\n    },\n  });\n\n  const loginMutation = useMutation({\n    mutationFn: async (data: LoginFormValues) => {\n      const response = await apiRequest(\"POST\", \"/api/auth/login\", data);\n      return response;\n    },\n    onSuccess: (data: any) => {\n      if (data.requiresTotp) {\n        setRequires2FA(true);\n        setPendingLoginData({ userId: data.userId, totpRequired: true });\n      } else {\n        login(data.user, data.token);\n        toast({\n          title: t(\"common.success\"),\n          description: t(\"auth.login\") + \" \" + t(\"common.success\").toLowerCase(),\n        });\n        setLocation(\"/dashboard\");\n      }\n    },\n    onError: (error: any) => {\n      if (error?.requiresVerification) {\n        setRequiresVerification(true);\n        setUnverifiedEmail(error.email || form.getValues(\"email\"));\n        setResendSuccess(false);\n      } else {\n        toast({\n          variant: \"destructive\",\n          title: t(\"common.error\"),\n          description: t(\"auth.invalidCredentials\"),\n        });\n      }\n    },\n  });\n\n  const handleResendVerification = async () => {\n    setResendLoading(true);\n    try {\n      const response = await apiRequest(\"POST\", \"/api/auth/resend-verification\", { email: unverifiedEmail });\n      setResendSuccess(true);\n      toast({\n        title: t(\"common.success\"),\n        description: \"Verification email sent. Please check your inbox.\",\n      });\n    } catch (error) {\n      toast({\n        variant: \"destructive\",\n        title: t(\"common.error\"),\n        description: \"Failed to resend verification email.\",\n      });\n    } finally {\n      setResendLoading(false);\n    }\n  };\n\n  const onSubmit = (data: LoginFormValues) => {\n    loginMutation.mutate(data);\n  };\n\n  if (requires2FA && pendingLoginData) {\n    return (\n      <TwoFactorVerification\n        userId={pendingLoginData.userId}\n        onSuccess={(user, token) => {\n          login(user, token);\n          setLocation(\"/dashboard\");\n        }}\n        onCancel={() => {\n          setRequires2FA(false);\n          setPendingLoginData(null);\n        }}\n      />\n    );\n  }\n\n  if (requiresVerification) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center p-4 bg-background\">\n        <Card className=\"w-full max-w-md\">\n          <CardHeader className=\"text-center\">\n            <div className=\"mx-auto mb-4 flex h-14 w-14 items-center justify-center rounded-full bg-yellow-100 dark:bg-yellow-900/30\">\n              <AlertCircle className=\"h-7 w-7 text-yellow-600 dark:text-yellow-400\" />\n            </div>\n            <CardTitle className=\"text-2xl\">Email Verification Required</CardTitle>\n            <CardDescription>\n              Please verify your email address to continue. Check your inbox for a verification link.\n            </CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"text-center text-sm text-muted-foreground\">\n              {unverifiedEmail && <p>Verification email sent to: <strong>{unverifiedEmail}</strong></p>}\n            </div>\n            {resendSuccess ? (\n              <div className=\"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-300 p-3 rounded-md text-sm text-center\">\n                Verification email sent! Please check your inbox.\n              </div>\n            ) : (\n              <Button\n                onClick={handleResendVerification}\n                variant=\"outline\"\n                className=\"w-full\"\n                disabled={resendLoading}\n                data-testid=\"button-resend-verification\"\n              >\n                {resendLoading ? (\n                  <Loader2 className=\"h-4 w-4 animate-spin mr-2\" />\n                ) : (\n                  <Mail className=\"h-4 w-4 mr-2\" />\n                )}\n                Resend Verification Email\n              </Button>\n            )}\n            <Button\n              variant=\"ghost\"\n              className=\"w-full\"\n              onClick={() => {\n                setRequiresVerification(false);\n                setUnverifiedEmail(\"\");\n              }}\n              data-testid=\"button-back-to-login\"\n            >\n              Back to Login\n            </Button>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen flex\">\n      <div className=\"hidden lg:flex lg:w-2/5 bg-gradient-to-br from-primary/90 to-primary/70 p-12 flex-col justify-between relative overflow-hidden\">\n        <div className=\"absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA2MCA2MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxnIGZpbGw9IiNmZmZmZmYiIGZpbGwtb3BhY2l0eT0iMC4wNSI+PHBhdGggZD0iTTM2IDM0djZoLTZ2LTZoNnptLTYtNnY2aC02di02aDZ6bTEyLTZ2Nmg2di02aC02em0tNiAwdi02aDZ2Nmg2djZoLTZ2NmgtNnYtNmgtNnYtNmg2em0tMTIgMHY2aC02di02aDZ6bTAgMTJ2LTZoNnY2aC02em0xMiAxMnYtNmg2djZoLTZ6Ii8+PC9nPjwvZz48L3N2Zz4=')] opacity-50\" />\n        <div className=\"relative z-10\">\n          <div className=\"flex items-center gap-3 mb-8\">\n            <div className=\"flex h-12 w-12 items-center justify-center rounded-lg bg-white/20 text-white font-bold text-xl backdrop-blur-sm\">\n              eB\n            </div>\n            <span className=\"text-white font-bold text-2xl\">{t(\"app.name\")}</span>\n          </div>\n          <h1 className=\"text-4xl font-bold text-white mb-4\">\n            {t(\"app.tagline\")}\n          </h1>\n          <p className=\"text-white/80 text-lg\">\n            Create professional digital brochures and promotional posters with our intuitive canvas editor.\n          </p>\n        </div>\n        <div className=\"relative z-10\">\n          <div className=\"flex gap-4\">\n            <div className=\"bg-white/10 backdrop-blur-sm rounded-lg p-4 flex-1\">\n              <div className=\"text-3xl font-bold text-white\">1000+</div>\n              <div className=\"text-white/70 text-sm\">Templates</div>\n            </div>\n            <div className=\"bg-white/10 backdrop-blur-sm rounded-lg p-4 flex-1\">\n              <div className=\"text-3xl font-bold text-white\">50K+</div>\n              <div className=\"text-white/70 text-sm\">Users</div>\n            </div>\n            <div className=\"bg-white/10 backdrop-blur-sm rounded-lg p-4 flex-1\">\n              <div className=\"text-3xl font-bold text-white\">99.9%</div>\n              <div className=\"text-white/70 text-sm\">Uptime</div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"flex-1 flex flex-col\">\n        <div className=\"flex justify-end items-center gap-2 p-4\">\n          <LanguageSelector />\n          <ThemeToggle />\n        </div>\n        \n        <div className=\"flex-1 flex items-center justify-center p-8\">\n          <Card className=\"w-full max-w-md\">\n            <CardHeader className=\"space-y-1 text-center\">\n              <div className=\"flex justify-center lg:hidden mb-4\">\n                <div className=\"flex h-12 w-12 items-center justify-center rounded-lg bg-primary text-primary-foreground font-bold text-xl\">\n                  eB\n                </div>\n              </div>\n              <CardTitle className=\"text-2xl font-semibold\">{t(\"auth.login\")}</CardTitle>\n              <CardDescription>\n                {t(\"auth.noAccount\")}{\" \"}\n                <Link href=\"/register\" className=\"text-primary hover:underline\" data-testid=\"link-register\">\n                  {t(\"auth.signUp\")}\n                </Link>\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <Form {...form}>\n                <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n                  <FormField\n                    control={form.control}\n                    name=\"email\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>{t(\"auth.email\")}</FormLabel>\n                        <FormControl>\n                          <div className=\"relative\">\n                            <Mail className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n                            <Input\n                              {...field}\n                              type=\"email\"\n                              placeholder=\"name@example.com\"\n                              className=\"pl-10\"\n                              data-testid=\"input-email\"\n                            />\n                          </div>\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"password\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>{t(\"auth.password\")}</FormLabel>\n                        <FormControl>\n                          <div className=\"relative\">\n                            <Lock className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n                            <Input\n                              {...field}\n                              type={showPassword ? \"text\" : \"password\"}\n                              placeholder=\"Enter your password\"\n                              className=\"pl-10 pr-10\"\n                              data-testid=\"input-password\"\n                            />\n                            <button\n                              type=\"button\"\n                              className=\"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors\"\n                              onClick={() => setShowPassword(!showPassword)}\n                              data-testid=\"button-toggle-password\"\n                            >\n                              {showPassword ? (\n                                <EyeOff className=\"h-4 w-4\" />\n                              ) : (\n                                <Eye className=\"h-4 w-4\" />\n                              )}\n                            </button>\n                          </div>\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <div className=\"flex items-center justify-between\">\n                    <FormField\n                      control={form.control}\n                      name=\"rememberMe\"\n                      render={({ field }) => (\n                        <FormItem className=\"flex items-center space-x-2 space-y-0\">\n                          <FormControl>\n                            <Checkbox\n                              checked={field.value}\n                              onCheckedChange={field.onChange}\n                              data-testid=\"checkbox-remember\"\n                            />\n                          </FormControl>\n                          <FormLabel className=\"text-sm font-normal cursor-pointer\">\n                            {t(\"auth.rememberMe\")}\n                          </FormLabel>\n                        </FormItem>\n                      )}\n                    />\n                    <Link\n                      href=\"/reset-password\"\n                      className=\"text-sm text-primary hover:underline\"\n                      data-testid=\"link-forgot-password\"\n                    >\n                      {t(\"auth.forgotPassword\")}\n                    </Link>\n                  </div>\n\n                  <Button\n                    type=\"submit\"\n                    className=\"w-full min-w-[120px]\"\n                    disabled={loginMutation.isPending}\n                    data-testid=\"button-login\"\n                  >\n                    {loginMutation.isPending ? (\n                      <Loader2 className=\"h-4 w-4 animate-spin\" />\n                    ) : (\n                      t(\"auth.signIn\")\n                    )}\n                  </Button>\n                </form>\n              </Form>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction TwoFactorVerification({ \n  userId, \n  onSuccess, \n  onCancel \n}: { \n  userId: string; \n  onSuccess: (user: any, token: string) => void;\n  onCancel: () => void;\n}) {\n  const { t } = useTranslation();\n  const { toast } = useToast();\n  const [code, setCode] = useState(\"\");\n\n  const verifyMutation = useMutation({\n    mutationFn: async (data: { userId: string; token: string }) => {\n      const response = await apiRequest(\"POST\", \"/api/auth/verify-2fa\", data);\n      return response;\n    },\n    onSuccess: (data: any) => {\n      onSuccess(data.user, data.token);\n      toast({\n        title: t(\"common.success\"),\n        description: t(\"auth.login\") + \" \" + t(\"common.success\").toLowerCase(),\n      });\n    },\n    onError: () => {\n      toast({\n        variant: \"destructive\",\n        title: t(\"common.error\"),\n        description: \"Invalid verification code\",\n      });\n    },\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (code.length === 6) {\n      verifyMutation.mutate({ userId, token: code });\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center p-4 bg-background\">\n      <Card className=\"w-full max-w-md\">\n        <CardHeader className=\"text-center\">\n          <div className=\"mx-auto mb-4 flex h-14 w-14 items-center justify-center rounded-full bg-primary/10\">\n            <Lock className=\"h-7 w-7 text-primary\" />\n          </div>\n          <CardTitle className=\"text-2xl\">{t(\"auth.twoFactor\")}</CardTitle>\n          <CardDescription>{t(\"auth.enterCode\")}</CardDescription>\n        </CardHeader>\n        <CardContent>\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div className=\"flex justify-center\">\n              <Input\n                value={code}\n                onChange={(e) => setCode(e.target.value.replace(/\\D/g, \"\").slice(0, 6))}\n                placeholder=\"000000\"\n                className=\"text-center text-2xl tracking-[0.5em] font-mono w-48\"\n                maxLength={6}\n                data-testid=\"input-2fa-code\"\n              />\n            </div>\n            <div className=\"flex gap-3\">\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                className=\"flex-1\"\n                onClick={onCancel}\n                data-testid=\"button-cancel-2fa\"\n              >\n                {t(\"common.cancel\")}\n              </Button>\n              <Button\n                type=\"submit\"\n                className=\"flex-1 min-w-[100px]\"\n                disabled={code.length !== 6 || verifyMutation.isPending}\n                data-testid=\"button-verify-2fa\"\n              >\n                {verifyMutation.isPending ? (\n                  <Loader2 className=\"h-4 w-4 animate-spin\" />\n                ) : (\n                  t(\"auth.verifyCode\")\n                )}\n              </Button>\n            </div>\n          </form>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":17118,"size_tokens":null},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","path":null,"size_bytes":5128,"size_tokens":null},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","path":null,"size_bytes":710,"size_tokens":null},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","path":null,"size_bytes":7609,"size_tokens":null},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","path":null,"size_bytes":6210,"size_tokens":null},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","path":null,"size_bytes":329,"size_tokens":null},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","path":null,"size_bytes":1139,"size_tokens":null},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","path":null,"size_bytes":1209,"size_tokens":null},"script/build.ts":{"content":"import { build as esbuild } from \"esbuild\";\nimport { build as viteBuild } from \"vite\";\nimport { rm, readFile } from \"fs/promises\";\n\n// server deps to bundle to reduce openat(2) syscalls\n// which helps cold start times\nconst allowlist = [\n  \"@google/generative-ai\",\n  \"axios\",\n  \"connect-pg-simple\",\n  \"cors\",\n  \"date-fns\",\n  \"drizzle-orm\",\n  \"drizzle-zod\",\n  \"express\",\n  \"express-rate-limit\",\n  \"express-session\",\n  \"jsonwebtoken\",\n  \"memorystore\",\n  \"multer\",\n  \"nanoid\",\n  \"nodemailer\",\n  \"openai\",\n  \"passport\",\n  \"passport-local\",\n  \"pg\",\n  \"stripe\",\n  \"uuid\",\n  \"ws\",\n  \"xlsx\",\n  \"zod\",\n  \"zod-validation-error\",\n];\n\nasync function buildAll() {\n  await rm(\"dist\", { recursive: true, force: true });\n\n  console.log(\"building client...\");\n  await viteBuild();\n\n  console.log(\"building server...\");\n  const pkg = JSON.parse(await readFile(\"package.json\", \"utf-8\"));\n  const allDeps = [\n    ...Object.keys(pkg.dependencies || {}),\n    ...Object.keys(pkg.devDependencies || {}),\n  ];\n  const externals = allDeps.filter((dep) => !allowlist.includes(dep));\n\n  await esbuild({\n    entryPoints: [\"server/index.ts\"],\n    platform: \"node\",\n    bundle: true,\n    format: \"cjs\",\n    outfile: \"dist/index.cjs\",\n    define: {\n      \"process.env.NODE_ENV\": '\"production\"',\n    },\n    minify: true,\n    external: externals,\n    logLevel: \"info\",\n  });\n}\n\nbuildAll().catch((err) => {\n  console.error(err);\n  process.exit(1);\n});\n","path":null,"size_bytes":1417,"size_tokens":null},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","path":null,"size_bytes":689,"size_tokens":null},"client/src/pages/reset-password.tsx":{"content":"import { useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { Link, useLocation } from \"wouter\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Mail, Loader2, CheckCircle, ArrowLeft } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { ThemeToggle } from \"@/components/theme-toggle\";\nimport { LanguageSelector } from \"@/components/language-selector\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\n\nconst resetSchema = z.object({\n  email: z.string().email(),\n});\n\ntype ResetFormValues = z.infer<typeof resetSchema>;\n\nexport default function ResetPasswordPage() {\n  const { t } = useTranslation();\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const [emailSent, setEmailSent] = useState(false);\n\n  const form = useForm<ResetFormValues>({\n    resolver: zodResolver(resetSchema),\n    defaultValues: {\n      email: \"\",\n    },\n  });\n\n  const resetMutation = useMutation({\n    mutationFn: async (data: ResetFormValues) => {\n      const response = await apiRequest(\"POST\", \"/api/auth/reset-password\", data);\n      return response;\n    },\n    onSuccess: () => {\n      setEmailSent(true);\n    },\n    onError: () => {\n      setEmailSent(true);\n    },\n  });\n\n  const onSubmit = (data: ResetFormValues) => {\n    resetMutation.mutate(data);\n  };\n\n  if (emailSent) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center p-4 bg-background\">\n        <div className=\"absolute top-4 right-4 flex gap-2\">\n          <LanguageSelector />\n          <ThemeToggle />\n        </div>\n        <Card className=\"w-full max-w-md\">\n          <CardHeader className=\"text-center\">\n            <div className=\"mx-auto mb-4 flex h-14 w-14 items-center justify-center rounded-full bg-green-100 dark:bg-green-900/30\">\n              <CheckCircle className=\"h-7 w-7 text-green-600 dark:text-green-400\" />\n            </div>\n            <CardTitle className=\"text-2xl\">Check Your Email</CardTitle>\n            <CardDescription className=\"text-base\">\n              {t(\"auth.resetEmailSent\")}\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            <Button\n              className=\"w-full\"\n              onClick={() => setLocation(\"/login\")}\n              data-testid=\"button-back-to-login\"\n            >\n              <ArrowLeft className=\"mr-2 h-4 w-4\" />\n              {t(\"auth.signIn\")}\n            </Button>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center p-4 bg-background\">\n      <div className=\"absolute top-4 right-4 flex gap-2\">\n        <LanguageSelector />\n        <ThemeToggle />\n      </div>\n      <Card className=\"w-full max-w-md\">\n        <CardHeader className=\"space-y-1 text-center\">\n          <div className=\"flex justify-center mb-4\">\n            <div className=\"flex h-12 w-12 items-center justify-center rounded-lg bg-primary text-primary-foreground font-bold text-xl\">\n              eB\n            </div>\n          </div>\n          <CardTitle className=\"text-2xl font-semibold\">{t(\"auth.resetPassword\")}</CardTitle>\n          <CardDescription>\n            Enter your email address and we'll send you a link to reset your password.\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n              <FormField\n                control={form.control}\n                name=\"email\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>{t(\"auth.email\")}</FormLabel>\n                    <FormControl>\n                      <div className=\"relative\">\n                        <Mail className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n                        <Input\n                          {...field}\n                          type=\"email\"\n                          placeholder=\"name@example.com\"\n                          className=\"pl-10\"\n                          data-testid=\"input-email\"\n                        />\n                      </div>\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <Button\n                type=\"submit\"\n                className=\"w-full min-w-[120px]\"\n                disabled={resetMutation.isPending}\n                data-testid=\"button-reset\"\n              >\n                {resetMutation.isPending ? (\n                  <Loader2 className=\"h-4 w-4 animate-spin\" />\n                ) : (\n                  t(\"auth.resetPassword\")\n                )}\n              </Button>\n\n              <div className=\"text-center\">\n                <Link\n                  href=\"/login\"\n                  className=\"text-sm text-muted-foreground hover:text-primary\"\n                  data-testid=\"link-back-to-login\"\n                >\n                  <ArrowLeft className=\"inline mr-1 h-3 w-3\" />\n                  Back to {t(\"auth.signIn\")}\n                </Link>\n              </div>\n            </form>\n          </Form>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":5664,"size_tokens":null},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","path":null,"size_bytes":157,"size_tokens":null},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","path":null,"size_bytes":1753,"size_tokens":null},"client/src/pages/setup-2fa.tsx":{"content":"import { useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { useLocation, useSearch } from \"wouter\";\nimport { Shield, Loader2, CheckCircle } from \"lucide-react\";\nimport { QRCodeSVG } from \"qrcode.react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { ThemeToggle } from \"@/components/theme-toggle\";\nimport { LanguageSelector } from \"@/components/language-selector\";\nimport { useAuth } from \"@/lib/auth-context\";\nimport { useMutation, useQuery } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\n\nexport default function Setup2FAPage() {\n  const { t } = useTranslation();\n  const [, setLocation] = useLocation();\n  const searchString = useSearch();\n  const { login } = useAuth();\n  const { toast } = useToast();\n  const [code, setCode] = useState(\"\");\n  const [setupComplete, setSetupComplete] = useState(false);\n\n  const params = new URLSearchParams(searchString);\n  const userId = params.get(\"userId\");\n\n  const { data: totpData, isLoading: isLoadingTotp } = useQuery({\n    queryKey: [`/api/auth/setup-2fa?userId=${userId}`],\n    enabled: !!userId,\n  });\n\n  const verifyMutation = useMutation({\n    mutationFn: async (data: { userId: string; token: string }) => {\n      const response = await apiRequest(\"POST\", \"/api/auth/verify-2fa-setup\", data);\n      return response;\n    },\n    onSuccess: (data: any) => {\n      setSetupComplete(true);\n      setTimeout(() => {\n        login(data.user, data.token);\n        setLocation(\"/subscription\");\n      }, 2000);\n    },\n    onError: () => {\n      toast({\n        variant: \"destructive\",\n        title: t(\"common.error\"),\n        description: \"Invalid verification code. Please try again.\",\n      });\n    },\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (code.length === 6 && userId) {\n      verifyMutation.mutate({ userId, token: code });\n    }\n  };\n\n  if (!userId) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center p-4\">\n        <Card className=\"w-full max-w-md\">\n          <CardHeader className=\"text-center\">\n            <CardTitle>Invalid Request</CardTitle>\n            <CardDescription>\n              This page requires a valid user ID. Please try logging in again.\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            <Button\n              className=\"w-full\"\n              onClick={() => setLocation(\"/login\")}\n              data-testid=\"button-back-to-login\"\n            >\n              Go to Login\n            </Button>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  if (setupComplete) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center p-4 bg-background\">\n        <Card className=\"w-full max-w-md\">\n          <CardHeader className=\"text-center\">\n            <div className=\"mx-auto mb-4 flex h-14 w-14 items-center justify-center rounded-full bg-green-100 dark:bg-green-900/30\">\n              <CheckCircle className=\"h-7 w-7 text-green-600 dark:text-green-400\" />\n            </div>\n            <CardTitle className=\"text-2xl\">2FA Setup Complete</CardTitle>\n            <CardDescription>\n              Your account is now protected with two-factor authentication.\n              Redirecting to subscription selection...\n            </CardDescription>\n          </CardHeader>\n          <CardContent className=\"flex justify-center\">\n            <Loader2 className=\"h-6 w-6 animate-spin text-primary\" />\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center p-4 bg-background\">\n      <div className=\"absolute top-4 right-4 flex gap-2\">\n        <LanguageSelector />\n        <ThemeToggle />\n      </div>\n      <Card className=\"w-full max-w-md\">\n        <CardHeader className=\"text-center\">\n          <div className=\"mx-auto mb-4 flex h-14 w-14 items-center justify-center rounded-full bg-primary/10\">\n            <Shield className=\"h-7 w-7 text-primary\" />\n          </div>\n          <CardTitle className=\"text-2xl\">{t(\"auth.setupTotp\")}</CardTitle>\n          <CardDescription>\n            Scan the QR code with your authenticator app (Google Authenticator, Authy, etc.)\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-6\">\n          {isLoadingTotp ? (\n            <div className=\"flex justify-center py-8\">\n              <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n            </div>\n          ) : totpData ? (\n            <>\n              <div className=\"flex justify-center\">\n                <div className=\"p-4 bg-white rounded-lg\">\n                  <QRCodeSVG\n                    value={totpData.otpauthUrl || \"\"}\n                    size={180}\n                    level=\"M\"\n                    includeMargin={false}\n                  />\n                </div>\n              </div>\n\n              <div className=\"text-center\">\n                <p className=\"text-sm text-muted-foreground mb-2\">\n                  Or enter this code manually:\n                </p>\n                <code className=\"px-3 py-2 bg-muted rounded-md text-sm font-mono tracking-wider\">\n                  {totpData.secret}\n                </code>\n              </div>\n\n              <form onSubmit={handleSubmit} className=\"space-y-4\">\n                <div>\n                  <label className=\"text-sm font-medium mb-2 block text-center\">\n                    {t(\"auth.enterCode\")}\n                  </label>\n                  <Input\n                    value={code}\n                    onChange={(e) => setCode(e.target.value.replace(/\\D/g, \"\").slice(0, 6))}\n                    placeholder=\"000000\"\n                    className=\"text-center text-2xl tracking-[0.5em] font-mono\"\n                    maxLength={6}\n                    data-testid=\"input-2fa-code\"\n                  />\n                </div>\n                <Button\n                  type=\"submit\"\n                  className=\"w-full\"\n                  disabled={code.length !== 6 || verifyMutation.isPending}\n                  data-testid=\"button-verify-2fa\"\n                >\n                  {verifyMutation.isPending ? (\n                    <>\n                      <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                      Verifying...\n                    </>\n                  ) : (\n                    t(\"auth.verifyCode\")\n                  )}\n                </Button>\n              </form>\n            </>\n          ) : (\n            <div className=\"text-center text-muted-foreground\">\n              Failed to load 2FA setup. Please try again.\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":6919,"size_tokens":null},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","path":null,"size_bytes":1077,"size_tokens":null},"client/src/pages/templates.tsx":{"content":"import { useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { Plus, Search, MoreHorizontal, Pencil, Trash2, FileText, Eye, Copy } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuTrigger } from \"@/components/ui/dropdown-menu\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { Template } from \"@shared/schema\";\n\nconst templateSchema = z.object({\n  title: z.string().min(1, \"Title is required\"),\n  type: z.enum([\"single_page\", \"multi_page\"]),\n  fontFamily: z.string().optional(),\n  textColor: z.string().optional(),\n  backgroundColor: z.string().optional(),\n});\n\ntype TemplateFormValues = z.infer<typeof templateSchema>;\n\nexport default function TemplatesPage() {\n  const { t } = useTranslation();\n  const { toast } = useToast();\n  const [search, setSearch] = useState(\"\");\n  const [typeFilter, setTypeFilter] = useState(\"all\");\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [editingTemplate, setEditingTemplate] = useState<Template | null>(null);\n\n  const { data: templates, isLoading } = useQuery<Template[]>({\n    queryKey: [\"/api/templates\"],\n  });\n\n  const form = useForm<TemplateFormValues>({\n    resolver: zodResolver(templateSchema),\n    defaultValues: {\n      title: \"\",\n      type: \"single_page\",\n      fontFamily: \"Inter\",\n      textColor: \"#000000\",\n      backgroundColor: \"#ffffff\",\n    },\n  });\n\n  const createMutation = useMutation({\n    mutationFn: async (data: TemplateFormValues) => {\n      return apiRequest(\"POST\", \"/api/templates\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/templates\"] });\n      setIsDialogOpen(false);\n      form.reset();\n      toast({ title: t(\"common.success\"), description: \"Template created successfully\" });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return apiRequest(\"DELETE\", `/api/templates/${id}`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/templates\"] });\n      toast({ title: t(\"common.success\"), description: \"Template deleted successfully\" });\n    },\n  });\n\n  const onSubmit = (data: TemplateFormValues) => {\n    createMutation.mutate(data);\n  };\n\n  const filteredTemplates = templates?.filter((t) => {\n    const matchesSearch = t.title.toLowerCase().includes(search.toLowerCase());\n    const matchesType = typeFilter === \"all\" || t.type === typeFilter;\n    return matchesSearch && matchesType;\n  });\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4\">\n        <div>\n          <h1 className=\"text-3xl font-semibold\">{t(\"templates.title\")}</h1>\n          <p className=\"text-muted-foreground\">Manage your brochure templates</p>\n        </div>\n        <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\n          <DialogTrigger asChild>\n            <Button data-testid=\"button-add-template\">\n              <Plus className=\"mr-2 h-4 w-4\" />\n              {t(\"templates.addTemplate\")}\n            </Button>\n          </DialogTrigger>\n          <DialogContent className=\"max-w-md\">\n            <DialogHeader>\n              <DialogTitle>{t(\"templates.addTemplate\")}</DialogTitle>\n              <DialogDescription>Create a new brochure template</DialogDescription>\n            </DialogHeader>\n            <Form {...form}>\n              <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n                <FormField\n                  control={form.control}\n                  name=\"title\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>{t(\"templates.templateName\")}</FormLabel>\n                      <FormControl>\n                        <Input {...field} data-testid=\"input-template-title\" />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <FormField\n                  control={form.control}\n                  name=\"type\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>{t(\"templates.templateType\")}</FormLabel>\n                      <Select onValueChange={field.onChange} defaultValue={field.value}>\n                        <FormControl>\n                          <SelectTrigger data-testid=\"select-template-type\">\n                            <SelectValue />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          <SelectItem value=\"single_page\">{t(\"templates.singlePage\")}</SelectItem>\n                          <SelectItem value=\"multi_page\">{t(\"templates.multiPage\")}</SelectItem>\n                        </SelectContent>\n                      </Select>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <FormField\n                    control={form.control}\n                    name=\"textColor\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>{t(\"templates.textColor\")}</FormLabel>\n                        <FormControl>\n                          <div className=\"flex gap-2\">\n                            <Input type=\"color\" {...field} className=\"w-12 h-9 p-1\" />\n                            <Input {...field} className=\"flex-1\" data-testid=\"input-text-color\" />\n                          </div>\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                  <FormField\n                    control={form.control}\n                    name=\"backgroundColor\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>{t(\"templates.backgroundColor\")}</FormLabel>\n                        <FormControl>\n                          <div className=\"flex gap-2\">\n                            <Input type=\"color\" {...field} className=\"w-12 h-9 p-1\" />\n                            <Input {...field} className=\"flex-1\" data-testid=\"input-bg-color\" />\n                          </div>\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                </div>\n                <FormField\n                  control={form.control}\n                  name=\"fontFamily\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>{t(\"templates.font\")}</FormLabel>\n                      <Select onValueChange={field.onChange} defaultValue={field.value}>\n                        <FormControl>\n                          <SelectTrigger data-testid=\"select-font\">\n                            <SelectValue />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          <SelectItem value=\"Inter\">Inter</SelectItem>\n                          <SelectItem value=\"Roboto\">Roboto</SelectItem>\n                          <SelectItem value=\"Open Sans\">Open Sans</SelectItem>\n                          <SelectItem value=\"Montserrat\">Montserrat</SelectItem>\n                          <SelectItem value=\"Poppins\">Poppins</SelectItem>\n                        </SelectContent>\n                      </Select>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <DialogFooter>\n                  <Button type=\"submit\" disabled={createMutation.isPending} data-testid=\"button-save-template\">\n                    {t(\"common.create\")}\n                  </Button>\n                </DialogFooter>\n              </form>\n            </Form>\n          </DialogContent>\n        </Dialog>\n      </div>\n\n      <Tabs defaultValue=\"all\" className=\"space-y-4\">\n        <div className=\"flex flex-col sm:flex-row gap-4\">\n          <TabsList>\n            <TabsTrigger value=\"all\" onClick={() => setTypeFilter(\"all\")}>\n              All Templates\n            </TabsTrigger>\n            <TabsTrigger value=\"single_page\" onClick={() => setTypeFilter(\"single_page\")}>\n              {t(\"templates.singlePage\")}\n            </TabsTrigger>\n            <TabsTrigger value=\"multi_page\" onClick={() => setTypeFilter(\"multi_page\")}>\n              {t(\"templates.multiPage\")}\n            </TabsTrigger>\n          </TabsList>\n          <div className=\"relative flex-1 sm:max-w-xs\">\n            <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n            <Input\n              placeholder=\"Search templates...\"\n              value={search}\n              onChange={(e) => setSearch(e.target.value)}\n              className=\"pl-10\"\n              data-testid=\"input-search-templates\"\n            />\n          </div>\n        </div>\n\n        <TabsContent value=\"all\" className=\"mt-0\">\n          {isLoading ? (\n            <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4\">\n              {[...Array(8)].map((_, i) => (\n                <Card key={i}>\n                  <CardContent className=\"p-4\">\n                    <Skeleton className=\"h-40 w-full mb-4\" />\n                    <Skeleton className=\"h-4 w-3/4 mb-2\" />\n                    <Skeleton className=\"h-4 w-1/2\" />\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          ) : filteredTemplates?.length === 0 ? (\n            <Card>\n              <CardContent className=\"flex flex-col items-center justify-center py-12\">\n                <FileText className=\"h-12 w-12 text-muted-foreground mb-4\" />\n                <h3 className=\"text-lg font-medium mb-2\">{t(\"templates.noTemplates\")}</h3>\n                <p className=\"text-muted-foreground text-center mb-4\">\n                  Create your first template to get started\n                </p>\n                <Button onClick={() => setIsDialogOpen(true)}>\n                  <Plus className=\"mr-2 h-4 w-4\" />\n                  {t(\"templates.addTemplate\")}\n                </Button>\n              </CardContent>\n            </Card>\n          ) : (\n            <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4\">\n              {filteredTemplates?.map((template) => (\n                <Card key={template.id} className=\"overflow-hidden group\" data-testid={`card-template-${template.id}`}>\n                  <div\n                    className=\"aspect-[3/4] flex items-center justify-center relative\"\n                    style={{ backgroundColor: template.backgroundColor || \"#f3f4f6\" }}\n                  >\n                    <FileText\n                      className=\"h-16 w-16 opacity-20\"\n                      style={{ color: template.textColor || \"#000\" }}\n                    />\n                    <div className=\"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2\">\n                      <Button size=\"icon\" variant=\"secondary\">\n                        <Eye className=\"h-4 w-4\" />\n                      </Button>\n                      <Button size=\"icon\" variant=\"secondary\">\n                        <Copy className=\"h-4 w-4\" />\n                      </Button>\n                    </div>\n                  </div>\n                  <CardContent className=\"p-4\">\n                    <div className=\"flex items-start justify-between gap-2\">\n                      <div className=\"flex-1 min-w-0\">\n                        <h3 className=\"font-medium truncate\">{template.title}</h3>\n                        <Badge variant=\"secondary\" className=\"mt-1\">\n                          {template.type === \"single_page\"\n                            ? t(\"templates.singlePage\")\n                            : t(\"templates.multiPage\")}\n                        </Badge>\n                      </div>\n                      <DropdownMenu>\n                        <DropdownMenuTrigger asChild>\n                          <Button variant=\"ghost\" size=\"icon\">\n                            <MoreHorizontal className=\"h-4 w-4\" />\n                          </Button>\n                        </DropdownMenuTrigger>\n                        <DropdownMenuContent align=\"end\">\n                          <DropdownMenuItem>\n                            <Eye className=\"mr-2 h-4 w-4\" />\n                            {t(\"templates.preview\")}\n                          </DropdownMenuItem>\n                          <DropdownMenuItem>\n                            <Pencil className=\"mr-2 h-4 w-4\" />\n                            {t(\"common.edit\")}\n                          </DropdownMenuItem>\n                          <DropdownMenuItem>\n                            <Copy className=\"mr-2 h-4 w-4\" />\n                            Duplicate\n                          </DropdownMenuItem>\n                          <DropdownMenuItem\n                            className=\"text-destructive\"\n                            onClick={() => deleteMutation.mutate(template.id)}\n                          >\n                            <Trash2 className=\"mr-2 h-4 w-4\" />\n                            {t(\"common.delete\")}\n                          </DropdownMenuItem>\n                        </DropdownMenuContent>\n                      </DropdownMenu>\n                    </div>\n                    <p className=\"text-sm text-muted-foreground mt-2\">\n                      Font: {template.fontFamily || \"Inter\"}\n                    </p>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          )}\n        </TabsContent>\n      </Tabs>\n    </div>\n  );\n}\n","path":null,"size_bytes":14818,"size_tokens":null},"client/src/pages/account.tsx":{"content":"import { useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { \n  User, \n  CreditCard, \n  Shield, \n  Check,\n  Smartphone\n} from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport {\n  Form,\n  FormControl,\n  FormDescription,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useAuth } from \"@/lib/auth-context\";\n\nconst profileFormSchema = z.object({\n  firstName: z.string().min(1, \"First name is required\"),\n  lastName: z.string().min(1, \"Last name is required\"),\n  email: z.string().email(\"Invalid email address\"),\n  mobilePhone: z.string().optional(),\n});\n\nconst passwordFormSchema = z.object({\n  currentPassword: z.string().min(1, \"Current password is required\"),\n  newPassword: z.string().min(8, \"Password must be at least 8 characters\"),\n  confirmPassword: z.string().min(1, \"Please confirm your password\"),\n}).refine((data) => data.newPassword === data.confirmPassword, {\n  message: \"Passwords do not match\",\n  path: [\"confirmPassword\"],\n});\n\ntype ProfileFormValues = z.infer<typeof profileFormSchema>;\ntype PasswordFormValues = z.infer<typeof passwordFormSchema>;\n\nexport default function AccountPage() {\n  const { t } = useTranslation();\n  const { toast } = useToast();\n  const { user } = useAuth();\n  const [activeTab, setActiveTab] = useState(\"profile\");\n\n  const profileForm = useForm<ProfileFormValues>({\n    resolver: zodResolver(profileFormSchema),\n    defaultValues: {\n      firstName: user?.firstName || \"\",\n      lastName: user?.lastName || \"\",\n      email: user?.email || \"\",\n      mobilePhone: user?.mobilePhone || \"\",\n    },\n  });\n\n  const passwordForm = useForm<PasswordFormValues>({\n    resolver: zodResolver(passwordFormSchema),\n    defaultValues: {\n      currentPassword: \"\",\n      newPassword: \"\",\n      confirmPassword: \"\",\n    },\n  });\n\n  const onProfileSubmit = (data: ProfileFormValues) => {\n    toast({\n      title: t(\"common.success\"),\n      description: \"Profile updated successfully.\",\n    });\n  };\n\n  const onPasswordSubmit = (data: PasswordFormValues) => {\n    passwordForm.reset();\n    toast({\n      title: t(\"common.success\"),\n      description: \"Password changed successfully.\",\n    });\n  };\n\n  const billingHistory = [\n    { id: \"1\", date: \"2024-01-15\", amount: \"$29.99\", status: \"paid\", plan: \"6 Month\" },\n    { id: \"2\", date: \"2023-07-15\", amount: \"$29.99\", status: \"paid\", plan: \"6 Month\" },\n    { id: \"3\", date: \"2023-01-15\", amount: \"$9.99\", status: \"paid\", plan: \"Monthly\" },\n  ];\n\n  return (\n    <div className=\"flex flex-col h-full\">\n      <div className=\"flex items-center justify-between gap-4 p-6 border-b\">\n        <h1 className=\"text-2xl font-semibold\" data-testid=\"text-page-title\">\n          {t(\"account.title\")}\n        </h1>\n      </div>\n\n      <div className=\"flex-1 overflow-auto p-6\">\n        <Tabs value={activeTab} onValueChange={setActiveTab}>\n          <TabsList className=\"mb-6\">\n            <TabsTrigger value=\"profile\" data-testid=\"tab-profile\">\n              <User className=\"h-4 w-4 mr-2\" />\n              {t(\"account.profile\")}\n            </TabsTrigger>\n            <TabsTrigger value=\"subscription\" data-testid=\"tab-subscription\">\n              <CreditCard className=\"h-4 w-4 mr-2\" />\n              {t(\"account.subscription\")}\n            </TabsTrigger>\n            <TabsTrigger value=\"security\" data-testid=\"tab-security\">\n              <Shield className=\"h-4 w-4 mr-2\" />\n              {t(\"account.security\")}\n            </TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"profile\" className=\"mt-0 space-y-6\">\n            <Card>\n              <CardHeader>\n                <CardTitle>{t(\"account.updateProfile\")}</CardTitle>\n                <CardDescription>Update your personal information</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <Form {...profileForm}>\n                  <form onSubmit={profileForm.handleSubmit(onProfileSubmit)} className=\"space-y-4\">\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                      <FormField\n                        control={profileForm.control}\n                        name=\"firstName\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>{t(\"auth.firstName\")}</FormLabel>\n                            <FormControl>\n                              <Input {...field} data-testid=\"input-first-name\" />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n                      <FormField\n                        control={profileForm.control}\n                        name=\"lastName\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>{t(\"auth.lastName\")}</FormLabel>\n                            <FormControl>\n                              <Input {...field} data-testid=\"input-last-name\" />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n                    </div>\n                    <FormField\n                      control={profileForm.control}\n                      name=\"email\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>{t(\"auth.email\")}</FormLabel>\n                          <FormControl>\n                            <Input {...field} type=\"email\" data-testid=\"input-email\" />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                    <FormField\n                      control={profileForm.control}\n                      name=\"mobilePhone\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>{t(\"auth.mobilePhone\")}</FormLabel>\n                          <FormControl>\n                            <Input {...field} data-testid=\"input-mobile-phone\" />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                    <Button type=\"submit\" data-testid=\"button-update-profile\">\n                      {t(\"account.updateProfile\")}\n                    </Button>\n                  </form>\n                </Form>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          <TabsContent value=\"subscription\" className=\"mt-0 space-y-6\">\n            <Card>\n              <CardHeader>\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <CardTitle>{t(\"account.subscriptionStatus\")}</CardTitle>\n                    <CardDescription>Manage your subscription plan</CardDescription>\n                  </div>\n                  <Badge variant=\"default\">Active</Badge>\n                </div>\n              </CardHeader>\n              <CardContent className=\"space-y-6\">\n                <div className=\"flex items-center justify-between p-4 rounded-lg bg-muted/50\">\n                  <div>\n                    <p className=\"font-medium\">6-Month Plan</p>\n                    <p className=\"text-sm text-muted-foreground\">$29.99/month</p>\n                  </div>\n                  <div className=\"text-right\">\n                    <p className=\"text-sm text-muted-foreground\">{t(\"account.expiresOn\")}</p>\n                    <p className=\"font-medium\">July 15, 2024</p>\n                  </div>\n                </div>\n                <div className=\"flex gap-2\">\n                  <Button data-testid=\"button-upgrade-plan\">\n                    {t(\"account.upgradePlan\")}\n                  </Button>\n                  <Button variant=\"outline\">Cancel Subscription</Button>\n                </div>\n\n                <Separator />\n\n                <div>\n                  <h3 className=\"font-medium mb-4\">Billing History</h3>\n                  <Table>\n                    <TableHeader>\n                      <TableRow>\n                        <TableHead>{t(\"common.date\")}</TableHead>\n                        <TableHead>Plan</TableHead>\n                        <TableHead>Amount</TableHead>\n                        <TableHead>{t(\"common.status\")}</TableHead>\n                      </TableRow>\n                    </TableHeader>\n                    <TableBody>\n                      {billingHistory.map((item) => (\n                        <TableRow key={item.id}>\n                          <TableCell>{item.date}</TableCell>\n                          <TableCell>{item.plan}</TableCell>\n                          <TableCell>{item.amount}</TableCell>\n                          <TableCell>\n                            <Badge variant=\"secondary\">\n                              <Check className=\"h-3 w-3 mr-1\" />\n                              {item.status}\n                            </Badge>\n                          </TableCell>\n                        </TableRow>\n                      ))}\n                    </TableBody>\n                  </Table>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          <TabsContent value=\"security\" className=\"mt-0 space-y-6\">\n            <Card>\n              <CardHeader>\n                <CardTitle>{t(\"account.changePassword\")}</CardTitle>\n                <CardDescription>Update your password</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <Form {...passwordForm}>\n                  <form onSubmit={passwordForm.handleSubmit(onPasswordSubmit)} className=\"space-y-4\">\n                    <FormField\n                      control={passwordForm.control}\n                      name=\"currentPassword\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>{t(\"account.currentPassword\")}</FormLabel>\n                          <FormControl>\n                            <Input {...field} type=\"password\" data-testid=\"input-current-password\" />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                    <FormField\n                      control={passwordForm.control}\n                      name=\"newPassword\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>{t(\"account.newPassword\")}</FormLabel>\n                          <FormControl>\n                            <Input {...field} type=\"password\" data-testid=\"input-new-password\" />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                    <FormField\n                      control={passwordForm.control}\n                      name=\"confirmPassword\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>{t(\"account.confirmNewPassword\")}</FormLabel>\n                          <FormControl>\n                            <Input {...field} type=\"password\" data-testid=\"input-confirm-password\" />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                    <Button type=\"submit\" data-testid=\"button-change-password\">\n                      {t(\"account.changePassword\")}\n                    </Button>\n                  </form>\n                </Form>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>{t(\"account.twoFactorAuth\")}</CardTitle>\n                <CardDescription>Add an extra layer of security to your account</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-4\">\n                    <div className=\"flex h-10 w-10 items-center justify-center rounded-full bg-primary/10\">\n                      <Smartphone className=\"h-5 w-5 text-primary\" />\n                    </div>\n                    <div>\n                      <p className=\"font-medium\">Authenticator App</p>\n                      <p className=\"text-sm text-muted-foreground\">\n                        {user?.totpEnabled ? \"Enabled\" : \"Not configured\"}\n                      </p>\n                    </div>\n                  </div>\n                  <Switch\n                    checked={user?.totpEnabled || false}\n                    data-testid=\"switch-2fa\"\n                  />\n                </div>\n                {!user?.totpEnabled && (\n                  <Button variant=\"outline\" className=\"mt-4\" asChild data-testid=\"button-setup-2fa\">\n                    <a href=\"/setup-2fa\">{t(\"account.enable2fa\")}</a>\n                  </Button>\n                )}\n              </CardContent>\n            </Card>\n          </TabsContent>\n        </Tabs>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":14040,"size_tokens":null},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","path":null,"size_bytes":1467,"size_tokens":null},"server/static.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(__dirname, \"public\");\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","path":null,"size_bytes":547,"size_tokens":null},"client/src/pages/campaign-editor.tsx":{"content":"import { useState, useEffect, useRef } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { useParams, useLocation } from \"wouter\";\nimport { \n  Save, \n  Undo, \n  Redo, \n  Eye, \n  Upload,\n  ZoomIn, \n  ZoomOut,\n  Plus,\n  Trash2,\n  Type,\n  Square,\n  Circle,\n  Triangle,\n  Minus,\n  Image as ImageIcon,\n  Package,\n  Layers,\n  Settings,\n  ChevronLeft,\n  ChevronRight,\n  GripVertical,\n  Move,\n  Pencil,\n  MousePointer,\n  Bold,\n  Italic,\n  Underline,\n  AlignLeft,\n  AlignCenter,\n  AlignRight,\n  Palette,\n  PanelTop,\n  PanelBottom\n} from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { Slider } from \"@/components/ui/slider\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\";\nimport {\n  Tabs,\n  TabsContent,\n  TabsList,\n  TabsTrigger,\n} from \"@/components/ui/tabs\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogFooter,\n  DialogDescription,\n} from \"@/components/ui/dialog\";\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { Campaign, Product, Template } from \"@shared/schema\";\n\ntype CanvasSizeKey = 'square' | 'portrait' | 'landscape' | 'a4portrait' | 'a4landscape';\ntype ToolType = 'select' | 'text' | 'shape' | 'draw' | 'image';\ntype ShapeType = 'rectangle' | 'circle' | 'triangle' | 'line';\n\nconst CANVAS_SIZES: Record<CanvasSizeKey, { width: number; height: number; label: string; ratio: string }> = {\n  square: { width: 1080, height: 1080, label: 'Square', ratio: '1:1' },\n  portrait: { width: 1080, height: 1350, label: 'Portrait', ratio: '4:5' },\n  landscape: { width: 1080, height: 566, label: 'Landscape', ratio: '1.91:1' },\n  a4portrait: { width: 794, height: 1123, label: 'A4 Portrait', ratio: 'A4' },\n  a4landscape: { width: 1123, height: 794, label: 'A4 Landscape', ratio: 'A4' },\n};\n\nconst FONT_FAMILIES = [\n  { value: 'Inter', label: 'Inter' },\n  { value: 'Arial', label: 'Arial' },\n  { value: 'Georgia', label: 'Georgia' },\n  { value: 'Times New Roman', label: 'Times New Roman' },\n  { value: 'Courier New', label: 'Courier New' },\n  { value: 'Verdana', label: 'Verdana' },\n  { value: 'Helvetica', label: 'Helvetica' },\n  { value: 'Trebuchet MS', label: 'Trebuchet MS' },\n];\n\nconst FONT_SIZES = [8, 10, 12, 14, 16, 18, 20, 24, 28, 32, 36, 42, 48, 56, 64, 72, 96];\n\nconst PRESET_COLORS = [\n  '#000000', '#FFFFFF', '#FF0000', '#00FF00', '#0000FF', '#FFFF00', \n  '#FF00FF', '#00FFFF', '#FFA500', '#800080', '#008000', '#800000',\n  '#000080', '#808080', '#C0C0C0', '#FFD700', '#FF69B4', '#4B0082',\n];\n\ninterface CanvasElement {\n  id: string;\n  type: 'product' | 'text' | 'shape' | 'image' | 'header' | 'footer';\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n  rotation: number;\n  opacity: number;\n  data: any;\n  page: number;\n}\n\ninterface TextElementData {\n  text: string;\n  fontFamily: string;\n  fontSize: number;\n  fontWeight: 'normal' | 'bold';\n  fontStyle: 'normal' | 'italic';\n  textDecoration: 'none' | 'underline';\n  textAlign: 'left' | 'center' | 'right';\n  color: string;\n  backgroundColor: string;\n}\n\ninterface ShapeElementData {\n  shapeType: ShapeType;\n  fill: string;\n  stroke: string;\n  strokeWidth: number;\n}\n\ninterface DrawingPoint {\n  x: number;\n  y: number;\n}\n\ninterface DrawElementData {\n  points: DrawingPoint[];\n  strokeColor: string;\n  strokeWidth: number;\n}\n\nexport default function CampaignEditorPage() {\n  const { t } = useTranslation();\n  const { toast } = useToast();\n  const { id } = useParams<{ id: string }>();\n  const [, setLocation] = useLocation();\n  \n  const canvasRef = useRef<HTMLDivElement>(null);\n  const [zoom, setZoom] = useState(100);\n  const [canvasSize, setCanvasSize] = useState<CanvasSizeKey>('a4portrait');\n  const [currentPage, setCurrentPage] = useState(1);\n  const [totalPages, setTotalPages] = useState(1);\n  const [selectedElement, setSelectedElement] = useState<string | null>(null);\n  const [leftPanelTab, setLeftPanelTab] = useState(\"tools\");\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [canvasElements, setCanvasElements] = useState<CanvasElement[]>([]);\n  const [isDragging, setIsDragging] = useState(false);\n  const [isMovingElement, setIsMovingElement] = useState(false);\n  const [dragOffset, setDragOffset] = useState({ x: 0, y: 0 });\n  const [isResizing, setIsResizing] = useState(false);\n  const [resizeHandle, setResizeHandle] = useState<string | null>(null);\n  const [resizeStart, setResizeStart] = useState({ x: 0, y: 0, width: 0, height: 0, elementX: 0, elementY: 0 });\n  const [campaignName, setCampaignName] = useState(\"\");\n  const [showPreview, setShowPreview] = useState(false);\n  const [savedCampaignId, setSavedCampaignId] = useState<string | null>(null);\n  const [showSaveDialog, setShowSaveDialog] = useState(false);\n  const [tempCampaignName, setTempCampaignName] = useState(\"\");\n  \n  const [activeTool, setActiveTool] = useState<ToolType>('select');\n  const [activeShapeType, setActiveShapeType] = useState<ShapeType>('rectangle');\n  const [isDrawing, setIsDrawing] = useState(false);\n  const [drawingPoints, setDrawingPoints] = useState<DrawingPoint[]>([]);\n  const [drawColor, setDrawColor] = useState('#000000');\n  const [drawStrokeWidth, setDrawStrokeWidth] = useState(2);\n  const [textColor, setTextColor] = useState('#000000');\n  const [shapeFillColor, setShapeFillColor] = useState('#3B82F6');\n  const [shapeStrokeColor, setShapeStrokeColor] = useState('#1E40AF');\n  const [showHeaderZone, setShowHeaderZone] = useState(true);\n  const [showFooterZone, setShowFooterZone] = useState(true);\n  const [headerHeight, setHeaderHeight] = useState(80);\n  const [footerHeight, setFooterHeight] = useState(60);\n\n  const { data: campaign, isLoading: loadingCampaign } = useQuery<Campaign>({\n    queryKey: [`/api/campaigns/${id}`],\n    enabled: !!id && id !== \"new\",\n  });\n\n  const { data: products, isLoading: loadingProducts } = useQuery<Product[]>({\n    queryKey: [\"/api/products\"],\n  });\n\n  const { data: externalProducts, isLoading: loadingExternalProducts } = useQuery<any[]>({\n    queryKey: [\"/api/products/search\", searchQuery],\n    queryFn: async () => {\n      const token = localStorage.getItem(\"authToken\");\n      const res = await fetch(`/api/products/search?q=${encodeURIComponent(searchQuery)}`, {\n        headers: token ? { Authorization: `Bearer ${token}` } : {},\n        credentials: \"include\",\n      });\n      if (!res.ok) throw new Error(\"Failed to search products\");\n      return res.json();\n    },\n    enabled: searchQuery.length >= 2,\n  });\n\n  const { data: templates } = useQuery<Template[]>({\n    queryKey: [\"/api/templates\"],\n  });\n\n  const filteredProducts = products?.filter((product) =>\n    product.name.toLowerCase().includes(searchQuery.toLowerCase())\n  );\n\n  const allProducts = [\n    ...(filteredProducts || []),\n    ...(externalProducts || []).map((p: any) => ({\n      ...p,\n      isExternal: true,\n    })),\n  ];\n\n  useEffect(() => {\n    if (campaign) {\n      setCampaignName(campaign.name);\n      setSavedCampaignId(campaign.id);\n      if (campaign.canvasData) {\n        const data = campaign.canvasData as any;\n        if (data.elements) setCanvasElements(data.elements);\n        if (data.canvasSize) setCanvasSize(data.canvasSize);\n        if (data.totalPages) setTotalPages(data.totalPages);\n        if (data.headerHeight !== undefined) setHeaderHeight(data.headerHeight);\n        if (data.footerHeight !== undefined) setFooterHeight(data.footerHeight);\n        if (data.showHeaderZone !== undefined) setShowHeaderZone(data.showHeaderZone);\n        if (data.showFooterZone !== undefined) setShowFooterZone(data.showFooterZone);\n      }\n    }\n  }, [campaign]);\n\n  const createCampaignMutation = useMutation({\n    mutationFn: async (data: any) => {\n      return await apiRequest(\"POST\", \"/api/campaigns\", data) as any;\n    },\n    onSuccess: (data) => {\n      setSavedCampaignId(data.id);\n      queryClient.invalidateQueries({ queryKey: [\"/api/campaigns\"] });\n      toast({\n        title: t(\"common.success\"),\n        description: t(\"campaigns.savedSuccessfully\"),\n      });\n      if (id === \"new\") {\n        setLocation(`/campaigns/${data.id}/edit`);\n      }\n    },\n    onError: () => {\n      toast({\n        title: t(\"common.error\"),\n        description: t(\"campaigns.saveFailed\"),\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const updateCampaignMutation = useMutation({\n    mutationFn: async ({ campaignId, data }: { campaignId: string; data: any }) => {\n      return await apiRequest(\"PATCH\", `/api/campaigns/${campaignId}`, data) as any;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/campaigns\"] });\n      toast({\n        title: t(\"common.success\"),\n        description: t(\"campaigns.savedSuccessfully\"),\n      });\n    },\n    onError: () => {\n      toast({\n        title: t(\"common.error\"),\n        description: t(\"campaigns.saveFailed\"),\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleSave = () => {\n    if (!campaignName.trim()) {\n      setTempCampaignName(\"\");\n      setShowSaveDialog(true);\n      return;\n    }\n    performSave(campaignName);\n  };\n\n  const performSave = (name: string) => {\n    const canvasData = {\n      elements: canvasElements.map(el => ({\n        id: el.id,\n        type: el.type,\n        x: el.x,\n        y: el.y,\n        width: el.width,\n        height: el.height,\n        rotation: el.rotation,\n        opacity: el.opacity,\n        data: el.data,\n        page: el.page,\n      })),\n      canvasSize,\n      totalPages,\n      headerHeight,\n      footerHeight,\n      showHeaderZone,\n      showFooterZone,\n    };\n\n    const campaignData = {\n      name: name,\n      canvasData,\n      status: \"draft\" as const,\n    };\n\n    if (savedCampaignId || (id && id !== \"new\")) {\n      updateCampaignMutation.mutate({\n        campaignId: savedCampaignId || id!,\n        data: campaignData,\n      });\n    } else {\n      createCampaignMutation.mutate(campaignData);\n    }\n  };\n\n  const handleSaveDialogConfirm = () => {\n    if (!tempCampaignName.trim()) {\n      toast({\n        title: t(\"common.error\"),\n        description: t(\"campaigns.nameRequired\"),\n        variant: \"destructive\",\n      });\n      return;\n    }\n    setCampaignName(tempCampaignName.trim());\n    setShowSaveDialog(false);\n    performSave(tempCampaignName.trim());\n  };\n\n  const handlePreview = () => setShowPreview(true);\n  const handleUndo = () => console.log(\"Undo\");\n  const handleRedo = () => console.log(\"Redo\");\n  const handleZoomIn = () => setZoom((prev) => Math.min(prev + 10, 200));\n  const handleZoomOut = () => setZoom((prev) => Math.max(prev - 10, 25));\n\n  const handleAddPage = () => {\n    setTotalPages((prev) => prev + 1);\n    setCurrentPage(totalPages + 1);\n  };\n\n  const handleDeletePage = () => {\n    if (totalPages > 1) {\n      setTotalPages((prev) => prev - 1);\n      if (currentPage > totalPages - 1) {\n        setCurrentPage(totalPages - 1);\n      }\n    }\n  };\n\n  const handleDragStart = (e: React.DragEvent, product: Product) => {\n    e.dataTransfer.setData(\"product\", JSON.stringify(product));\n    e.dataTransfer.effectAllowed = \"copy\";\n  };\n\n  const handleDrop = (e: React.DragEvent) => {\n    e.preventDefault();\n    setIsDragging(false);\n    const productData = e.dataTransfer.getData(\"product\");\n    if (productData && canvasRef.current) {\n      const product = JSON.parse(productData);\n      const rect = canvasRef.current.getBoundingClientRect();\n      const x = (e.clientX - rect.left) / (zoom / 100);\n      const y = (e.clientY - rect.top) / (zoom / 100);\n      \n      const newElement: CanvasElement = {\n        id: `element-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n        type: 'product',\n        x: Math.max(0, x - 60),\n        y: Math.max(0, y - 60),\n        width: 120,\n        height: 140,\n        rotation: 0,\n        opacity: 100,\n        data: product,\n        page: currentPage,\n      };\n      \n      setCanvasElements((prev) => [...prev, newElement]);\n      setSelectedElement(newElement.id);\n      setActiveTool('select');\n      \n      toast({\n        title: t(\"common.success\"),\n        description: `${product.name} ${t(\"editor.addedToCanvas\")}`,\n      });\n    }\n  };\n\n  const handleDragOver = (e: React.DragEvent) => {\n    e.preventDefault();\n    e.dataTransfer.dropEffect = \"copy\";\n    setIsDragging(true);\n  };\n\n  const handleDragLeave = (e: React.DragEvent) => {\n    e.preventDefault();\n    setIsDragging(false);\n  };\n\n  const addTextElement = (clickX: number, clickY: number) => {\n    if (!canvasRef.current) return;\n    \n    const elementWidth = 200;\n    const elementHeight = 40;\n    const x = Math.max(0, clickX - elementWidth / 2);\n    const y = Math.max(0, clickY - elementHeight / 2);\n    \n    const newElement: CanvasElement = {\n      id: `text-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n      type: 'text',\n      x,\n      y,\n      width: elementWidth,\n      height: elementHeight,\n      rotation: 0,\n      opacity: 100,\n      data: {\n        text: t(\"editor.sampleText\"),\n        fontFamily: 'Inter',\n        fontSize: 16,\n        fontWeight: 'normal',\n        fontStyle: 'normal',\n        textDecoration: 'none',\n        textAlign: 'left',\n        color: textColor,\n        backgroundColor: 'transparent',\n      } as TextElementData,\n      page: currentPage,\n    };\n    \n    setCanvasElements((prev) => [...prev, newElement]);\n    setSelectedElement(newElement.id);\n    setActiveTool('select');\n  };\n\n  const addShapeElement = (shapeType: ShapeType, clickX: number, clickY: number) => {\n    if (!canvasRef.current) return;\n    \n    const elementWidth = shapeType === 'line' ? 200 : 100;\n    const elementHeight = shapeType === 'line' ? 4 : 100;\n    const x = Math.max(0, clickX - elementWidth / 2);\n    const y = Math.max(0, clickY - elementHeight / 2);\n    \n    const newElement: CanvasElement = {\n      id: `shape-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n      type: 'shape',\n      x,\n      y,\n      width: elementWidth,\n      height: elementHeight,\n      rotation: 0,\n      opacity: 100,\n      data: {\n        shapeType,\n        fill: shapeFillColor,\n        stroke: shapeStrokeColor,\n        strokeWidth: 2,\n      } as ShapeElementData,\n      page: currentPage,\n    };\n    \n    setCanvasElements((prev) => [...prev, newElement]);\n    setSelectedElement(newElement.id);\n    setActiveTool('select');\n  };\n\n  const handleCanvasClick = (e: React.MouseEvent) => {\n    if (!canvasRef.current) return;\n    \n    const rect = canvasRef.current.getBoundingClientRect();\n    const clickX = (e.clientX - rect.left) / (zoom / 100);\n    const clickY = (e.clientY - rect.top) / (zoom / 100);\n    \n    if (activeTool === 'text') {\n      addTextElement(clickX, clickY);\n      return;\n    }\n    \n    if (activeTool === 'shape') {\n      addShapeElement(activeShapeType, clickX, clickY);\n      return;\n    }\n    \n    if (!isMovingElement && !isDrawing) {\n      setSelectedElement(null);\n    }\n  };\n\n  const handleCanvasMouseDown = (e: React.MouseEvent) => {\n    if (activeTool === 'draw' && canvasRef.current) {\n      const rect = canvasRef.current.getBoundingClientRect();\n      const x = (e.clientX - rect.left) / (zoom / 100);\n      const y = (e.clientY - rect.top) / (zoom / 100);\n      setIsDrawing(true);\n      setDrawingPoints([{ x, y }]);\n    }\n  };\n\n  const handleCanvasMouseMove = (e: React.MouseEvent) => {\n    if (activeTool === 'draw' && isDrawing && canvasRef.current) {\n      const rect = canvasRef.current.getBoundingClientRect();\n      const x = (e.clientX - rect.left) / (zoom / 100);\n      const y = (e.clientY - rect.top) / (zoom / 100);\n      setDrawingPoints((prev) => [...prev, { x, y }]);\n      return;\n    }\n\n    if (isResizing) {\n      handleResizeMouseMove(e);\n      return;\n    }\n    \n    if (!isMovingElement || !selectedElement || !canvasRef.current) return;\n    \n    const rect = canvasRef.current.getBoundingClientRect();\n    const mouseX = (e.clientX - rect.left) / (zoom / 100);\n    const mouseY = (e.clientY - rect.top) / (zoom / 100);\n    \n    const newX = Math.max(0, mouseX - dragOffset.x);\n    const newY = Math.max(0, mouseY - dragOffset.y);\n    \n    setCanvasElements((prev) =>\n      prev.map((el) =>\n        el.id === selectedElement ? { ...el, x: newX, y: newY } : el\n      )\n    );\n  };\n\n  const handleCanvasMouseUp = () => {\n    if (activeTool === 'draw' && isDrawing && drawingPoints.length > 1) {\n      const minX = Math.min(...drawingPoints.map(p => p.x));\n      const minY = Math.min(...drawingPoints.map(p => p.y));\n      const maxX = Math.max(...drawingPoints.map(p => p.x));\n      const maxY = Math.max(...drawingPoints.map(p => p.y));\n      \n      const normalizedPoints = drawingPoints.map(p => ({\n        x: p.x - minX,\n        y: p.y - minY,\n      }));\n      \n      const newElement: CanvasElement = {\n        id: `draw-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n        type: 'shape',\n        x: minX,\n        y: minY,\n        width: Math.max(maxX - minX, 10),\n        height: Math.max(maxY - minY, 10),\n        rotation: 0,\n        opacity: 100,\n        data: {\n          shapeType: 'freehand' as any,\n          points: normalizedPoints,\n          strokeColor: drawColor,\n          strokeWidth: drawStrokeWidth,\n          fill: 'transparent',\n          stroke: drawColor,\n        },\n        page: currentPage,\n      };\n      \n      setCanvasElements((prev) => [...prev, newElement]);\n      setSelectedElement(newElement.id);\n    }\n    \n    setIsDrawing(false);\n    setDrawingPoints([]);\n    setIsMovingElement(false);\n    setIsResizing(false);\n    setResizeHandle(null);\n  };\n\n  const handleCanvasMouseLeave = () => {\n    if (isDrawing) {\n      handleCanvasMouseUp();\n    }\n    setIsMovingElement(false);\n    setIsResizing(false);\n    setResizeHandle(null);\n  };\n\n  const handleElementMouseDown = (elementId: string, e: React.MouseEvent) => {\n    if (activeTool !== 'select') return;\n    \n    e.stopPropagation();\n    e.preventDefault();\n    setSelectedElement(elementId);\n    setIsMovingElement(true);\n    \n    const element = canvasElements.find((el) => el.id === elementId);\n    if (element && canvasRef.current) {\n      const rect = canvasRef.current.getBoundingClientRect();\n      const mouseX = (e.clientX - rect.left) / (zoom / 100);\n      const mouseY = (e.clientY - rect.top) / (zoom / 100);\n      setDragOffset({\n        x: mouseX - element.x,\n        y: mouseY - element.y,\n      });\n    }\n  };\n\n  const handleResizeMouseDown = (handle: string, e: React.MouseEvent) => {\n    e.stopPropagation();\n    e.preventDefault();\n    if (!selectedElement || !canvasRef.current) return;\n    \n    const element = canvasElements.find((el) => el.id === selectedElement);\n    if (!element) return;\n    \n    const rect = canvasRef.current.getBoundingClientRect();\n    const mouseX = (e.clientX - rect.left) / (zoom / 100);\n    const mouseY = (e.clientY - rect.top) / (zoom / 100);\n    \n    setIsResizing(true);\n    setResizeHandle(handle);\n    setResizeStart({\n      x: mouseX,\n      y: mouseY,\n      width: element.width,\n      height: element.height,\n      elementX: element.x,\n      elementY: element.y,\n    });\n  };\n\n  const handleResizeMouseMove = (e: React.MouseEvent) => {\n    if (!isResizing || !selectedElement || !canvasRef.current || !resizeHandle) return;\n    \n    const rect = canvasRef.current.getBoundingClientRect();\n    const mouseX = (e.clientX - rect.left) / (zoom / 100);\n    const mouseY = (e.clientY - rect.top) / (zoom / 100);\n    \n    const deltaX = mouseX - resizeStart.x;\n    const deltaY = mouseY - resizeStart.y;\n    \n    let newWidth = resizeStart.width;\n    let newHeight = resizeStart.height;\n    let newX = resizeStart.elementX;\n    let newY = resizeStart.elementY;\n    \n    const minSize = 20;\n    \n    if (resizeHandle.includes('e')) {\n      newWidth = Math.max(minSize, resizeStart.width + deltaX);\n    }\n    if (resizeHandle.includes('w')) {\n      const widthDelta = Math.min(deltaX, resizeStart.width - minSize);\n      newWidth = resizeStart.width - widthDelta;\n      newX = resizeStart.elementX + widthDelta;\n    }\n    if (resizeHandle.includes('s')) {\n      newHeight = Math.max(minSize, resizeStart.height + deltaY);\n    }\n    if (resizeHandle.includes('n')) {\n      const heightDelta = Math.min(deltaY, resizeStart.height - minSize);\n      newHeight = resizeStart.height - heightDelta;\n      newY = resizeStart.elementY + heightDelta;\n    }\n    \n    setCanvasElements((prev) =>\n      prev.map((el) =>\n        el.id === selectedElement\n          ? { ...el, width: newWidth, height: newHeight, x: newX, y: newY }\n          : el\n      )\n    );\n  };\n\n  const handleDeleteElement = () => {\n    if (selectedElement) {\n      setCanvasElements((prev) => prev.filter((el) => el.id !== selectedElement));\n      setSelectedElement(null);\n    }\n  };\n\n  const updateElementProperty = (property: keyof CanvasElement, value: any) => {\n    if (selectedElement) {\n      setCanvasElements((prev) =>\n        prev.map((el) =>\n          el.id === selectedElement ? { ...el, [property]: value } : el\n        )\n      );\n    }\n  };\n\n  const updateElementData = (dataProperty: string, value: any) => {\n    if (selectedElement) {\n      setCanvasElements((prev) =>\n        prev.map((el) =>\n          el.id === selectedElement\n            ? { ...el, data: { ...el.data, [dataProperty]: value } }\n            : el\n        )\n      );\n    }\n  };\n\n  const currentPageElements = canvasElements.filter((el) => el.page === currentPage);\n  const selectedElementData = canvasElements.find((el) => el.id === selectedElement);\n\n  const renderElement = (element: CanvasElement, inPreview: boolean = false) => {\n    const scale = inPreview ? 0.4 : zoom / 100;\n    \n    if (element.type === 'product') {\n      return (\n        <div className=\"w-full h-full bg-card border rounded-md overflow-hidden flex flex-col\">\n          <div className=\"flex-1 bg-muted flex items-center justify-center overflow-hidden\">\n            {element.data.imageUrl ? (\n              <img\n                src={element.data.imageUrl}\n                alt={element.data.name}\n                className=\"w-full h-full object-cover\"\n                draggable={false}\n              />\n            ) : (\n              <Package className=\"h-8 w-8 text-muted-foreground\" />\n            )}\n          </div>\n          <div className=\"p-1 text-center bg-background\">\n            <p className=\"text-xs font-medium truncate\">{element.data.name}</p>\n            <p className=\"text-xs text-primary font-bold\">\n              ${element.data.discountPrice || element.data.price}\n            </p>\n          </div>\n        </div>\n      );\n    }\n    \n    if (element.type === 'text') {\n      const textData = element.data as TextElementData;\n      return (\n        <div\n          className=\"w-full h-full flex items-center overflow-hidden\"\n          style={{\n            fontFamily: textData.fontFamily,\n            fontSize: `${textData.fontSize * scale}px`,\n            fontWeight: textData.fontWeight,\n            fontStyle: textData.fontStyle,\n            textDecoration: textData.textDecoration,\n            textAlign: textData.textAlign,\n            color: textData.color,\n            backgroundColor: textData.backgroundColor === 'transparent' ? 'transparent' : textData.backgroundColor,\n          }}\n        >\n          <span className=\"w-full px-1\">{textData.text}</span>\n        </div>\n      );\n    }\n    \n    if (element.type === 'shape') {\n      const shapeData = element.data as ShapeElementData;\n      \n      if (shapeData.shapeType === 'rectangle') {\n        return (\n          <div\n            className=\"w-full h-full\"\n            style={{\n              backgroundColor: shapeData.fill,\n              border: `${shapeData.strokeWidth}px solid ${shapeData.stroke}`,\n              borderRadius: '4px',\n            }}\n          />\n        );\n      }\n      \n      if (shapeData.shapeType === 'circle') {\n        return (\n          <div\n            className=\"w-full h-full rounded-full\"\n            style={{\n              backgroundColor: shapeData.fill,\n              border: `${shapeData.strokeWidth}px solid ${shapeData.stroke}`,\n            }}\n          />\n        );\n      }\n      \n      if (shapeData.shapeType === 'triangle') {\n        return (\n          <svg viewBox=\"0 0 100 100\" className=\"w-full h-full\">\n            <polygon\n              points=\"50,5 95,95 5,95\"\n              fill={shapeData.fill}\n              stroke={shapeData.stroke}\n              strokeWidth={shapeData.strokeWidth}\n            />\n          </svg>\n        );\n      }\n      \n      if (shapeData.shapeType === 'line') {\n        return (\n          <div\n            className=\"w-full\"\n            style={{\n              height: `${shapeData.strokeWidth}px`,\n              backgroundColor: shapeData.stroke,\n              marginTop: `${(element.height - shapeData.strokeWidth) / 2}px`,\n            }}\n          />\n        );\n      }\n      \n      if ((shapeData as any).shapeType === 'freehand' && (element.data as any).points) {\n        const points = (element.data as any).points as DrawingPoint[];\n        const pathData = points.reduce((acc, point, i) => {\n          if (i === 0) return `M ${point.x} ${point.y}`;\n          return `${acc} L ${point.x} ${point.y}`;\n        }, '');\n        \n        return (\n          <svg viewBox={`0 0 ${element.width} ${element.height}`} className=\"w-full h-full\">\n            <path\n              d={pathData}\n              fill=\"none\"\n              stroke={(element.data as any).strokeColor || shapeData.stroke}\n              strokeWidth={(element.data as any).strokeWidth || shapeData.strokeWidth}\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n            />\n          </svg>\n        );\n      }\n    }\n    \n    return null;\n  };\n\n  if (loadingCampaign && id !== \"new\") {\n    return (\n      <div className=\"flex h-full\">\n        <Skeleton className=\"w-72 h-full\" />\n        <Skeleton className=\"flex-1 h-full\" />\n        <Skeleton className=\"w-80 h-full\" />\n      </div>\n    );\n  }\n\n  const scaledCanvasWidth = (CANVAS_SIZES[canvasSize].width * zoom) / 100 * 0.5;\n  const scaledCanvasHeight = (CANVAS_SIZES[canvasSize].height * zoom) / 100 * 0.5;\n  const scaledHeaderHeight = (headerHeight * zoom) / 100 * 0.5;\n  const scaledFooterHeight = (footerHeight * zoom) / 100 * 0.5;\n\n  return (\n    <div className=\"flex flex-col h-full\">\n      <div className=\"flex items-center justify-between gap-4 px-4 py-2 border-b bg-background z-50\">\n        <div className=\"flex items-center gap-2\">\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            onClick={() => setLocation(\"/campaigns\")}\n            data-testid=\"button-back\"\n          >\n            <ChevronLeft className=\"h-4 w-4\" />\n          </Button>\n          <Separator orientation=\"vertical\" className=\"h-6\" />\n          <h1 className=\"font-medium truncate max-w-[200px]\" data-testid=\"text-campaign-name\">\n            {campaign?.name || t(\"campaigns.createCampaign\")}\n          </h1>\n          <Badge variant=\"secondary\">{campaign?.status || \"draft\"}</Badge>\n        </div>\n\n        <div className=\"flex items-center gap-1\">\n          <Tooltip>\n            <TooltipTrigger asChild>\n              <Button variant=\"ghost\" size=\"icon\" onClick={handleUndo} data-testid=\"button-undo\">\n                <Undo className=\"h-4 w-4\" />\n              </Button>\n            </TooltipTrigger>\n            <TooltipContent>{t(\"editor.undo\")}</TooltipContent>\n          </Tooltip>\n          <Tooltip>\n            <TooltipTrigger asChild>\n              <Button variant=\"ghost\" size=\"icon\" onClick={handleRedo} data-testid=\"button-redo\">\n                <Redo className=\"h-4 w-4\" />\n              </Button>\n            </TooltipTrigger>\n            <TooltipContent>{t(\"editor.redo\")}</TooltipContent>\n          </Tooltip>\n          <Separator orientation=\"vertical\" className=\"h-6 mx-2\" />\n          <Tooltip>\n            <TooltipTrigger asChild>\n              <Button variant=\"ghost\" size=\"icon\" onClick={handleZoomOut} data-testid=\"button-zoom-out\">\n                <ZoomOut className=\"h-4 w-4\" />\n              </Button>\n            </TooltipTrigger>\n            <TooltipContent>{t(\"editor.zoomOut\")}</TooltipContent>\n          </Tooltip>\n          <span className=\"text-sm w-12 text-center\">{zoom}%</span>\n          <Tooltip>\n            <TooltipTrigger asChild>\n              <Button variant=\"ghost\" size=\"icon\" onClick={handleZoomIn} data-testid=\"button-zoom-in\">\n                <ZoomIn className=\"h-4 w-4\" />\n              </Button>\n            </TooltipTrigger>\n            <TooltipContent>{t(\"editor.zoomIn\")}</TooltipContent>\n          </Tooltip>\n          <Separator orientation=\"vertical\" className=\"h-6 mx-2\" />\n          <Select value={canvasSize} onValueChange={(value: CanvasSizeKey) => setCanvasSize(value)}>\n            <SelectTrigger className=\"w-[160px]\" data-testid=\"select-canvas-size\">\n              <SelectValue placeholder={t(\"editor.canvasSize\")} />\n            </SelectTrigger>\n            <SelectContent>\n              {Object.entries(CANVAS_SIZES).map(([key, size]) => (\n                <SelectItem key={key} value={key} data-testid={`option-${key}`}>\n                  {size.label} ({size.ratio})\n                </SelectItem>\n              ))}\n            </SelectContent>\n          </Select>\n          <Separator orientation=\"vertical\" className=\"h-6 mx-2\" />\n          <Button variant=\"outline\" onClick={handlePreview} data-testid=\"button-preview\">\n            <Eye className=\"h-4 w-4 mr-2\" />\n            {t(\"editor.preview\")}\n          </Button>\n          <Button onClick={handleSave} data-testid=\"button-save\">\n            <Save className=\"h-4 w-4 mr-2\" />\n            {t(\"editor.save\")}\n          </Button>\n        </div>\n      </div>\n\n      <div className=\"flex flex-1 overflow-hidden\">\n        <div className=\"w-14 border-r bg-muted/30 flex flex-col items-center py-2 gap-1\">\n          <Tooltip>\n            <TooltipTrigger asChild>\n              <Button\n                variant={activeTool === 'select' ? 'default' : 'ghost'}\n                size=\"icon\"\n                onClick={() => setActiveTool('select')}\n                data-testid=\"tool-select\"\n              >\n                <MousePointer className=\"h-4 w-4\" />\n              </Button>\n            </TooltipTrigger>\n            <TooltipContent side=\"right\">{t(\"editor.selectTool\")}</TooltipContent>\n          </Tooltip>\n\n          <Tooltip>\n            <TooltipTrigger asChild>\n              <Button\n                variant={activeTool === 'text' ? 'default' : 'ghost'}\n                size=\"icon\"\n                onClick={() => setActiveTool('text')}\n                data-testid=\"tool-text\"\n              >\n                <Type className=\"h-4 w-4\" />\n              </Button>\n            </TooltipTrigger>\n            <TooltipContent side=\"right\">{t(\"editor.textTool\")}</TooltipContent>\n          </Tooltip>\n\n          <Popover>\n            <PopoverTrigger asChild>\n              <Button\n                variant={activeTool === 'shape' ? 'default' : 'ghost'}\n                size=\"icon\"\n                data-testid=\"tool-shape\"\n              >\n                <Square className=\"h-4 w-4\" />\n              </Button>\n            </PopoverTrigger>\n            <PopoverContent side=\"right\" className=\"w-auto p-2\">\n              <div className=\"flex flex-col gap-1\">\n                <Button\n                  variant={activeShapeType === 'rectangle' ? 'secondary' : 'ghost'}\n                  size=\"sm\"\n                  className=\"justify-start\"\n                  onClick={() => { setActiveShapeType('rectangle'); setActiveTool('shape'); }}\n                  data-testid=\"shape-rectangle\"\n                >\n                  <Square className=\"h-4 w-4 mr-2\" />\n                  {t(\"editor.rectangle\")}\n                </Button>\n                <Button\n                  variant={activeShapeType === 'circle' ? 'secondary' : 'ghost'}\n                  size=\"sm\"\n                  className=\"justify-start\"\n                  onClick={() => { setActiveShapeType('circle'); setActiveTool('shape'); }}\n                  data-testid=\"shape-circle\"\n                >\n                  <Circle className=\"h-4 w-4 mr-2\" />\n                  {t(\"editor.circle\")}\n                </Button>\n                <Button\n                  variant={activeShapeType === 'triangle' ? 'secondary' : 'ghost'}\n                  size=\"sm\"\n                  className=\"justify-start\"\n                  onClick={() => { setActiveShapeType('triangle'); setActiveTool('shape'); }}\n                  data-testid=\"shape-triangle\"\n                >\n                  <Triangle className=\"h-4 w-4 mr-2\" />\n                  {t(\"editor.triangle\")}\n                </Button>\n                <Button\n                  variant={activeShapeType === 'line' ? 'secondary' : 'ghost'}\n                  size=\"sm\"\n                  className=\"justify-start\"\n                  onClick={() => { setActiveShapeType('line'); setActiveTool('shape'); }}\n                  data-testid=\"shape-line\"\n                >\n                  <Minus className=\"h-4 w-4 mr-2\" />\n                  {t(\"editor.line\")}\n                </Button>\n              </div>\n            </PopoverContent>\n          </Popover>\n\n          <Tooltip>\n            <TooltipTrigger asChild>\n              <Button\n                variant={activeTool === 'draw' ? 'default' : 'ghost'}\n                size=\"icon\"\n                onClick={() => setActiveTool('draw')}\n                data-testid=\"tool-draw\"\n              >\n                <Pencil className=\"h-4 w-4\" />\n              </Button>\n            </TooltipTrigger>\n            <TooltipContent side=\"right\">{t(\"editor.drawTool\")}</TooltipContent>\n          </Tooltip>\n\n          <Separator className=\"my-2\" />\n\n          <Tooltip>\n            <TooltipTrigger asChild>\n              <Button\n                variant={showHeaderZone ? 'secondary' : 'ghost'}\n                size=\"icon\"\n                onClick={() => setShowHeaderZone(!showHeaderZone)}\n                data-testid=\"toggle-header\"\n              >\n                <PanelTop className=\"h-4 w-4\" />\n              </Button>\n            </TooltipTrigger>\n            <TooltipContent side=\"right\">{t(\"editor.toggleHeader\")}</TooltipContent>\n          </Tooltip>\n\n          <Tooltip>\n            <TooltipTrigger asChild>\n              <Button\n                variant={showFooterZone ? 'secondary' : 'ghost'}\n                size=\"icon\"\n                onClick={() => setShowFooterZone(!showFooterZone)}\n                data-testid=\"toggle-footer\"\n              >\n                <PanelBottom className=\"h-4 w-4\" />\n              </Button>\n            </TooltipTrigger>\n            <TooltipContent side=\"right\">{t(\"editor.toggleFooter\")}</TooltipContent>\n          </Tooltip>\n        </div>\n\n        <div className=\"w-64 border-r flex flex-col bg-background\">\n          <Tabs value={leftPanelTab} onValueChange={setLeftPanelTab} className=\"flex flex-col h-full\">\n            <TabsList className=\"m-2 grid grid-cols-3\">\n              <TabsTrigger value=\"tools\" data-testid=\"tab-tools\">\n                <Palette className=\"h-4 w-4\" />\n              </TabsTrigger>\n              <TabsTrigger value=\"products\" data-testid=\"tab-products\">\n                <Package className=\"h-4 w-4\" />\n              </TabsTrigger>\n              <TabsTrigger value=\"pages\" data-testid=\"tab-pages\">\n                <Layers className=\"h-4 w-4\" />\n              </TabsTrigger>\n            </TabsList>\n\n            <TabsContent value=\"tools\" className=\"flex-1 m-0 overflow-auto\">\n              <ScrollArea className=\"h-[calc(100vh-160px)]\">\n                <div className=\"p-3 space-y-4\">\n                  {activeTool === 'text' && (\n                    <div className=\"space-y-3\">\n                      <p className=\"text-xs font-medium text-muted-foreground uppercase\">{t(\"editor.textOptions\")}</p>\n                      <div>\n                        <Label className=\"text-xs\">{t(\"editor.textColor\")}</Label>\n                        <div className=\"flex flex-wrap gap-1 mt-1\">\n                          {PRESET_COLORS.map((color) => (\n                            <button\n                              key={color}\n                              className={`w-6 h-6 rounded border-2 ${textColor === color ? 'border-primary' : 'border-transparent'}`}\n                              style={{ backgroundColor: color }}\n                              onClick={() => setTextColor(color)}\n                              data-testid={`text-color-${color}`}\n                            />\n                          ))}\n                        </div>\n                        <Input\n                          type=\"color\"\n                          value={textColor}\n                          onChange={(e) => setTextColor(e.target.value)}\n                          className=\"mt-2 h-8 w-full\"\n                          data-testid=\"input-text-color\"\n                        />\n                      </div>\n                      <p className=\"text-sm text-muted-foreground\">{t(\"editor.clickCanvasToAddText\")}</p>\n                    </div>\n                  )}\n\n                  {activeTool === 'shape' && (\n                    <div className=\"space-y-3\">\n                      <p className=\"text-xs font-medium text-muted-foreground uppercase\">{t(\"editor.shapeOptions\")}</p>\n                      <div>\n                        <Label className=\"text-xs\">{t(\"editor.fillColor\")}</Label>\n                        <div className=\"flex flex-wrap gap-1 mt-1\">\n                          {PRESET_COLORS.map((color) => (\n                            <button\n                              key={color}\n                              className={`w-6 h-6 rounded border-2 ${shapeFillColor === color ? 'border-primary' : 'border-transparent'}`}\n                              style={{ backgroundColor: color }}\n                              onClick={() => setShapeFillColor(color)}\n                              data-testid={`fill-color-${color}`}\n                            />\n                          ))}\n                        </div>\n                        <Input\n                          type=\"color\"\n                          value={shapeFillColor}\n                          onChange={(e) => setShapeFillColor(e.target.value)}\n                          className=\"mt-2 h-8 w-full\"\n                          data-testid=\"input-fill-color\"\n                        />\n                      </div>\n                      <div>\n                        <Label className=\"text-xs\">{t(\"editor.strokeColor\")}</Label>\n                        <Input\n                          type=\"color\"\n                          value={shapeStrokeColor}\n                          onChange={(e) => setShapeStrokeColor(e.target.value)}\n                          className=\"h-8 w-full\"\n                          data-testid=\"input-stroke-color\"\n                        />\n                      </div>\n                      <p className=\"text-sm text-muted-foreground\">{t(\"editor.clickCanvasToAddShape\")}</p>\n                    </div>\n                  )}\n\n                  {activeTool === 'draw' && (\n                    <div className=\"space-y-3\">\n                      <p className=\"text-xs font-medium text-muted-foreground uppercase\">{t(\"editor.drawOptions\")}</p>\n                      <div>\n                        <Label className=\"text-xs\">{t(\"editor.brushColor\")}</Label>\n                        <div className=\"flex flex-wrap gap-1 mt-1\">\n                          {PRESET_COLORS.map((color) => (\n                            <button\n                              key={color}\n                              className={`w-6 h-6 rounded border-2 ${drawColor === color ? 'border-primary' : 'border-transparent'}`}\n                              style={{ backgroundColor: color }}\n                              onClick={() => setDrawColor(color)}\n                              data-testid={`draw-color-${color}`}\n                            />\n                          ))}\n                        </div>\n                        <Input\n                          type=\"color\"\n                          value={drawColor}\n                          onChange={(e) => setDrawColor(e.target.value)}\n                          className=\"mt-2 h-8 w-full\"\n                          data-testid=\"input-draw-color\"\n                        />\n                      </div>\n                      <div>\n                        <Label className=\"text-xs\">{t(\"editor.brushSize\")}: {drawStrokeWidth}px</Label>\n                        <Slider\n                          value={[drawStrokeWidth]}\n                          onValueChange={(v) => setDrawStrokeWidth(v[0])}\n                          min={1}\n                          max={20}\n                          step={1}\n                          className=\"mt-1\"\n                          data-testid=\"slider-brush-size\"\n                        />\n                      </div>\n                      <p className=\"text-sm text-muted-foreground\">{t(\"editor.dragToDraw\")}</p>\n                    </div>\n                  )}\n\n                  {activeTool === 'select' && (\n                    <div className=\"space-y-3\">\n                      <p className=\"text-xs font-medium text-muted-foreground uppercase\">{t(\"editor.selectMode\")}</p>\n                      <p className=\"text-sm text-muted-foreground\">{t(\"editor.selectModeHelp\")}</p>\n                    </div>\n                  )}\n\n                  <Separator />\n\n                  <div className=\"space-y-3\">\n                    <p className=\"text-xs font-medium text-muted-foreground uppercase\">{t(\"editor.headerFooter\")}</p>\n                    {showHeaderZone && (\n                      <div>\n                        <Label className=\"text-xs\">{t(\"editor.headerHeight\")}: {headerHeight}px</Label>\n                        <Slider\n                          value={[headerHeight]}\n                          onValueChange={(v) => setHeaderHeight(v[0])}\n                          min={40}\n                          max={200}\n                          step={10}\n                          className=\"mt-1\"\n                          data-testid=\"slider-header-height\"\n                        />\n                      </div>\n                    )}\n                    {showFooterZone && (\n                      <div>\n                        <Label className=\"text-xs\">{t(\"editor.footerHeight\")}: {footerHeight}px</Label>\n                        <Slider\n                          value={[footerHeight]}\n                          onValueChange={(v) => setFooterHeight(v[0])}\n                          min={30}\n                          max={150}\n                          step={10}\n                          className=\"mt-1\"\n                          data-testid=\"slider-footer-height\"\n                        />\n                      </div>\n                    )}\n                  </div>\n                </div>\n              </ScrollArea>\n            </TabsContent>\n\n            <TabsContent value=\"products\" className=\"flex-1 m-0 overflow-hidden\">\n              <div className=\"p-2\">\n                <Input\n                  placeholder={t(\"products.search\")}\n                  value={searchQuery}\n                  onChange={(e) => setSearchQuery(e.target.value)}\n                  data-testid=\"input-search-products\"\n                />\n              </div>\n              <ScrollArea className=\"flex-1 h-[calc(100vh-200px)]\">\n                <div className=\"p-2 space-y-2\">\n                  {loadingProducts || loadingExternalProducts ? (\n                    Array.from({ length: 5 }).map((_, i) => (\n                      <Skeleton key={i} className=\"h-16 w-full\" />\n                    ))\n                  ) : allProducts?.length ? (\n                    allProducts.map((product: any) => (\n                      <div\n                        key={product.id}\n                        draggable\n                        onDragStart={(e) => handleDragStart(e, product)}\n                        className=\"flex items-center gap-2 p-2 rounded-md border bg-card cursor-grab hover-elevate active-elevate-2\"\n                        data-testid={`product-drag-${product.id}`}\n                      >\n                        <div className=\"flex items-center justify-center w-10 h-10 bg-muted rounded flex-shrink-0\">\n                          {product.imageUrl ? (\n                            <img\n                              src={product.imageUrl}\n                              alt={product.name}\n                              className=\"w-full h-full object-cover rounded\"\n                            />\n                          ) : (\n                            <Package className=\"h-5 w-5 text-muted-foreground\" />\n                          )}\n                        </div>\n                        <div className=\"flex-1 min-w-0\">\n                          <p className=\"text-sm font-medium truncate\">{product.name}</p>\n                          <p className=\"text-xs text-muted-foreground\">${product.price}</p>\n                        </div>\n                        <GripVertical className=\"h-4 w-4 text-muted-foreground flex-shrink-0\" />\n                      </div>\n                    ))\n                  ) : (\n                    <div className=\"text-center text-muted-foreground py-8\">\n                      <Package className=\"h-8 w-8 mx-auto mb-2\" />\n                      <p className=\"text-sm\">{t(\"products.noProducts\")}</p>\n                    </div>\n                  )}\n                </div>\n              </ScrollArea>\n            </TabsContent>\n\n            <TabsContent value=\"pages\" className=\"flex-1 m-0\">\n              <div className=\"p-2 space-y-4\">\n                <div className=\"flex items-center justify-between\">\n                  <p className=\"text-sm font-medium\">{t(\"editor.pages\")}</p>\n                  <Button size=\"sm\" variant=\"outline\" onClick={handleAddPage} data-testid=\"button-add-page\">\n                    <Plus className=\"h-4 w-4 mr-1\" />\n                    {t(\"editor.addPage\")}\n                  </Button>\n                </div>\n                <div className=\"space-y-2\">\n                  {Array.from({ length: totalPages }).map((_, i) => (\n                    <div\n                      key={i}\n                      className={`p-2 rounded-md border cursor-pointer hover-elevate ${\n                        currentPage === i + 1 ? \"border-primary bg-primary/5\" : \"\"\n                      }`}\n                      onClick={() => setCurrentPage(i + 1)}\n                      data-testid={`page-${i + 1}`}\n                    >\n                      <div className=\"flex items-center justify-between\">\n                        <span className=\"text-sm\">{t(\"editor.page\")} {i + 1}</span>\n                        {totalPages > 1 && (\n                          <Button\n                            variant=\"ghost\"\n                            size=\"icon\"\n                            onClick={(e) => {\n                              e.stopPropagation();\n                              handleDeletePage();\n                            }}\n                          >\n                            <Trash2 className=\"h-3 w-3\" />\n                          </Button>\n                        )}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            </TabsContent>\n          </Tabs>\n        </div>\n\n        <div className=\"flex-1 bg-muted/50 overflow-auto flex items-center justify-center p-8\">\n          <div\n            ref={canvasRef}\n            className={`bg-white shadow-lg rounded-lg relative ${isDragging ? 'ring-2 ring-primary ring-offset-2' : ''} ${isMovingElement ? 'cursor-grabbing' : ''} ${activeTool === 'draw' ? 'cursor-crosshair' : ''} ${activeTool === 'text' ? 'cursor-text' : ''}`}\n            style={{\n              width: `${scaledCanvasWidth}px`,\n              height: `${scaledCanvasHeight}px`,\n            }}\n            onDrop={handleDrop}\n            onDragOver={handleDragOver}\n            onDragLeave={handleDragLeave}\n            onClick={handleCanvasClick}\n            onMouseDown={handleCanvasMouseDown}\n            onMouseMove={handleCanvasMouseMove}\n            onMouseUp={handleCanvasMouseUp}\n            onMouseLeave={handleCanvasMouseLeave}\n            data-testid=\"canvas\"\n          >\n            {showHeaderZone && (\n              <div\n                className=\"absolute left-0 right-0 top-0 bg-blue-50/50 border-b-2 border-dashed border-blue-300 flex items-center justify-center\"\n                style={{ height: `${scaledHeaderHeight}px` }}\n                data-testid=\"header-zone\"\n              >\n                <span className=\"text-xs text-blue-400 font-medium\">{t(\"editor.headerZone\")}</span>\n              </div>\n            )}\n            \n            {showFooterZone && (\n              <div\n                className=\"absolute left-0 right-0 bottom-0 bg-green-50/50 border-t-2 border-dashed border-green-300 flex items-center justify-center\"\n                style={{ height: `${scaledFooterHeight}px` }}\n                data-testid=\"footer-zone\"\n              >\n                <span className=\"text-xs text-green-400 font-medium\">{t(\"editor.footerZone\")}</span>\n              </div>\n            )}\n\n            {currentPageElements.length === 0 && !isDrawing ? (\n              <div className=\"absolute inset-0 flex items-center justify-center text-muted-foreground pointer-events-none\">\n                <div className=\"text-center\">\n                  <Move className=\"h-12 w-12 mx-auto mb-4\" />\n                  <p className=\"text-lg\">{t(\"editor.canvasEmpty\")}</p>\n                  <p className=\"text-sm mt-2\">{t(\"editor.page\")} {currentPage} / {totalPages}</p>\n                </div>\n              </div>\n            ) : null}\n            \n            {currentPageElements.map((element) => (\n              <div\n                key={element.id}\n                className={`absolute transition-shadow select-none ${\n                  selectedElement === element.id\n                    ? 'ring-2 ring-primary shadow-lg cursor-grab'\n                    : activeTool === 'select' ? 'hover:ring-1 hover:ring-primary/50 cursor-pointer' : ''\n                } ${isMovingElement && selectedElement === element.id ? 'cursor-grabbing' : ''}`}\n                style={{\n                  left: `${(element.x * zoom) / 100 * 0.5}px`,\n                  top: `${(element.y * zoom) / 100 * 0.5}px`,\n                  width: `${(element.width * zoom) / 100 * 0.5}px`,\n                  height: `${(element.height * zoom) / 100 * 0.5}px`,\n                  transform: `rotate(${element.rotation}deg)`,\n                  opacity: element.opacity / 100,\n                }}\n                onMouseDown={(e) => handleElementMouseDown(element.id, e)}\n                data-testid={`canvas-element-${element.id}`}\n              >\n                {renderElement(element)}\n                \n                {selectedElement === element.id && (\n                  <>\n                    <div\n                      className=\"absolute w-3 h-3 bg-primary border-2 border-white rounded-sm cursor-nw-resize\"\n                      style={{ top: -6, left: -6 }}\n                      onMouseDown={(e) => handleResizeMouseDown('nw', e)}\n                    />\n                    <div\n                      className=\"absolute w-3 h-3 bg-primary border-2 border-white rounded-sm cursor-ne-resize\"\n                      style={{ top: -6, right: -6 }}\n                      onMouseDown={(e) => handleResizeMouseDown('ne', e)}\n                    />\n                    <div\n                      className=\"absolute w-3 h-3 bg-primary border-2 border-white rounded-sm cursor-sw-resize\"\n                      style={{ bottom: -6, left: -6 }}\n                      onMouseDown={(e) => handleResizeMouseDown('sw', e)}\n                    />\n                    <div\n                      className=\"absolute w-3 h-3 bg-primary border-2 border-white rounded-sm cursor-se-resize\"\n                      style={{ bottom: -6, right: -6 }}\n                      onMouseDown={(e) => handleResizeMouseDown('se', e)}\n                    />\n                  </>\n                )}\n              </div>\n            ))}\n\n            {isDrawing && drawingPoints.length > 1 && (\n              <svg\n                className=\"absolute inset-0 pointer-events-none\"\n                style={{ width: '100%', height: '100%' }}\n              >\n                <path\n                  d={drawingPoints.reduce((acc, point, i) => {\n                    const x = (point.x * zoom) / 100 * 0.5;\n                    const y = (point.y * zoom) / 100 * 0.5;\n                    if (i === 0) return `M ${x} ${y}`;\n                    return `${acc} L ${x} ${y}`;\n                  }, '')}\n                  fill=\"none\"\n                  stroke={drawColor}\n                  strokeWidth={drawStrokeWidth}\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                />\n              </svg>\n            )}\n          </div>\n        </div>\n\n        <div className=\"w-80 border-l bg-background overflow-auto\">\n          <div className=\"p-4 border-b flex items-center justify-between gap-2\">\n            <h2 className=\"font-medium\">{t(\"editor.properties\")}</h2>\n            {selectedElementData && (\n              <Button\n                variant=\"ghost\"\n                size=\"icon\"\n                onClick={handleDeleteElement}\n                data-testid=\"button-delete-element\"\n              >\n                <Trash2 className=\"h-4 w-4 text-destructive\" />\n              </Button>\n            )}\n          </div>\n          \n          {selectedElementData ? (\n            <ScrollArea className=\"h-[calc(100vh-200px)]\">\n              <div className=\"p-4 space-y-4\">\n                {selectedElementData.type === 'product' && (\n                  <div className=\"p-2 bg-muted rounded-md\">\n                    <p className=\"text-sm font-medium\">{selectedElementData.data.name}</p>\n                    <p className=\"text-xs text-muted-foreground\">${selectedElementData.data.price}</p>\n                  </div>\n                )}\n\n                {selectedElementData.type === 'text' && (\n                  <div className=\"space-y-3\">\n                    <div>\n                      <Label className=\"text-xs\">{t(\"editor.textContent\")}</Label>\n                      <Textarea\n                        value={selectedElementData.data.text}\n                        onChange={(e) => updateElementData('text', e.target.value)}\n                        className=\"mt-1\"\n                        data-testid=\"input-text-content\"\n                      />\n                    </div>\n                    <div>\n                      <Label className=\"text-xs\">{t(\"editor.fontFamily\")}</Label>\n                      <Select\n                        value={selectedElementData.data.fontFamily}\n                        onValueChange={(v) => updateElementData('fontFamily', v)}\n                      >\n                        <SelectTrigger className=\"mt-1\" data-testid=\"select-font-family\">\n                          <SelectValue />\n                        </SelectTrigger>\n                        <SelectContent>\n                          {FONT_FAMILIES.map((font) => (\n                            <SelectItem key={font.value} value={font.value}>\n                              <span style={{ fontFamily: font.value }}>{font.label}</span>\n                            </SelectItem>\n                          ))}\n                        </SelectContent>\n                      </Select>\n                    </div>\n                    <div>\n                      <Label className=\"text-xs\">{t(\"editor.fontSize\")}</Label>\n                      <Select\n                        value={String(selectedElementData.data.fontSize)}\n                        onValueChange={(v) => updateElementData('fontSize', Number(v))}\n                      >\n                        <SelectTrigger className=\"mt-1\" data-testid=\"select-font-size\">\n                          <SelectValue />\n                        </SelectTrigger>\n                        <SelectContent>\n                          {FONT_SIZES.map((size) => (\n                            <SelectItem key={size} value={String(size)}>\n                              {size}px\n                            </SelectItem>\n                          ))}\n                        </SelectContent>\n                      </Select>\n                    </div>\n                    <div className=\"flex items-center gap-1\">\n                      <Button\n                        variant={selectedElementData.data.fontWeight === 'bold' ? 'secondary' : 'ghost'}\n                        size=\"icon\"\n                        onClick={() => updateElementData('fontWeight', selectedElementData.data.fontWeight === 'bold' ? 'normal' : 'bold')}\n                        data-testid=\"button-bold\"\n                      >\n                        <Bold className=\"h-4 w-4\" />\n                      </Button>\n                      <Button\n                        variant={selectedElementData.data.fontStyle === 'italic' ? 'secondary' : 'ghost'}\n                        size=\"icon\"\n                        onClick={() => updateElementData('fontStyle', selectedElementData.data.fontStyle === 'italic' ? 'normal' : 'italic')}\n                        data-testid=\"button-italic\"\n                      >\n                        <Italic className=\"h-4 w-4\" />\n                      </Button>\n                      <Button\n                        variant={selectedElementData.data.textDecoration === 'underline' ? 'secondary' : 'ghost'}\n                        size=\"icon\"\n                        onClick={() => updateElementData('textDecoration', selectedElementData.data.textDecoration === 'underline' ? 'none' : 'underline')}\n                        data-testid=\"button-underline\"\n                      >\n                        <Underline className=\"h-4 w-4\" />\n                      </Button>\n                      <Separator orientation=\"vertical\" className=\"h-6 mx-1\" />\n                      <Button\n                        variant={selectedElementData.data.textAlign === 'left' ? 'secondary' : 'ghost'}\n                        size=\"icon\"\n                        onClick={() => updateElementData('textAlign', 'left')}\n                        data-testid=\"button-align-left\"\n                      >\n                        <AlignLeft className=\"h-4 w-4\" />\n                      </Button>\n                      <Button\n                        variant={selectedElementData.data.textAlign === 'center' ? 'secondary' : 'ghost'}\n                        size=\"icon\"\n                        onClick={() => updateElementData('textAlign', 'center')}\n                        data-testid=\"button-align-center\"\n                      >\n                        <AlignCenter className=\"h-4 w-4\" />\n                      </Button>\n                      <Button\n                        variant={selectedElementData.data.textAlign === 'right' ? 'secondary' : 'ghost'}\n                        size=\"icon\"\n                        onClick={() => updateElementData('textAlign', 'right')}\n                        data-testid=\"button-align-right\"\n                      >\n                        <AlignRight className=\"h-4 w-4\" />\n                      </Button>\n                    </div>\n                    <div>\n                      <Label className=\"text-xs\">{t(\"editor.textColor\")}</Label>\n                      <div className=\"flex items-center gap-2 mt-1\">\n                        <Input\n                          type=\"color\"\n                          value={selectedElementData.data.color}\n                          onChange={(e) => updateElementData('color', e.target.value)}\n                          className=\"h-8 w-12\"\n                          data-testid=\"input-element-text-color\"\n                        />\n                        <Input\n                          value={selectedElementData.data.color}\n                          onChange={(e) => updateElementData('color', e.target.value)}\n                          className=\"flex-1\"\n                        />\n                      </div>\n                    </div>\n                    <div>\n                      <Label className=\"text-xs\">{t(\"editor.backgroundColor\")}</Label>\n                      <div className=\"flex items-center gap-2 mt-1\">\n                        <Input\n                          type=\"color\"\n                          value={selectedElementData.data.backgroundColor === 'transparent' ? '#ffffff' : selectedElementData.data.backgroundColor}\n                          onChange={(e) => updateElementData('backgroundColor', e.target.value)}\n                          className=\"h-8 w-12\"\n                          data-testid=\"input-element-bg-color\"\n                        />\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => updateElementData('backgroundColor', 'transparent')}\n                        >\n                          {t(\"editor.transparent\")}\n                        </Button>\n                      </div>\n                    </div>\n                  </div>\n                )}\n\n                {selectedElementData.type === 'shape' && (\n                  <div className=\"space-y-3\">\n                    <div className=\"p-2 bg-muted rounded-md\">\n                      <p className=\"text-sm font-medium capitalize\">{selectedElementData.data.shapeType}</p>\n                    </div>\n                    <div>\n                      <Label className=\"text-xs\">{t(\"editor.fillColor\")}</Label>\n                      <div className=\"flex items-center gap-2 mt-1\">\n                        <Input\n                          type=\"color\"\n                          value={selectedElementData.data.fill === 'transparent' ? '#ffffff' : selectedElementData.data.fill}\n                          onChange={(e) => updateElementData('fill', e.target.value)}\n                          className=\"h-8 w-12\"\n                          data-testid=\"input-shape-fill\"\n                        />\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => updateElementData('fill', 'transparent')}\n                        >\n                          {t(\"editor.transparent\")}\n                        </Button>\n                      </div>\n                    </div>\n                    <div>\n                      <Label className=\"text-xs\">{t(\"editor.strokeColor\")}</Label>\n                      <Input\n                        type=\"color\"\n                        value={selectedElementData.data.stroke}\n                        onChange={(e) => updateElementData('stroke', e.target.value)}\n                        className=\"h-8 w-full mt-1\"\n                        data-testid=\"input-shape-stroke\"\n                      />\n                    </div>\n                    <div>\n                      <Label className=\"text-xs\">{t(\"editor.strokeWidth\")}: {selectedElementData.data.strokeWidth}px</Label>\n                      <Slider\n                        value={[selectedElementData.data.strokeWidth]}\n                        onValueChange={(v) => updateElementData('strokeWidth', v[0])}\n                        min={0}\n                        max={10}\n                        step={1}\n                        className=\"mt-1\"\n                        data-testid=\"slider-stroke-width\"\n                      />\n                    </div>\n                  </div>\n                )}\n\n                <Separator />\n\n                <div>\n                  <Label className=\"text-xs text-muted-foreground\">{t(\"editor.position\")}</Label>\n                  <div className=\"grid grid-cols-2 gap-2 mt-1\">\n                    <div>\n                      <Label className=\"text-xs\">X</Label>\n                      <Input\n                        type=\"number\"\n                        value={Math.round(selectedElementData.x)}\n                        onChange={(e) => updateElementProperty('x', Number(e.target.value))}\n                        data-testid=\"input-position-x\"\n                      />\n                    </div>\n                    <div>\n                      <Label className=\"text-xs\">Y</Label>\n                      <Input\n                        type=\"number\"\n                        value={Math.round(selectedElementData.y)}\n                        onChange={(e) => updateElementProperty('y', Number(e.target.value))}\n                        data-testid=\"input-position-y\"\n                      />\n                    </div>\n                  </div>\n                </div>\n                <div>\n                  <Label className=\"text-xs text-muted-foreground\">{t(\"editor.size\")}</Label>\n                  <div className=\"grid grid-cols-2 gap-2 mt-1\">\n                    <div>\n                      <Label className=\"text-xs\">{t(\"editor.width\")}</Label>\n                      <Input\n                        type=\"number\"\n                        value={Math.round(selectedElementData.width)}\n                        onChange={(e) => updateElementProperty('width', Number(e.target.value))}\n                        data-testid=\"input-size-width\"\n                      />\n                    </div>\n                    <div>\n                      <Label className=\"text-xs\">{t(\"editor.height\")}</Label>\n                      <Input\n                        type=\"number\"\n                        value={Math.round(selectedElementData.height)}\n                        onChange={(e) => updateElementProperty('height', Number(e.target.value))}\n                        data-testid=\"input-size-height\"\n                      />\n                    </div>\n                  </div>\n                </div>\n                <div>\n                  <Label className=\"text-xs text-muted-foreground\">{t(\"editor.rotation\")}</Label>\n                  <div className=\"flex items-center gap-2 mt-1\">\n                    <Slider\n                      value={[selectedElementData.rotation]}\n                      onValueChange={(v) => updateElementProperty('rotation', v[0])}\n                      max={360}\n                      step={1}\n                      data-testid=\"slider-rotation\"\n                    />\n                    <span className=\"text-sm w-12\">{selectedElementData.rotation}</span>\n                  </div>\n                </div>\n                <div>\n                  <Label className=\"text-xs text-muted-foreground\">{t(\"editor.opacity\")}</Label>\n                  <div className=\"flex items-center gap-2 mt-1\">\n                    <Slider\n                      value={[selectedElementData.opacity]}\n                      onValueChange={(v) => updateElementProperty('opacity', v[0])}\n                      max={100}\n                      step={1}\n                      data-testid=\"slider-opacity\"\n                    />\n                    <span className=\"text-sm w-12\">{selectedElementData.opacity}%</span>\n                  </div>\n                </div>\n              </div>\n            </ScrollArea>\n          ) : (\n            <div className=\"p-4 text-center text-muted-foreground\">\n              <Settings className=\"h-8 w-8 mx-auto mb-2\" />\n              <p className=\"text-sm\">{t(\"editor.selectElementHelp\")}</p>\n            </div>\n          )}\n\n          <Separator />\n\n          <div className=\"p-4\">\n            <h3 className=\"font-medium mb-3\">{t(\"editor.layers\")}</h3>\n            {currentPageElements.length > 0 ? (\n              <div className=\"space-y-1\">\n                {currentPageElements.map((element, index) => (\n                  <div\n                    key={element.id}\n                    className={`flex items-center gap-2 p-2 rounded-md cursor-pointer hover-elevate ${\n                      selectedElement === element.id ? 'bg-primary/10' : ''\n                    }`}\n                    onClick={() => { setSelectedElement(element.id); setActiveTool('select'); }}\n                    data-testid={`layer-${element.id}`}\n                  >\n                    {element.type === 'product' && <Package className=\"h-4 w-4 text-muted-foreground\" />}\n                    {element.type === 'text' && <Type className=\"h-4 w-4 text-muted-foreground\" />}\n                    {element.type === 'shape' && <Square className=\"h-4 w-4 text-muted-foreground\" />}\n                    <span className=\"text-sm flex-1 truncate\">\n                      {element.type === 'product' ? element.data.name : \n                       element.type === 'text' ? element.data.text.substring(0, 20) :\n                       element.data.shapeType}\n                    </span>\n                  </div>\n                ))}\n              </div>\n            ) : (\n              <div className=\"text-center text-muted-foreground py-4\">\n                <Layers className=\"h-6 w-6 mx-auto mb-2\" />\n                <p className=\"text-sm\">{t(\"editor.noLayers\")}</p>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n\n      <Dialog open={showPreview} onOpenChange={setShowPreview}>\n        <DialogContent className=\"max-w-4xl max-h-[90vh] overflow-auto\">\n          <DialogHeader>\n            <DialogTitle>{t(\"editor.preview\")}: {campaignName || t(\"campaigns.untitled\")}</DialogTitle>\n          </DialogHeader>\n          <div className=\"flex justify-center py-4\">\n            <div\n              className=\"bg-white shadow-lg rounded-lg relative\"\n              style={{\n                width: `${CANVAS_SIZES[canvasSize].width * 0.4}px`,\n                height: `${CANVAS_SIZES[canvasSize].height * 0.4}px`,\n              }}\n            >\n              {showHeaderZone && (\n                <div\n                  className=\"absolute left-0 right-0 top-0 bg-blue-50/30\"\n                  style={{ height: `${headerHeight * 0.4}px` }}\n                />\n              )}\n              {showFooterZone && (\n                <div\n                  className=\"absolute left-0 right-0 bottom-0 bg-green-50/30\"\n                  style={{ height: `${footerHeight * 0.4}px` }}\n                />\n              )}\n              {currentPageElements.map((element) => (\n                <div\n                  key={element.id}\n                  className=\"absolute\"\n                  style={{\n                    left: `${element.x * 0.4}px`,\n                    top: `${element.y * 0.4}px`,\n                    width: `${element.width * 0.4}px`,\n                    height: `${element.height * 0.4}px`,\n                    transform: `rotate(${element.rotation}deg)`,\n                    opacity: element.opacity / 100,\n                  }}\n                >\n                  {renderElement(element, true)}\n                </div>\n              ))}\n              {currentPageElements.length === 0 && (\n                <div className=\"absolute inset-0 flex items-center justify-center text-muted-foreground\">\n                  <p className=\"text-sm\">{t(\"editor.emptyCanvas\")}</p>\n                </div>\n              )}\n            </div>\n          </div>\n          <div className=\"flex justify-center gap-2\">\n            {Array.from({ length: totalPages }).map((_, i) => (\n              <Button\n                key={i}\n                variant={currentPage === i + 1 ? \"default\" : \"outline\"}\n                size=\"sm\"\n                onClick={() => setCurrentPage(i + 1)}\n              >\n                {i + 1}\n              </Button>\n            ))}\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      <Dialog open={showSaveDialog} onOpenChange={setShowSaveDialog}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>{t(\"campaigns.saveCampaign\")}</DialogTitle>\n            <DialogDescription>\n              {t(\"campaigns.enterCampaignName\")}\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"py-4\">\n            <Label htmlFor=\"campaign-name\">{t(\"campaigns.campaignName\")}</Label>\n            <Input\n              id=\"campaign-name\"\n              value={tempCampaignName}\n              onChange={(e) => setTempCampaignName(e.target.value)}\n              placeholder={t(\"campaigns.enterName\")}\n              className=\"mt-2\"\n              data-testid=\"input-campaign-name\"\n              autoFocus\n              onKeyDown={(e) => {\n                if (e.key === \"Enter\") {\n                  handleSaveDialogConfirm();\n                }\n              }}\n            />\n          </div>\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => setShowSaveDialog(false)} data-testid=\"button-cancel-save\">\n              {t(\"common.cancel\")}\n            </Button>\n            <Button onClick={handleSaveDialogConfirm} data-testid=\"button-confirm-save\">\n              <Save className=\"h-4 w-4 mr-2\" />\n              {t(\"editor.save\")}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","path":null,"size_bytes":73809,"size_tokens":null},"server/vite.ts":{"content":"import { type Express } from \"express\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport async function setupVite(server: Server, app: Express) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server, path: \"/vite-hmr\" },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n","path":null,"size_bytes":1534,"size_tokens":null},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","path":null,"size_bytes":4885,"size_tokens":null},"client/src/pages/users.tsx":{"content":"import { useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { \n  Plus, \n  Search, \n  MoreVertical,\n  Edit,\n  Trash2,\n  Mail,\n  Shield,\n  User as UserIcon,\n  UserPlus,\n  Check,\n  X,\n  Clock,\n  Loader2,\n  Copy,\n  Building2\n} from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport {\n  Tabs,\n  TabsContent,\n  TabsList,\n  TabsTrigger,\n} from \"@/components/ui/tabs\";\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n} from \"@/components/ui/card\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { useAuth } from \"@/lib/auth-context\";\nimport type { User } from \"@shared/schema\";\n\ninterface JoinRequestWithUser {\n  id: string;\n  userId: string;\n  tenantId: string;\n  status: string;\n  message: string | null;\n  createdAt: string;\n  user: { id: string; email: string; firstName: string; lastName: string } | null;\n}\n\ninterface TenantInfo {\n  id: string;\n  name: string;\n  slug: string;\n  code: string | null;\n  logoUrl: string | null;\n}\n\nconst userFormSchema = z.object({\n  email: z.string().email(\"Invalid email address\"),\n  firstName: z.string().min(1, \"First name is required\"),\n  lastName: z.string().min(1, \"Last name is required\"),\n  role: z.enum([\"super_admin\", \"tenant_admin\", \"tenant_user\"]),\n  mobilePhone: z.string().optional(),\n});\n\ntype UserFormValues = z.infer<typeof userFormSchema>;\n\nexport default function UsersPage() {\n  const { t } = useTranslation();\n  const { toast } = useToast();\n  const { user: currentUser } = useAuth();\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [roleFilter, setRoleFilter] = useState<string>(\"all\");\n  const [dialogOpen, setDialogOpen] = useState(false);\n  const [deleteDialogOpen, setDeleteDialogOpen] = useState(false);\n  const [editingUser, setEditingUser] = useState<User | null>(null);\n  const [selectedUser, setSelectedUser] = useState<User | null>(null);\n\n  const isAdmin = currentUser?.role === \"tenant_admin\" || currentUser?.role === \"super_admin\";\n\n  const form = useForm<UserFormValues>({\n    resolver: zodResolver(userFormSchema),\n    defaultValues: {\n      email: \"\",\n      firstName: \"\",\n      lastName: \"\",\n      role: \"tenant_user\",\n      mobilePhone: \"\",\n    },\n  });\n\n  const { data: users, isLoading } = useQuery<User[]>({\n    queryKey: [\"/api/users\"],\n  });\n\n  const { data: tenantInfo } = useQuery<TenantInfo>({\n    queryKey: [\"/api/tenant/current\"],\n  });\n\n  const { data: joinRequests, isLoading: isLoadingJoinRequests } = useQuery<JoinRequestWithUser[]>({\n    queryKey: [\"/api/join-requests\"],\n    enabled: isAdmin,\n  });\n\n  const copyTenantCode = () => {\n    if (tenantInfo?.code) {\n      navigator.clipboard.writeText(tenantInfo.code);\n      toast({\n        title: t(\"common.success\"),\n        description: \"Organization code copied to clipboard!\",\n      });\n    }\n  };\n\n  const approveMutation = useMutation({\n    mutationFn: async (requestId: string) => {\n      return apiRequest(\"POST\", `/api/join-requests/${requestId}/approve`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/join-requests\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/users\"] });\n      toast({\n        title: t(\"common.success\"),\n        description: \"Join request approved. User has been added to the organization.\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: t(\"common.error\"),\n        description: error.message || \"Failed to approve request\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const rejectMutation = useMutation({\n    mutationFn: async (requestId: string) => {\n      return apiRequest(\"POST\", `/api/join-requests/${requestId}/reject`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/join-requests\"] });\n      toast({\n        title: t(\"common.success\"),\n        description: \"Join request rejected.\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: t(\"common.error\"),\n        description: error.message || \"Failed to reject request\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const filteredUsers = users?.filter((user) => {\n    const matchesSearch =\n      user.email.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      user.firstName.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      user.lastName.toLowerCase().includes(searchQuery.toLowerCase());\n    const matchesRole = roleFilter === \"all\" || user.role === roleFilter;\n    return matchesSearch && matchesRole;\n  });\n\n  const createMutation = useMutation({\n    mutationFn: async (data: UserFormValues) => {\n      return apiRequest(\"/api/users/invite\", {\n        method: \"POST\",\n        body: JSON.stringify(data),\n      });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/users\"] });\n      setDialogOpen(false);\n      form.reset();\n      toast({\n        title: t(\"common.success\"),\n        description: \"Invitation sent successfully.\",\n      });\n    },\n    onError: () => {\n      toast({\n        title: t(\"common.error\"),\n        description: t(\"errors.somethingWentWrong\"),\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const getRoleBadgeVariant = (role: string) => {\n    switch (role) {\n      case \"super_admin\":\n        return \"default\";\n      case \"tenant_admin\":\n        return \"secondary\";\n      default:\n        return \"outline\";\n    }\n  };\n\n  const getRoleLabel = (role: string) => {\n    switch (role) {\n      case \"super_admin\":\n        return t(\"users.superAdmin\");\n      case \"tenant_admin\":\n        return t(\"users.tenantAdmin\");\n      default:\n        return t(\"users.tenantUser\");\n    }\n  };\n\n  const handleAddUser = () => {\n    setEditingUser(null);\n    form.reset({\n      email: \"\",\n      firstName: \"\",\n      lastName: \"\",\n      role: \"tenant_user\",\n      mobilePhone: \"\",\n    });\n    setDialogOpen(true);\n  };\n\n  const handleEditUser = (user: User) => {\n    setEditingUser(user);\n    form.reset({\n      email: user.email,\n      firstName: user.firstName,\n      lastName: user.lastName,\n      role: user.role as \"tenant_admin\" | \"tenant_user\",\n      mobilePhone: user.mobilePhone || \"\",\n    });\n    setDialogOpen(true);\n  };\n\n  const handleDeleteUser = (user: User) => {\n    setSelectedUser(user);\n    setDeleteDialogOpen(true);\n  };\n\n  const confirmDelete = () => {\n    setDeleteDialogOpen(false);\n    setSelectedUser(null);\n    toast({\n      title: t(\"common.success\"),\n      description: \"User deleted successfully.\",\n    });\n  };\n\n  const onSubmit = (data: UserFormValues) => {\n    createMutation.mutate(data);\n  };\n\n  const pendingRequestsCount = joinRequests?.length || 0;\n\n  return (\n    <div className=\"flex flex-col h-full\">\n      <div className=\"flex items-center justify-between gap-4 p-6 border-b\">\n        <h1 className=\"text-2xl font-semibold\" data-testid=\"text-page-title\">\n          {t(\"users.title\")}\n        </h1>\n        <Button onClick={handleAddUser} data-testid=\"button-add-user\">\n          <Plus className=\"h-4 w-4 mr-2\" />\n          {t(\"users.inviteUser\")}\n        </Button>\n      </div>\n\n      {tenantInfo?.code && (\n        <div className=\"px-6 py-4 border-b bg-muted/30\">\n          <div className=\"flex items-center justify-between gap-4 flex-wrap\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"flex h-10 w-10 items-center justify-center rounded-full bg-primary/10\">\n                <Building2 className=\"h-5 w-5 text-primary\" />\n              </div>\n              <div>\n                <p className=\"text-sm text-muted-foreground\">Organization Invite Code</p>\n                <p className=\"font-mono text-lg font-semibold tracking-wider\" data-testid=\"text-tenant-code\">\n                  {tenantInfo.code}\n                </p>\n              </div>\n            </div>\n            <Button variant=\"outline\" size=\"sm\" onClick={copyTenantCode} data-testid=\"button-copy-code\">\n              <Copy className=\"h-4 w-4 mr-2\" />\n              Copy Code\n            </Button>\n          </div>\n          <p className=\"text-xs text-muted-foreground mt-2\">\n            Share this code with new users so they can request to join your organization.\n          </p>\n        </div>\n      )}\n\n      <Tabs defaultValue=\"users\" className=\"flex-1 flex flex-col\">\n        <div className=\"border-b px-6 pt-2\">\n          <TabsList>\n            <TabsTrigger value=\"users\" data-testid=\"tab-users\">\n              <UserIcon className=\"h-4 w-4 mr-2\" />\n              Team Members\n            </TabsTrigger>\n            {isAdmin && (\n              <TabsTrigger value=\"requests\" data-testid=\"tab-join-requests\">\n                <UserPlus className=\"h-4 w-4 mr-2\" />\n                Join Requests\n                {pendingRequestsCount > 0 && (\n                  <Badge variant=\"secondary\" className=\"ml-2\">{pendingRequestsCount}</Badge>\n                )}\n              </TabsTrigger>\n            )}\n          </TabsList>\n        </div>\n\n        <TabsContent value=\"users\" className=\"flex-1 flex flex-col m-0\">\n          <div className=\"flex items-center gap-4 p-4 border-b\">\n            <div className=\"relative flex-1 max-w-sm\">\n              <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n              <Input\n                placeholder={t(\"common.search\")}\n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n                className=\"pl-9\"\n                data-testid=\"input-search-users\"\n              />\n            </div>\n            <Select value={roleFilter} onValueChange={setRoleFilter}>\n              <SelectTrigger className=\"w-[180px]\" data-testid=\"select-role-filter\">\n                <SelectValue placeholder={t(\"users.role\")} />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">{t(\"common.all\")}</SelectItem>\n                <SelectItem value=\"tenant_admin\">{t(\"users.tenantAdmin\")}</SelectItem>\n                <SelectItem value=\"tenant_user\">{t(\"users.tenantUser\")}</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n\n          <div className=\"flex-1 overflow-auto p-6\">\n            {isLoading ? (\n              <div className=\"space-y-2\">\n                {Array.from({ length: 5 }).map((_, i) => (\n                  <Skeleton key={i} className=\"h-16 w-full\" />\n                ))}\n              </div>\n            ) : !filteredUsers?.length ? (\n              <div className=\"flex flex-col items-center justify-center h-64 text-muted-foreground\">\n                <UserIcon className=\"h-12 w-12 mb-4\" />\n                <p>{t(\"users.noUsers\")}</p>\n                <Button className=\"mt-4\" onClick={handleAddUser} data-testid=\"button-first-user\">\n                  <Plus className=\"h-4 w-4 mr-2\" />\n                  {t(\"users.inviteUser\")}\n                </Button>\n              </div>\n            ) : (\n              <Table>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead>{t(\"common.name\")}</TableHead>\n                    <TableHead>{t(\"auth.email\")}</TableHead>\n                    <TableHead>{t(\"users.role\")}</TableHead>\n                    <TableHead>{t(\"common.status\")}</TableHead>\n                    <TableHead className=\"text-right\">{t(\"common.actions\")}</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {filteredUsers.map((user) => (\n                    <TableRow key={user.id} data-testid={`row-user-${user.id}`}>\n                      <TableCell>\n                        <div className=\"flex items-center gap-3\">\n                          <Avatar className=\"h-9 w-9\">\n                            <AvatarFallback className=\"text-xs\">\n                              {user.firstName?.[0]}{user.lastName?.[0]}\n                            </AvatarFallback>\n                          </Avatar>\n                          <span className=\"font-medium\">\n                            {user.firstName} {user.lastName}\n                          </span>\n                        </div>\n                      </TableCell>\n                      <TableCell>{user.email}</TableCell>\n                      <TableCell>\n                        <Badge variant={getRoleBadgeVariant(user.role)}>\n                          <Shield className=\"h-3 w-3 mr-1\" />\n                          {getRoleLabel(user.role)}\n                        </Badge>\n                      </TableCell>\n                      <TableCell>\n                        <Badge variant={user.isActive ? \"default\" : \"secondary\"}>\n                          {user.isActive ? t(\"users.active\") : t(\"users.inactive\")}\n                        </Badge>\n                      </TableCell>\n                      <TableCell className=\"text-right\">\n                        <DropdownMenu>\n                          <DropdownMenuTrigger asChild>\n                            <Button variant=\"ghost\" size=\"icon\" data-testid={`button-user-menu-${user.id}`}>\n                              <MoreVertical className=\"h-4 w-4\" />\n                            </Button>\n                          </DropdownMenuTrigger>\n                          <DropdownMenuContent align=\"end\">\n                            <DropdownMenuItem onClick={() => handleEditUser(user)}>\n                              <Edit className=\"h-4 w-4 mr-2\" />\n                              {t(\"users.editUser\")}\n                            </DropdownMenuItem>\n                            <DropdownMenuItem>\n                              <Mail className=\"h-4 w-4 mr-2\" />\n                              Resend Invitation\n                            </DropdownMenuItem>\n                            <DropdownMenuSeparator />\n                            <DropdownMenuItem\n                              className=\"text-destructive\"\n                              onClick={() => handleDeleteUser(user)}\n                            >\n                              <Trash2 className=\"h-4 w-4 mr-2\" />\n                              {t(\"users.deleteUser\")}\n                            </DropdownMenuItem>\n                          </DropdownMenuContent>\n                        </DropdownMenu>\n                      </TableCell>\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n            )}\n          </div>\n        </TabsContent>\n\n        {isAdmin && (\n          <TabsContent value=\"requests\" className=\"flex-1 overflow-auto p-6 m-0\">\n            {isLoadingJoinRequests ? (\n              <div className=\"flex justify-center py-8\">\n                <Loader2 className=\"h-6 w-6 animate-spin text-muted-foreground\" />\n              </div>\n            ) : !joinRequests?.length ? (\n              <Card>\n                <CardContent className=\"flex flex-col items-center justify-center py-12\">\n                  <UserPlus className=\"h-12 w-12 text-muted-foreground mb-4\" />\n                  <h3 className=\"font-medium text-lg mb-1\">No pending requests</h3>\n                  <p className=\"text-muted-foreground text-sm text-center\">\n                    When someone requests to join your organization, it will appear here.\n                  </p>\n                </CardContent>\n              </Card>\n            ) : (\n              <div className=\"space-y-4\">\n                <Card>\n                  <CardHeader>\n                    <CardTitle className=\"text-lg\">Pending Join Requests</CardTitle>\n                    <CardDescription>\n                      Review and approve or reject requests from users who want to join your organization.\n                    </CardDescription>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"space-y-3\">\n                      {joinRequests.map((request) => (\n                        <div \n                          key={request.id} \n                          className=\"flex items-start justify-between p-4 rounded-md border bg-card\"\n                          data-testid={`join-request-admin-${request.id}`}\n                        >\n                          <div className=\"flex items-start gap-3\">\n                            <Avatar className=\"h-10 w-10\">\n                              <AvatarFallback>\n                                {request.user?.firstName?.[0]}{request.user?.lastName?.[0]}\n                              </AvatarFallback>\n                            </Avatar>\n                            <div>\n                              <p className=\"font-medium\">\n                                {request.user?.firstName} {request.user?.lastName}\n                              </p>\n                              <p className=\"text-sm text-muted-foreground\">\n                                {request.user?.email}\n                              </p>\n                              {request.message && (\n                                <p className=\"text-sm mt-2 text-muted-foreground italic\">\n                                  \"{request.message}\"\n                                </p>\n                              )}\n                              <div className=\"flex items-center gap-2 mt-2 text-xs text-muted-foreground\">\n                                <Clock className=\"h-3 w-3\" />\n                                <span>Requested {new Date(request.createdAt).toLocaleDateString()}</span>\n                              </div>\n                            </div>\n                          </div>\n                          <div className=\"flex items-center gap-2\">\n                            <Button\n                              size=\"sm\"\n                              variant=\"outline\"\n                              onClick={() => rejectMutation.mutate(request.id)}\n                              disabled={rejectMutation.isPending || approveMutation.isPending}\n                              data-testid={`button-reject-${request.id}`}\n                            >\n                              {rejectMutation.isPending ? (\n                                <Loader2 className=\"h-4 w-4 animate-spin\" />\n                              ) : (\n                                <X className=\"h-4 w-4\" />\n                              )}\n                            </Button>\n                            <Button\n                              size=\"sm\"\n                              onClick={() => approveMutation.mutate(request.id)}\n                              disabled={approveMutation.isPending || rejectMutation.isPending}\n                              data-testid={`button-approve-${request.id}`}\n                            >\n                              {approveMutation.isPending ? (\n                                <Loader2 className=\"h-4 w-4 animate-spin\" />\n                              ) : (\n                                <Check className=\"h-4 w-4 mr-1\" />\n                              )}\n                              Approve\n                            </Button>\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n                  </CardContent>\n                </Card>\n              </div>\n            )}\n          </TabsContent>\n        )}\n      </Tabs>\n\n      <Dialog open={dialogOpen} onOpenChange={setDialogOpen}>\n        <DialogContent className=\"sm:max-w-md\">\n          <DialogHeader>\n            <DialogTitle>\n              {editingUser ? t(\"users.editUser\") : t(\"users.inviteUser\")}\n            </DialogTitle>\n            <DialogDescription>\n              {editingUser\n                ? \"Update user information\"\n                : \"Send an invitation to add a new team member\"}\n            </DialogDescription>\n          </DialogHeader>\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n              <div className=\"grid grid-cols-2 gap-4\">\n                <FormField\n                  control={form.control}\n                  name=\"firstName\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>{t(\"auth.firstName\")}</FormLabel>\n                      <FormControl>\n                        <Input {...field} data-testid=\"input-user-first-name\" />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <FormField\n                  control={form.control}\n                  name=\"lastName\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>{t(\"auth.lastName\")}</FormLabel>\n                      <FormControl>\n                        <Input {...field} data-testid=\"input-user-last-name\" />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n              <FormField\n                control={form.control}\n                name=\"email\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>{t(\"auth.email\")}</FormLabel>\n                    <FormControl>\n                      <Input\n                        {...field}\n                        type=\"email\"\n                        disabled={!!editingUser}\n                        data-testid=\"input-user-email\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <FormField\n                control={form.control}\n                name=\"role\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>{t(\"users.role\")}</FormLabel>\n                    <Select onValueChange={field.onChange} value={field.value}>\n                      <FormControl>\n                        <SelectTrigger data-testid=\"select-user-role\">\n                          <SelectValue placeholder=\"Select role\" />\n                        </SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        {currentUser?.role === \"super_admin\" && (\n                          <SelectItem value=\"super_admin\">{t(\"users.superAdmin\")}</SelectItem>\n                        )}\n                        <SelectItem value=\"tenant_admin\">{t(\"users.tenantAdmin\")}</SelectItem>\n                        <SelectItem value=\"tenant_user\">{t(\"users.tenantUser\")}</SelectItem>\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <FormField\n                control={form.control}\n                name=\"mobilePhone\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>{t(\"auth.mobilePhone\")}</FormLabel>\n                    <FormControl>\n                      <Input {...field} data-testid=\"input-user-phone\" />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <DialogFooter>\n                <Button type=\"button\" variant=\"outline\" onClick={() => setDialogOpen(false)}>\n                  {t(\"common.cancel\")}\n                </Button>\n                <Button type=\"submit\" disabled={createMutation.isPending} data-testid=\"button-save-user\">\n                  {createMutation.isPending\n                    ? t(\"common.loading\")\n                    : editingUser\n                    ? t(\"common.update\")\n                    : t(\"users.inviteUser\")}\n                </Button>\n              </DialogFooter>\n            </form>\n          </Form>\n        </DialogContent>\n      </Dialog>\n\n      <Dialog open={deleteDialogOpen} onOpenChange={setDeleteDialogOpen}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>{t(\"users.deleteUser\")}</DialogTitle>\n            <DialogDescription>\n              Are you sure you want to delete this user? This action cannot be undone.\n            </DialogDescription>\n          </DialogHeader>\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => setDeleteDialogOpen(false)}>\n              {t(\"common.cancel\")}\n            </Button>\n            <Button variant=\"destructive\" onClick={confirmDelete} data-testid=\"button-confirm-delete\">\n              {t(\"common.delete\")}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","path":null,"size_bytes":25638,"size_tokens":null},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","path":null,"size_bytes":166,"size_tokens":null},"design_guidelines.md":{"content":"# e-Brochure Design Guidelines\n\n## Design Approach: Enterprise SaaS System\n\n**Selected Approach:** Design System (Fluent Design inspired)\n**Justification:** This is a utility-focused enterprise SaaS platform requiring efficiency, data density, and professional credibility. The multi-tenant architecture and complex workflows (canvas editor, campaign management, analytics dashboards) demand consistency and scalability over visual experimentation.\n\n**Design Principles:**\n- Clarity and efficiency in complex workflows\n- Professional, trustworthy aesthetic for B2B audience\n- Scannable information hierarchy for data-heavy interfaces\n- Consistent patterns across authentication, dashboards, and management interfaces\n\n---\n\n## Typography System\n\n**Font Stack:** \n- Primary: Inter (Google Fonts) - for UI elements, body text\n- Monospace: JetBrains Mono - for codes, API configs\n\n**Hierarchy:**\n- Display: text-4xl to text-5xl, font-semibold (Dashboard headlines, page headers)\n- Heading 1: text-3xl, font-semibold (Section titles)\n- Heading 2: text-2xl, font-semibold (Card headers, modal titles)\n- Heading 3: text-xl, font-medium (Subsections, list headers)\n- Body Large: text-base, font-normal (Primary content)\n- Body: text-sm, font-normal (Table cells, descriptions)\n- Small: text-xs, font-medium (Labels, metadata)\n\n---\n\n## Layout & Spacing System\n\n**Tailwind Spacing Units:** Standardize on 2, 4, 6, 8, 12, 16, 20, 24\n- Micro spacing (components): p-2, gap-2, m-2\n- Standard spacing (cards, sections): p-4, p-6, gap-4\n- Major spacing (page sections): p-8, py-12, gap-8\n- Large spacing (page separators): py-16, py-20, gap-16\n\n**Grid System:**\n- Container: max-w-7xl mx-auto px-4 md:px-6 lg:px-8\n- Dashboard layouts: 12-column grid (grid-cols-12)\n- Card grids: grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\n\n---\n\n## Component Library\n\n### Authentication Pages (Login, Register, 2FA, Password Reset)\n\n**Layout:** Centered card approach\n- Split-screen: Left 40% = branding/messaging, Right 60% = form\n- Card: max-w-md centered with shadow-lg, rounded-lg, p-8\n- Form elements: Full-width inputs, vertical stacking, gap-6\n- Primary CTA: w-full button at bottom\n- Links: Subtle text-sm below form (Register, Forgot Password)\n- Captcha: Integrated above submit button\n\n**2FA Page:**\n- QR code display: Centered, bordered container\n- TOTP input: Large text-center input for 6-digit code\n- Backup codes: Grid display with copy functionality\n\n### Subscription Selection\n\n**Layout:** Three-column pricing cards (grid-cols-1 md:grid-cols-3 gap-6)\n- Card structure: Border, shadow-md, rounded-lg, p-8, hover:shadow-xl transition\n- Plan header: Plan name (text-xl), price (text-4xl font-bold), billing period\n- Features list: Checkmark icons (Heroicons) + text-sm, vertical stack\n- CTA button: w-full, positioned at card bottom\n- Highlight popular: Border accent, \"Most Popular\" badge\n\n### Navigation\n\n**Top Navigation Bar:**\n- Fixed header: sticky top-0, h-16, border-b\n- Left: Logo + app name\n- Center: Main navigation (Dashboard, Products, Templates, Campaigns, etc.)\n- Right: Language selector, notifications icon, user avatar + dropdown\n- Responsive: Hamburger menu for mobile (< md)\n\n**Sidebar Navigation (for data-heavy pages):**\n- Fixed left sidebar: w-64, h-screen, border-r\n- Collapsible on tablet: Hamburger toggle\n- Navigation items: py-3 px-4, icon + label, active state with subtle background\n- Role indicator: Badge showing Super Admin/Tenant Admin/User at bottom\n\n### Dashboard\n\n**Layout:** Multi-widget grid\n- Stats cards row: grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\n  - Each card: p-6, rounded-lg, shadow\n  - Icon + metric value (text-3xl) + label + change indicator\n- Charts section: grid-cols-1 lg:grid-cols-2 gap-6\n  - Chart containers: p-6, rounded-lg, shadow, min-h-[400px]\n- Recent activity: Full-width table or list below charts\n\n### Products Page\n\n**Layout:** Filterable data table\n- Filter bar: Top section with search input, category dropdowns, tenant filter (Super Admin), Add Product button\n- Product grid/table: \n  - Grid view: grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4\n  - Table view: Striped rows, sortable columns, action buttons\n- Product card: Image thumbnail, name, category, price, edit/delete actions\n- Bulk actions: Checkbox selection, toolbar appears when items selected\n\n### Template Management\n\n**Layout:** Template library + editor preview\n- Left sidebar (w-80): Template list with thumbnails, filter by type\n- Main area: Template preview + metadata form\n- Template cards: Thumbnail preview, template name, type badge, actions\n- Form: Vertical layout with sections (General, Cover Page, Inner Pages, Styling)\n- Live preview: Canvas simulation showing template applied to sample content\n\n### Canvas Brochure Editor\n\n**Layout:** Full-screen canvas interface\n- Top toolbar: fixed, contains save, undo/redo, template selector, page navigation, share\n- Left sidebar (w-72): Products panel with search, drag-and-drop product cards\n- Center: Canvas workspace (variable dimensions based on template)\n  - Grid overlay for alignment\n  - Zoom controls (bottom-right floating)\n  - Page thumbnails (left column for multi-page)\n- Right sidebar (w-80): Element properties (position, size, price display settings)\n- Product elements: Draggable, resizable, with automatic price tag insertion\n\n### Campaign Management\n\n**Layout:** Campaign list + detail view\n- List view: Table or card grid\n  - Columns: Campaign name, template, status (badge), date range, actions\n  - Filters: Status, date range, search\n- Detail view (modal or full page):\n  - Campaign header: Name, status, dates\n  - Brochure preview: Rendered pages\n  - Sharing section: Social media integration buttons, sharing history\n  - Edit button: Opens canvas editor with campaign data\n\n### Messages System\n\n**Layout:** Two-panel messaging interface\n- Left panel (w-80): Conversation list with avatars, names, last message preview\n- Right panel: Active conversation\n  - Header: Recipient info\n  - Message thread: Scrollable, alternating sender alignment\n  - Compose area: Textarea + send button at bottom\n\n### Account Page\n\n**Layout:** Tabbed interface\n- Tabs: Profile, Subscription, Security\n- Profile tab: Form with email, name, phone fields\n- Subscription tab: Plan details card, billing history table, upgrade/downgrade CTAs\n- Two-column layout for forms: Label left, input right (on desktop)\n\n---\n\n## Icon System\n\n**Library:** Heroicons (CDN link)\n- Use outline variant for navigation, actions\n- Use solid variant for filled states, selected items\n- Size: w-5 h-5 for inline icons, w-6 h-6 for standalone, w-8 h-8 for feature icons\n\n---\n\n## Animations\n\n**Minimal, purposeful motion:**\n- Page transitions: None (instant)\n- Hover states: transition-all duration-150 (subtle scale/shadow)\n- Modal appearance: fade-in only, duration-200\n- Toast notifications: slide-in-right, duration-300\n- No canvas element animations during editing\n\n---\n\n## Images\n\n**Usage Strategy:**\n- Authentication pages: Subtle abstract background pattern on left panel (geometric/gradient)\n- No hero images - this is a functional SaaS application\n- Product thumbnails: Square aspect ratio, object-cover\n- Template previews: Actual brochure renderings\n- Tutorial section: Video thumbnails, PDF icons\n\n---\n\n## Responsive Behavior\n\n**Breakpoints:**\n- Mobile (< 768px): Single column, stacked navigation, full-width cards\n- Tablet (768px - 1024px): Two-column grids, collapsible sidebars\n- Desktop (> 1024px): Full multi-column layouts, persistent sidebars\n\n**Canvas Editor:** Minimum viewport warning for screens < 1024px, recommend desktop use","path":null,"size_bytes":7610,"size_tokens":null},"replit.md":{"content":"# e-Brochure\n\n## Overview\n\ne-Brochure is a multi-tenant SaaS application for creating digital brochures and promotional posters. Users can dynamically design brochures on a canvas interface, manage products with automatic pricing, organize campaigns, and share content to social media platforms. The platform features a subscription-based model with iyzico payment integration and supports three user roles: Super Admin, Tenant Admin, and Tenant User.\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Frontend Architecture\n- **Framework**: React with TypeScript using Vite as the build tool\n- **Routing**: Wouter for lightweight client-side routing\n- **State Management**: TanStack React Query for server state management\n- **UI Components**: shadcn/ui component library built on Radix UI primitives\n- **Styling**: Tailwind CSS with CSS variables for theming (light/dark mode support)\n- **Forms**: React Hook Form with Zod validation\n- **Internationalization**: i18next for multi-language support (English, Turkish, German)\n\n### Backend Architecture\n- **Runtime**: Node.js with Express.js\n- **Language**: TypeScript with ESM modules\n- **API Design**: RESTful API endpoints under `/api` prefix\n- **Session Management**: Express sessions with JWT tokens for authentication\n- **Security**: bcryptjs for password hashing, speakeasy for TOTP-based 2FA\n\n### Data Storage\n- **Database**: PostgreSQL\n- **ORM**: Drizzle ORM with drizzle-kit for migrations\n- **Schema Location**: `shared/schema.ts` contains all table definitions and Zod validation schemas\n- **Key Entities**: Users, Tenants, Subscriptions, Products, Templates, Campaigns, Messages, Suggestions, Tutorials, System Config\n\n### Authentication & Authorization\n- **Authentication Flow**: Email/password login with mandatory TOTP-based 2FA\n- **Account Activation**: Email verification required after registration\n- **Password Reset**: Time-limited reset tokens (3 hours validity)\n- **Role-Based Access**: Three roles with hierarchical permissions\n  - Super Admin: Full system access, can manage all tenants\n  - Tenant Admin: Full access within their tenant\n  - Tenant User: Limited access within their tenant\n\n### Multi-Tenancy\n- Tenant isolation at the database level via `tenantId` foreign keys\n- Each tenant has their own users, products, templates, and campaigns\n- Super Admin can switch between tenants for management purposes\n- **Organization Codes**: Each tenant has a unique 8-character code for user invitations\n- **Join Requests**: Users can request to join organizations using tenant codes\n  - Admins can approve or reject requests from the Team Members page\n  - Approved users are automatically added as tenant_user role\n\n### Build System\n- **Development**: Vite dev server with HMR\n- **Production**: Custom build script (`script/build.ts`) using esbuild for server bundling and Vite for client\n- **Output**: Server compiled to `dist/index.cjs`, client assets to `dist/public`\n\n## External Dependencies\n\n### Payment Gateway\n- **iyzico**: Turkish payment gateway for subscription payments\n- Configuration managed via Super Admin interface\n\n### Database\n- **PostgreSQL**: Primary data store\n- Connection via `DATABASE_URL` environment variable\n\n### Email Service\n- **Nodemailer**: For sending activation emails, password reset links, and notifications\n- **Configuration**: Uses SMTP credentials stored as secrets (NOT Replit integration)\n  - Required secrets: `SMTP_HOST`, `SMTP_PORT`, `SMTP_USER`, `SMTP_PASS`, `SMTP_FROM`, `APP_URL`\n  - If SMTP is not configured, activation URLs will be logged to console for testing\n\n### Authentication Libraries\n- **speakeasy**: TOTP generation and verification for 2FA\n- **jsonwebtoken**: JWT token generation and validation\n\n### AI Services (Optional)\n- **OpenAI** and **Google Generative AI**: Listed as dependencies for potential AI features\n\n### Social Media Integration\n- Designed for sharing campaigns to Instagram and Facebook (implementation pending)\n\n### Product Connectors\n- **Dynamic Product Search**: Super Admins can configure external API connectors to fetch products in real-time\n- **Configuration Options**: Request method, URL, headers, parameters, and body\n- **Response Parsing**: JSONPath-like syntax to extract product arrays from API responses\n- **Field Mappings**: Map API response fields to product properties (name, image, price, sku)\n- **Campaign Integration**: Campaign editor combines local products with external search results\n- **Test Functionality**: Test connectors with sample queries before enabling","path":null,"size_bytes":4594,"size_tokens":null},"client/src/lib/theme-provider.tsx":{"content":"import { createContext, useContext, useEffect, useState } from \"react\";\n\ntype Theme = \"light\" | \"dark\";\n\ninterface ThemeContextType {\n  theme: Theme;\n  setTheme: (theme: Theme) => void;\n  toggleTheme: () => void;\n}\n\nconst ThemeContext = createContext<ThemeContextType | undefined>(undefined);\n\nexport function ThemeProvider({ children }: { children: React.ReactNode }) {\n  const [theme, setTheme] = useState<Theme>(() => {\n    if (typeof window !== \"undefined\") {\n      const stored = localStorage.getItem(\"theme\") as Theme;\n      if (stored) return stored;\n      return window.matchMedia(\"(prefers-color-scheme: dark)\").matches ? \"dark\" : \"light\";\n    }\n    return \"light\";\n  });\n\n  useEffect(() => {\n    const root = document.documentElement;\n    root.classList.remove(\"light\", \"dark\");\n    root.classList.add(theme);\n    localStorage.setItem(\"theme\", theme);\n  }, [theme]);\n\n  const toggleTheme = () => {\n    setTheme(theme === \"light\" ? \"dark\" : \"light\");\n  };\n\n  return (\n    <ThemeContext.Provider value={{ theme, setTheme, toggleTheme }}>\n      {children}\n    </ThemeContext.Provider>\n  );\n}\n\nexport function useTheme() {\n  const context = useContext(ThemeContext);\n  if (!context) {\n    throw new Error(\"useTheme must be used within a ThemeProvider\");\n  }\n  return context;\n}\n","path":null,"size_bytes":1284,"size_tokens":null},"client/src/pages/sharing.tsx":{"content":"import { useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { useSearch } from \"wouter\";\nimport { \n  Share2, \n  Link as LinkIcon, \n  Copy, \n  Check,\n  Download,\n  ExternalLink,\n  QrCode\n} from \"lucide-react\";\nimport { SiFacebook, SiX, SiWhatsapp, SiLinkedin, SiInstagram } from \"react-icons/si\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Separator } from \"@/components/ui/separator\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport type { Campaign } from \"@shared/schema\";\n\nexport default function SharingPage() {\n  const { t } = useTranslation();\n  const { toast } = useToast();\n  const searchParams = new URLSearchParams(useSearch());\n  const campaignIdFromUrl = searchParams.get(\"campaign\");\n  \n  const [selectedCampaignId, setSelectedCampaignId] = useState<string>(campaignIdFromUrl || \"\");\n  const [copied, setCopied] = useState(false);\n\n  const { data: campaigns, isLoading } = useQuery<Campaign[]>({\n    queryKey: [\"/api/campaigns\"],\n  });\n\n  const selectedCampaign = campaigns?.find((c) => c.id === selectedCampaignId);\n  const shareUrl = selectedCampaign \n    ? `${window.location.origin}/view/${selectedCampaign.id}` \n    : \"\";\n\n  const copyToClipboard = async () => {\n    try {\n      await navigator.clipboard.writeText(shareUrl);\n      setCopied(true);\n      toast({\n        title: t(\"common.success\"),\n        description: \"Link copied to clipboard\",\n      });\n      setTimeout(() => setCopied(false), 2000);\n    } catch (err) {\n      toast({\n        title: t(\"common.error\"),\n        description: \"Failed to copy link\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const socialPlatforms = [\n    {\n      name: \"Facebook\",\n      icon: SiFacebook,\n      color: \"bg-[#1877F2] hover:bg-[#1877F2]/90\",\n      url: (link: string) => `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(link)}`,\n    },\n    {\n      name: \"X (Twitter)\",\n      icon: SiX,\n      color: \"bg-black hover:bg-black/90 dark:bg-white dark:text-black dark:hover:bg-white/90\",\n      url: (link: string) => `https://twitter.com/intent/tweet?url=${encodeURIComponent(link)}`,\n    },\n    {\n      name: \"WhatsApp\",\n      icon: SiWhatsapp,\n      color: \"bg-[#25D366] hover:bg-[#25D366]/90\",\n      url: (link: string) => `https://wa.me/?text=${encodeURIComponent(link)}`,\n    },\n    {\n      name: \"LinkedIn\",\n      icon: SiLinkedin,\n      color: \"bg-[#0A66C2] hover:bg-[#0A66C2]/90\",\n      url: (link: string) => `https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(link)}`,\n    },\n  ];\n\n  return (\n    <div className=\"flex flex-col h-full\">\n      <div className=\"flex items-center justify-between gap-4 p-6 border-b\">\n        <h1 className=\"text-2xl font-semibold\" data-testid=\"text-page-title\">\n          {t(\"nav.sharing\")}\n        </h1>\n      </div>\n\n      <div className=\"flex-1 overflow-auto p-6\">\n        <div className=\"max-w-3xl mx-auto space-y-6\">\n          <Card>\n            <CardHeader>\n              <CardTitle>Select a Campaign to Share</CardTitle>\n              <CardDescription>\n                Choose a campaign from your collection to generate shareable links\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              {isLoading ? (\n                <Skeleton className=\"h-10 w-full\" />\n              ) : (\n                <Select\n                  value={selectedCampaignId}\n                  onValueChange={setSelectedCampaignId}\n                >\n                  <SelectTrigger data-testid=\"select-campaign\">\n                    <SelectValue placeholder=\"Select a campaign\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {campaigns?.filter(c => c.status === \"active\" || c.status === \"completed\").map((campaign) => (\n                      <SelectItem key={campaign.id} value={campaign.id}>\n                        <div className=\"flex items-center gap-2\">\n                          <span>{campaign.name}</span>\n                          <Badge variant=\"secondary\" className=\"text-xs\">\n                            {campaign.status}\n                          </Badge>\n                        </div>\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              )}\n            </CardContent>\n          </Card>\n\n          {selectedCampaign && (\n            <>\n              <Card>\n                <CardHeader>\n                  <div className=\"flex items-center gap-2\">\n                    <LinkIcon className=\"h-5 w-5\" />\n                    <CardTitle>Share Link</CardTitle>\n                  </div>\n                  <CardDescription>\n                    Copy this link to share your campaign brochure\n                  </CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"flex gap-2\">\n                    <Input\n                      value={shareUrl}\n                      readOnly\n                      className=\"font-mono text-sm\"\n                      data-testid=\"input-share-url\"\n                    />\n                    <Button onClick={copyToClipboard} data-testid=\"button-copy-link\">\n                      {copied ? (\n                        <Check className=\"h-4 w-4 mr-2\" />\n                      ) : (\n                        <Copy className=\"h-4 w-4 mr-2\" />\n                      )}\n                      {copied ? \"Copied\" : \"Copy\"}\n                    </Button>\n                  </div>\n                  <div className=\"flex gap-2 mt-4\">\n                    <Button variant=\"outline\" asChild data-testid=\"button-open-link\">\n                      <a href={shareUrl} target=\"_blank\" rel=\"noopener noreferrer\">\n                        <ExternalLink className=\"h-4 w-4 mr-2\" />\n                        Open in New Tab\n                      </a>\n                    </Button>\n                    <Button variant=\"outline\" data-testid=\"button-download-pdf\">\n                      <Download className=\"h-4 w-4 mr-2\" />\n                      Download PDF\n                    </Button>\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <div className=\"flex items-center gap-2\">\n                    <Share2 className=\"h-5 w-5\" />\n                    <CardTitle>Share on Social Media</CardTitle>\n                  </div>\n                  <CardDescription>\n                    Share your campaign directly to social platforms\n                  </CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n                    {socialPlatforms.map((platform) => (\n                      <Button\n                        key={platform.name}\n                        className={`${platform.color} text-white`}\n                        asChild\n                        data-testid={`button-share-${platform.name.toLowerCase().replace(/[^a-z]/g, \"\")}`}\n                      >\n                        <a\n                          href={platform.url(shareUrl)}\n                          target=\"_blank\"\n                          rel=\"noopener noreferrer\"\n                        >\n                          <platform.icon className=\"h-4 w-4 mr-2\" />\n                          {platform.name}\n                        </a>\n                      </Button>\n                    ))}\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <div className=\"flex items-center gap-2\">\n                    <QrCode className=\"h-5 w-5\" />\n                    <CardTitle>QR Code</CardTitle>\n                  </div>\n                  <CardDescription>\n                    Scan or download the QR code to share your campaign\n                  </CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"flex flex-col md:flex-row items-center gap-6\">\n                    <div className=\"w-48 h-48 bg-muted rounded-lg flex items-center justify-center border\">\n                      <QrCode className=\"h-32 w-32 text-muted-foreground\" />\n                    </div>\n                    <div className=\"flex flex-col gap-4 text-center md:text-left\">\n                      <div>\n                        <h4 className=\"font-medium mb-1\">Download QR Code</h4>\n                        <p className=\"text-sm text-muted-foreground\">\n                          Get a high-resolution QR code for print materials\n                        </p>\n                      </div>\n                      <div className=\"flex gap-2 justify-center md:justify-start\">\n                        <Button variant=\"outline\" data-testid=\"button-download-qr-png\">\n                          <Download className=\"h-4 w-4 mr-2\" />\n                          PNG\n                        </Button>\n                        <Button variant=\"outline\" data-testid=\"button-download-qr-svg\">\n                          <Download className=\"h-4 w-4 mr-2\" />\n                          SVG\n                        </Button>\n                      </div>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle>Sharing Statistics</CardTitle>\n                  <CardDescription>\n                    Track how your campaign is performing\n                  </CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n                    <div className=\"text-center p-4 rounded-lg bg-muted/50\">\n                      <p className=\"text-3xl font-bold\">0</p>\n                      <p className=\"text-sm text-muted-foreground\">Total Views</p>\n                    </div>\n                    <div className=\"text-center p-4 rounded-lg bg-muted/50\">\n                      <p className=\"text-3xl font-bold\">0</p>\n                      <p className=\"text-sm text-muted-foreground\">Unique Visitors</p>\n                    </div>\n                    <div className=\"text-center p-4 rounded-lg bg-muted/50\">\n                      <p className=\"text-3xl font-bold\">0</p>\n                      <p className=\"text-sm text-muted-foreground\">Downloads</p>\n                    </div>\n                    <div className=\"text-center p-4 rounded-lg bg-muted/50\">\n                      <p className=\"text-3xl font-bold\">0</p>\n                      <p className=\"text-sm text-muted-foreground\">Social Shares</p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </>\n          )}\n\n          {!selectedCampaign && !isLoading && (\n            <div className=\"flex flex-col items-center justify-center py-16 text-muted-foreground\">\n              <Share2 className=\"h-12 w-12 mb-4\" />\n              <p className=\"text-lg\">Select a campaign to start sharing</p>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":11574,"size_tokens":null},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    // h-9 to match icon buttons and default buttons.\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","path":null,"size_bytes":844,"size_tokens":null},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","path":null,"size_bytes":140,"size_tokens":null},"client/src/pages/dashboard.tsx":{"content":"import { useTranslation } from \"react-i18next\";\nimport { Link } from \"wouter\";\nimport { BarChart3, Package, FileText, Megaphone, Plus, TrendingUp, TrendingDown, ArrowRight } from \"lucide-react\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport {\n  LineChart,\n  Line,\n  XAxis,\n  YAxis,\n  CartesianGrid,\n  Tooltip,\n  ResponsiveContainer,\n  PieChart,\n  Pie,\n  Cell,\n} from \"recharts\";\n\nconst COLORS = [\"hsl(var(--chart-1))\", \"hsl(var(--chart-2))\", \"hsl(var(--chart-3))\", \"hsl(var(--chart-4))\"];\n\ninterface DashboardStats {\n  totalCampaigns: number;\n  activeCampaigns: number;\n  totalProducts: number;\n  totalTemplates: number;\n  draftCampaigns: number;\n  campaignChartData: Array<{ month: string; campaigns: number }>;\n  productCategoryData: Array<{ name: string; value: number }>;\n  recentActivity: Array<{ id: string; action: string; item: string; time: string; type: string }>;\n}\n\nexport default function DashboardPage() {\n  const { t } = useTranslation();\n\n  const { data: stats, isLoading } = useQuery<DashboardStats>({\n    queryKey: [\"/api/dashboard/stats\"],\n  });\n\n  const statsCards = [\n    {\n      title: t(\"dashboard.totalCampaigns\"),\n      value: stats?.totalCampaigns ?? 0,\n      icon: Megaphone,\n      color: \"text-chart-1\",\n      bgColor: \"bg-chart-1/10\",\n    },\n    {\n      title: t(\"dashboard.activeCampaigns\"),\n      value: stats?.activeCampaigns ?? 0,\n      icon: BarChart3,\n      color: \"text-chart-2\",\n      bgColor: \"bg-chart-2/10\",\n    },\n    {\n      title: t(\"dashboard.totalProducts\"),\n      value: stats?.totalProducts ?? 0,\n      icon: Package,\n      color: \"text-chart-3\",\n      bgColor: \"bg-chart-3/10\",\n    },\n    {\n      title: t(\"dashboard.totalTemplates\"),\n      value: stats?.totalTemplates ?? 0,\n      icon: FileText,\n      color: \"text-chart-4\",\n      bgColor: \"bg-chart-4/10\",\n    },\n  ];\n\n  const campaignChartData = stats?.campaignChartData ?? [];\n  const productCategoryData = stats?.productCategoryData ?? [];\n  const recentActivity = stats?.recentActivity ?? [];\n\n  const hasChartData = campaignChartData.some(d => d.campaigns > 0);\n  const hasCategoryData = productCategoryData.length > 0;\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4\">\n        <div>\n          <h1 className=\"text-3xl font-semibold\">{t(\"dashboard.title\")}</h1>\n          <p className=\"text-muted-foreground\">{t(\"dashboard.welcome\")}</p>\n        </div>\n        <div className=\"flex gap-3\">\n          <Button asChild data-testid=\"button-create-campaign\">\n            <Link href=\"/campaigns/new\">\n              <Plus className=\"mr-2 h-4 w-4\" />\n              {t(\"dashboard.createCampaign\")}\n            </Link>\n          </Button>\n        </div>\n      </div>\n\n      <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\">\n        {statsCards.map((stat, index) => (\n          <Card key={index}>\n            <CardHeader className=\"flex flex-row items-center justify-between gap-4 pb-2\">\n              <CardTitle className=\"text-sm font-medium text-muted-foreground\">\n                {stat.title}\n              </CardTitle>\n              <div className={`p-2 rounded-md ${stat.bgColor}`}>\n                <stat.icon className={`h-4 w-4 ${stat.color}`} />\n              </div>\n            </CardHeader>\n            <CardContent>\n              {isLoading ? (\n                <Skeleton className=\"h-8 w-20\" />\n              ) : (\n                <div className=\"flex items-baseline gap-2\">\n                  <span className=\"text-3xl font-bold\" data-testid={`stat-value-${index}`}>{stat.value}</span>\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      <div className=\"grid gap-6 lg:grid-cols-2\">\n        <Card>\n          <CardHeader>\n            <CardTitle>{t(\"dashboard.campaignStats\")}</CardTitle>\n            <CardDescription>Campaigns created over the last 6 months</CardDescription>\n          </CardHeader>\n          <CardContent>\n            <div className=\"h-[300px]\">\n              {isLoading ? (\n                <div className=\"flex items-center justify-center h-full\">\n                  <Skeleton className=\"h-full w-full\" />\n                </div>\n              ) : hasChartData ? (\n                <ResponsiveContainer width=\"100%\" height=\"100%\">\n                  <LineChart data={campaignChartData}>\n                    <CartesianGrid strokeDasharray=\"3 3\" className=\"stroke-muted\" />\n                    <XAxis dataKey=\"month\" className=\"text-xs\" />\n                    <YAxis className=\"text-xs\" />\n                    <Tooltip\n                      contentStyle={{\n                        backgroundColor: \"hsl(var(--card))\",\n                        border: \"1px solid hsl(var(--border))\",\n                        borderRadius: \"8px\",\n                      }}\n                    />\n                    <Line\n                      type=\"monotone\"\n                      dataKey=\"campaigns\"\n                      stroke=\"hsl(var(--primary))\"\n                      strokeWidth={2}\n                      dot={{ fill: \"hsl(var(--primary))\" }}\n                    />\n                  </LineChart>\n                </ResponsiveContainer>\n              ) : (\n                <div className=\"flex flex-col items-center justify-center h-full text-muted-foreground\">\n                  <Megaphone className=\"h-12 w-12 mb-4 opacity-50\" />\n                  <p className=\"text-sm\">No campaigns created yet</p>\n                  <Button variant=\"outline\" size=\"sm\" className=\"mt-4\" asChild>\n                    <Link href=\"/campaigns/new\">Create your first campaign</Link>\n                  </Button>\n                </div>\n              )}\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader>\n            <CardTitle>{t(\"dashboard.productUsage\")}</CardTitle>\n            <CardDescription>Product categories in your catalog</CardDescription>\n          </CardHeader>\n          <CardContent>\n            <div className=\"h-[300px] flex items-center justify-center\">\n              {isLoading ? (\n                <Skeleton className=\"h-full w-full\" />\n              ) : hasCategoryData ? (\n                <ResponsiveContainer width=\"100%\" height=\"100%\">\n                  <PieChart>\n                    <Pie\n                      data={productCategoryData}\n                      cx=\"50%\"\n                      cy=\"50%\"\n                      innerRadius={60}\n                      outerRadius={100}\n                      paddingAngle={2}\n                      dataKey=\"value\"\n                    >\n                      {productCategoryData.map((_, index) => (\n                        <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />\n                      ))}\n                    </Pie>\n                    <Tooltip\n                      contentStyle={{\n                        backgroundColor: \"hsl(var(--card))\",\n                        border: \"1px solid hsl(var(--border))\",\n                        borderRadius: \"8px\",\n                      }}\n                    />\n                  </PieChart>\n                </ResponsiveContainer>\n              ) : (\n                <div className=\"flex flex-col items-center justify-center text-muted-foreground\">\n                  <Package className=\"h-12 w-12 mb-4 opacity-50\" />\n                  <p className=\"text-sm\">No products added yet</p>\n                  <Button variant=\"outline\" size=\"sm\" className=\"mt-4\" asChild>\n                    <Link href=\"/products/new\">Add your first product</Link>\n                  </Button>\n                </div>\n              )}\n            </div>\n            {hasCategoryData && (\n              <div className=\"flex flex-wrap justify-center gap-4 mt-4\">\n                {productCategoryData.map((item, index) => (\n                  <div key={item.name} className=\"flex items-center gap-2\">\n                    <div\n                      className=\"w-3 h-3 rounded-full\"\n                      style={{ backgroundColor: COLORS[index % COLORS.length] }}\n                    />\n                    <span className=\"text-sm text-muted-foreground\">{item.name} ({item.value})</span>\n                  </div>\n                ))}\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n\n      <div className=\"grid gap-6 lg:grid-cols-3\">\n        <Card className=\"lg:col-span-2\">\n          <CardHeader className=\"flex flex-row items-center justify-between gap-4\">\n            <div>\n              <CardTitle>{t(\"dashboard.recentActivity\")}</CardTitle>\n              <CardDescription>Latest actions in your workspace</CardDescription>\n            </div>\n            <Button variant=\"ghost\" size=\"sm\" asChild>\n              <Link href=\"/campaigns\">\n                View all\n                <ArrowRight className=\"ml-2 h-4 w-4\" />\n              </Link>\n            </Button>\n          </CardHeader>\n          <CardContent>\n            {isLoading ? (\n              <div className=\"space-y-4\">\n                {[...Array(4)].map((_, i) => (\n                  <Skeleton key={i} className=\"h-16 w-full\" />\n                ))}\n              </div>\n            ) : recentActivity.length > 0 ? (\n              <div className=\"space-y-4\">\n                {recentActivity.map((activity) => (\n                  <div\n                    key={activity.id}\n                    className=\"flex items-center justify-between py-3 border-b last:border-0\"\n                    data-testid={`activity-item-${activity.id}`}\n                  >\n                    <div className=\"flex items-center gap-4\">\n                      <div className=\"p-2 rounded-md bg-muted\">\n                        {activity.type === \"campaign\" && <Megaphone className=\"h-4 w-4\" />}\n                        {activity.type === \"product\" && <Package className=\"h-4 w-4\" />}\n                        {activity.type === \"template\" && <FileText className=\"h-4 w-4\" />}\n                      </div>\n                      <div>\n                        <p className=\"text-sm font-medium\">{activity.action}</p>\n                        <p className=\"text-sm text-muted-foreground\">{activity.item}</p>\n                      </div>\n                    </div>\n                    <span className=\"text-xs text-muted-foreground\">{activity.time}</span>\n                  </div>\n                ))}\n              </div>\n            ) : (\n              <div className=\"flex flex-col items-center justify-center py-8 text-muted-foreground\">\n                <Megaphone className=\"h-12 w-12 mb-4 opacity-50\" />\n                <p className=\"text-sm\">No recent activity</p>\n                <p className=\"text-xs mt-1\">Start by creating a campaign</p>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader>\n            <CardTitle>{t(\"dashboard.quickActions\")}</CardTitle>\n            <CardDescription>Get started quickly</CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-3\">\n            <Button className=\"w-full justify-start\" variant=\"outline\" asChild>\n              <Link href=\"/campaigns/new\">\n                <Megaphone className=\"mr-3 h-4 w-4\" />\n                {t(\"dashboard.createCampaign\")}\n              </Link>\n            </Button>\n            <Button className=\"w-full justify-start\" variant=\"outline\" asChild>\n              <Link href=\"/products/new\">\n                <Package className=\"mr-3 h-4 w-4\" />\n                {t(\"dashboard.addProduct\")}\n              </Link>\n            </Button>\n            <Button className=\"w-full justify-start\" variant=\"outline\" asChild>\n              <Link href=\"/templates\">\n                <FileText className=\"mr-3 h-4 w-4\" />\n                {t(\"dashboard.viewTemplates\")}\n              </Link>\n            </Button>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":12111,"size_tokens":null},"client/src/pages/suggestions.tsx":{"content":"import { useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { \n  Lightbulb, \n  Plus, \n  Clock, \n  CheckCircle, \n  CheckCheck \n} from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogFooter,\n} from \"@/components/ui/dialog\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport type { Suggestion } from \"@shared/schema\";\n\nconst suggestionFormSchema = z.object({\n  title: z.string().min(3, \"Title must be at least 3 characters\"),\n  content: z.string().min(10, \"Description must be at least 10 characters\"),\n});\n\ntype SuggestionFormValues = z.infer<typeof suggestionFormSchema>;\n\nexport default function SuggestionsPage() {\n  const { t } = useTranslation();\n  const { toast } = useToast();\n  const [dialogOpen, setDialogOpen] = useState(false);\n\n  const form = useForm<SuggestionFormValues>({\n    resolver: zodResolver(suggestionFormSchema),\n    defaultValues: {\n      title: \"\",\n      content: \"\",\n    },\n  });\n\n  const { data: suggestions, isLoading } = useQuery<Suggestion[]>({\n    queryKey: [\"/api/suggestions\"],\n  });\n\n  const createMutation = useMutation({\n    mutationFn: async (data: SuggestionFormValues) => {\n      return apiRequest(\"/api/suggestions\", {\n        method: \"POST\",\n        body: JSON.stringify(data),\n      });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/suggestions\"] });\n      setDialogOpen(false);\n      form.reset();\n      toast({\n        title: t(\"common.success\"),\n        description: \"Your suggestion has been submitted.\",\n      });\n    },\n    onError: () => {\n      toast({\n        title: t(\"common.error\"),\n        description: t(\"errors.somethingWentWrong\"),\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case \"pending\":\n        return <Clock className=\"h-4 w-4\" />;\n      case \"reviewed\":\n        return <CheckCircle className=\"h-4 w-4\" />;\n      case \"implemented\":\n        return <CheckCheck className=\"h-4 w-4\" />;\n      default:\n        return <Clock className=\"h-4 w-4\" />;\n    }\n  };\n\n  const getStatusBadgeVariant = (status: string) => {\n    switch (status) {\n      case \"pending\":\n        return \"secondary\";\n      case \"reviewed\":\n        return \"default\";\n      case \"implemented\":\n        return \"outline\";\n      default:\n        return \"secondary\";\n    }\n  };\n\n  const formatDate = (date: string | Date) => {\n    return new Date(date).toLocaleDateString(undefined, {\n      year: \"numeric\",\n      month: \"short\",\n      day: \"numeric\",\n    });\n  };\n\n  const onSubmit = (data: SuggestionFormValues) => {\n    createMutation.mutate(data);\n  };\n\n  return (\n    <div className=\"flex flex-col h-full\">\n      <div className=\"flex items-center justify-between gap-4 p-6 border-b\">\n        <h1 className=\"text-2xl font-semibold\" data-testid=\"text-page-title\">\n          {t(\"suggestions.title\")}\n        </h1>\n        <Button onClick={() => setDialogOpen(true)} data-testid=\"button-submit-suggestion\">\n          <Plus className=\"h-4 w-4 mr-2\" />\n          {t(\"suggestions.submit\")}\n        </Button>\n      </div>\n\n      <div className=\"flex-1 overflow-auto p-6\">\n        {isLoading ? (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n            {Array.from({ length: 4 }).map((_, i) => (\n              <Card key={i}>\n                <CardHeader>\n                  <Skeleton className=\"h-5 w-3/4 mb-2\" />\n                  <Skeleton className=\"h-4 w-1/4\" />\n                </CardHeader>\n                <CardContent>\n                  <Skeleton className=\"h-4 w-full mb-2\" />\n                  <Skeleton className=\"h-4 w-2/3\" />\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        ) : !suggestions?.length ? (\n          <div className=\"flex flex-col items-center justify-center h-64 text-muted-foreground\">\n            <Lightbulb className=\"h-12 w-12 mb-4\" />\n            <p>{t(\"suggestions.noSuggestions\")}</p>\n            <Button className=\"mt-4\" onClick={() => setDialogOpen(true)} data-testid=\"button-first-suggestion\">\n              <Plus className=\"h-4 w-4 mr-2\" />\n              {t(\"suggestions.submit\")}\n            </Button>\n          </div>\n        ) : (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n            {suggestions.map((suggestion) => (\n              <Card key={suggestion.id} data-testid={`card-suggestion-${suggestion.id}`}>\n                <CardHeader>\n                  <div className=\"flex items-start justify-between gap-4\">\n                    <div className=\"flex-1 min-w-0\">\n                      <CardTitle className=\"text-lg truncate\" data-testid={`text-suggestion-title-${suggestion.id}`}>\n                        {suggestion.title}\n                      </CardTitle>\n                      <CardDescription>\n                        {formatDate(suggestion.createdAt)}\n                      </CardDescription>\n                    </div>\n                    <Badge variant={getStatusBadgeVariant(suggestion.status || \"pending\")}>\n                      <span className=\"flex items-center gap-1\">\n                        {getStatusIcon(suggestion.status || \"pending\")}\n                        {t(`suggestions.${suggestion.status || \"pending\"}`)}\n                      </span>\n                    </Badge>\n                  </div>\n                </CardHeader>\n                <CardContent>\n                  <p className=\"text-sm text-muted-foreground line-clamp-3\" data-testid={`text-suggestion-content-${suggestion.id}`}>\n                    {suggestion.content}\n                  </p>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        )}\n      </div>\n\n      <Dialog open={dialogOpen} onOpenChange={setDialogOpen}>\n        <DialogContent className=\"sm:max-w-lg\">\n          <DialogHeader>\n            <DialogTitle>{t(\"suggestions.submit\")}</DialogTitle>\n          </DialogHeader>\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n              <FormField\n                control={form.control}\n                name=\"title\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>{t(\"suggestions.suggestionTitle\")}</FormLabel>\n                    <FormControl>\n                      <Input\n                        {...field}\n                        placeholder={t(\"suggestions.suggestionTitle\")}\n                        data-testid=\"input-suggestion-title\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <FormField\n                control={form.control}\n                name=\"content\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>{t(\"suggestions.suggestionContent\")}</FormLabel>\n                    <FormControl>\n                      <Textarea\n                        {...field}\n                        placeholder={t(\"suggestions.suggestionContent\")}\n                        rows={5}\n                        className=\"resize-none\"\n                        data-testid=\"input-suggestion-content\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <DialogFooter>\n                <Button type=\"button\" variant=\"outline\" onClick={() => setDialogOpen(false)}>\n                  {t(\"common.cancel\")}\n                </Button>\n                <Button type=\"submit\" disabled={createMutation.isPending} data-testid=\"button-confirm-suggestion\">\n                  {createMutation.isPending ? t(\"common.loading\") : t(\"common.submit\")}\n                </Button>\n              </DialogFooter>\n            </form>\n          </Form>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","path":null,"size_bytes":8681,"size_tokens":null},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","path":null,"size_bytes":2751,"size_tokens":null},"client/src/pages/products.tsx":{"content":"import { useState, useRef } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { Plus, Search, Filter, MoreHorizontal, Pencil, Trash2, Package, Grid, List, Upload, X } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuTrigger } from \"@/components/ui/dropdown-menu\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { Product } from \"@shared/schema\";\n\nconst productSchema = z.object({\n  name: z.string().min(1, \"Name is required\"),\n  description: z.string().optional(),\n  category: z.string().optional(),\n  price: z.string().min(1, \"Price is required\"),\n  discountPrice: z.string().optional(),\n  discountPercentage: z.string().optional(),\n  sku: z.string().optional(),\n  imageUrl: z.string().optional(),\n});\n\ntype ProductFormValues = z.infer<typeof productSchema>;\n\nexport default function ProductsPage() {\n  const { t } = useTranslation();\n  const { toast } = useToast();\n  const [search, setSearch] = useState(\"\");\n  const [category, setCategory] = useState(\"all\");\n  const [viewMode, setViewMode] = useState<\"grid\" | \"list\">(\"grid\");\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [editingProduct, setEditingProduct] = useState<Product | null>(null);\n  const [isUploading, setIsUploading] = useState(false);\n  const [uploadPreview, setUploadPreview] = useState<string | null>(null);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  const handleFileUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (!file) return;\n\n    setIsUploading(true);\n    const formData = new FormData();\n    formData.append(\"file\", file);\n\n    try {\n      const token = localStorage.getItem(\"authToken\");\n      const response = await fetch(\"/api/upload\", {\n        method: \"POST\",\n        body: formData,\n        credentials: \"include\",\n        headers: token ? { \"Authorization\": `Bearer ${token}` } : {},\n      });\n      if (!response.ok) throw new Error(\"Upload failed\");\n      const data = await response.json();\n      form.setValue(\"imageUrl\", data.url);\n      setUploadPreview(data.url);\n      toast({ title: t(\"common.success\"), description: \"Image uploaded successfully\" });\n    } catch (error) {\n      toast({ variant: \"destructive\", title: t(\"common.error\"), description: \"Failed to upload image\" });\n    } finally {\n      setIsUploading(false);\n    }\n  };\n\n  const clearUploadPreview = () => {\n    setUploadPreview(null);\n    form.setValue(\"imageUrl\", \"\");\n    if (fileInputRef.current) fileInputRef.current.value = \"\";\n  };\n\n  const { data: products, isLoading } = useQuery<Product[]>({\n    queryKey: [\"/api/products\"],\n  });\n\n  const form = useForm<ProductFormValues>({\n    resolver: zodResolver(productSchema),\n    defaultValues: {\n      name: \"\",\n      description: \"\",\n      category: \"\",\n      price: \"\",\n      discountPrice: \"\",\n      discountPercentage: \"\",\n      sku: \"\",\n      imageUrl: \"\",\n    },\n  });\n\n  const createMutation = useMutation({\n    mutationFn: async (data: ProductFormValues) => {\n      return apiRequest(\"POST\", \"/api/products\", {\n        ...data,\n        price: data.price,\n        discountPrice: data.discountPrice || null,\n        discountPercentage: data.discountPercentage ? parseInt(data.discountPercentage) : null,\n      });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/products\"] });\n      setIsDialogOpen(false);\n      form.reset();\n      toast({ title: t(\"common.success\"), description: \"Product created successfully\" });\n    },\n    onError: () => {\n      toast({ variant: \"destructive\", title: t(\"common.error\"), description: t(\"errors.somethingWentWrong\") });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: async ({ id, data }: { id: string; data: ProductFormValues }) => {\n      return apiRequest(\"PATCH\", `/api/products/${id}`, {\n        ...data,\n        price: data.price,\n        discountPrice: data.discountPrice || null,\n        discountPercentage: data.discountPercentage ? parseInt(data.discountPercentage) : null,\n      });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/products\"] });\n      setIsDialogOpen(false);\n      setEditingProduct(null);\n      form.reset();\n      toast({ title: t(\"common.success\"), description: \"Product updated successfully\" });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return apiRequest(\"DELETE\", `/api/products/${id}`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/products\"] });\n      toast({ title: t(\"common.success\"), description: \"Product deleted successfully\" });\n    },\n  });\n\n  const onSubmit = (data: ProductFormValues) => {\n    if (editingProduct) {\n      updateMutation.mutate({ id: editingProduct.id, data });\n    } else {\n      createMutation.mutate(data);\n    }\n  };\n\n  const handleEdit = (product: Product) => {\n    setEditingProduct(product);\n    form.reset({\n      name: product.name,\n      description: product.description || \"\",\n      category: product.category || \"\",\n      price: product.price,\n      discountPrice: product.discountPrice || \"\",\n      discountPercentage: product.discountPercentage?.toString() || \"\",\n      sku: product.sku || \"\",\n      imageUrl: product.imageUrl || \"\",\n    });\n    setIsDialogOpen(true);\n  };\n\n  const filteredProducts = products?.filter((p) => {\n    const matchesSearch = p.name.toLowerCase().includes(search.toLowerCase());\n    const matchesCategory = category === \"all\" || p.category === category;\n    return matchesSearch && matchesCategory;\n  });\n\n  const categories = [...new Set(products?.map((p) => p.category).filter(Boolean))];\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4\">\n        <div>\n          <h1 className=\"text-3xl font-semibold\">{t(\"products.title\")}</h1>\n          <p className=\"text-muted-foreground\">Manage your product catalog</p>\n        </div>\n        <Dialog open={isDialogOpen} onOpenChange={(open) => {\n          setIsDialogOpen(open);\n          if (!open) {\n            setEditingProduct(null);\n            form.reset();\n          }\n        }}>\n          <DialogTrigger asChild>\n            <Button data-testid=\"button-add-product\">\n              <Plus className=\"mr-2 h-4 w-4\" />\n              {t(\"products.addProduct\")}\n            </Button>\n          </DialogTrigger>\n          <DialogContent className=\"max-w-md\">\n            <DialogHeader>\n              <DialogTitle>\n                {editingProduct ? t(\"products.editProduct\") : t(\"products.addProduct\")}\n              </DialogTitle>\n              <DialogDescription>\n                {editingProduct ? \"Update product details\" : \"Add a new product to your catalog\"}\n              </DialogDescription>\n            </DialogHeader>\n            <Form {...form}>\n              <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n                <FormField\n                  control={form.control}\n                  name=\"name\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>{t(\"products.name\")}</FormLabel>\n                      <FormControl>\n                        <Input {...field} data-testid=\"input-product-name\" />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <FormField\n                  control={form.control}\n                  name=\"description\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>{t(\"products.description\")}</FormLabel>\n                      <FormControl>\n                        <Input {...field} data-testid=\"input-product-description\" />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <FormField\n                    control={form.control}\n                    name=\"price\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>{t(\"products.price\")}</FormLabel>\n                        <FormControl>\n                          <Input {...field} type=\"number\" step=\"0.01\" data-testid=\"input-product-price\" />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                  <FormField\n                    control={form.control}\n                    name=\"discountPrice\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>{t(\"products.discountPrice\")}</FormLabel>\n                        <FormControl>\n                          <Input {...field} type=\"number\" step=\"0.01\" data-testid=\"input-product-discount\" />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                </div>\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <FormField\n                    control={form.control}\n                    name=\"category\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>{t(\"products.category\")}</FormLabel>\n                        <FormControl>\n                          <Input {...field} data-testid=\"input-product-category\" />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                  <FormField\n                    control={form.control}\n                    name=\"sku\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>{t(\"products.sku\")}</FormLabel>\n                        <FormControl>\n                          <Input {...field} data-testid=\"input-product-sku\" />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                </div>\n                <FormField\n                  control={form.control}\n                  name=\"imageUrl\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>{t(\"products.image\")}</FormLabel>\n                      <div className=\"space-y-3\">\n                        <div className=\"flex items-center gap-2\">\n                          <input\n                            type=\"file\"\n                            ref={fileInputRef}\n                            onChange={handleFileUpload}\n                            accept=\"image/jpeg,image/png,image/gif,image/webp\"\n                            className=\"hidden\"\n                            data-testid=\"input-product-image-file\"\n                          />\n                          <Button\n                            type=\"button\"\n                            variant=\"outline\"\n                            onClick={() => fileInputRef.current?.click()}\n                            disabled={isUploading}\n                            className=\"flex-1\"\n                            data-testid=\"button-upload-image\"\n                          >\n                            <Upload className=\"mr-2 h-4 w-4\" />\n                            {isUploading ? \"Uploading...\" : \"Upload Image\"}\n                          </Button>\n                        </div>\n                        {(uploadPreview || field.value) && (\n                          <div className=\"relative w-20 h-20 rounded-md overflow-hidden border\">\n                            <img\n                              src={uploadPreview || field.value}\n                              alt=\"Preview\"\n                              className=\"w-full h-full object-cover\"\n                            />\n                            <Button\n                              type=\"button\"\n                              variant=\"destructive\"\n                              size=\"icon\"\n                              className=\"absolute top-1 right-1 h-5 w-5\"\n                              onClick={clearUploadPreview}\n                              data-testid=\"button-clear-image\"\n                            >\n                              <X className=\"h-3 w-3\" />\n                            </Button>\n                          </div>\n                        )}\n                        <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                          <span>or enter URL:</span>\n                        </div>\n                        <FormControl>\n                          <Input \n                            {...field} \n                            placeholder=\"https://example.com/image.jpg\"\n                            data-testid=\"input-product-image\" \n                          />\n                        </FormControl>\n                      </div>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <DialogFooter>\n                  <Button type=\"submit\" disabled={createMutation.isPending || updateMutation.isPending} data-testid=\"button-save-product\">\n                    {editingProduct ? t(\"common.update\") : t(\"common.create\")}\n                  </Button>\n                </DialogFooter>\n              </form>\n            </Form>\n          </DialogContent>\n        </Dialog>\n      </div>\n\n      <div className=\"flex flex-col sm:flex-row gap-4\">\n        <div className=\"relative flex-1\">\n          <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n          <Input\n            placeholder={t(\"products.search\")}\n            value={search}\n            onChange={(e) => setSearch(e.target.value)}\n            className=\"pl-10\"\n            data-testid=\"input-search-products\"\n          />\n        </div>\n        <Select value={category} onValueChange={setCategory}>\n          <SelectTrigger className=\"w-[180px]\" data-testid=\"select-category\">\n            <Filter className=\"mr-2 h-4 w-4\" />\n            <SelectValue placeholder={t(\"products.allCategories\")} />\n          </SelectTrigger>\n          <SelectContent>\n            <SelectItem value=\"all\">{t(\"products.allCategories\")}</SelectItem>\n            {categories.map((cat) => (\n              <SelectItem key={cat} value={cat!}>\n                {cat}\n              </SelectItem>\n            ))}\n          </SelectContent>\n        </Select>\n        <div className=\"flex gap-1 border rounded-md p-1\">\n          <Button\n            variant={viewMode === \"grid\" ? \"secondary\" : \"ghost\"}\n            size=\"icon\"\n            onClick={() => setViewMode(\"grid\")}\n            data-testid=\"button-view-grid\"\n          >\n            <Grid className=\"h-4 w-4\" />\n          </Button>\n          <Button\n            variant={viewMode === \"list\" ? \"secondary\" : \"ghost\"}\n            size=\"icon\"\n            onClick={() => setViewMode(\"list\")}\n            data-testid=\"button-view-list\"\n          >\n            <List className=\"h-4 w-4\" />\n          </Button>\n        </div>\n      </div>\n\n      {isLoading ? (\n        <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4\">\n          {[...Array(8)].map((_, i) => (\n            <Card key={i}>\n              <CardContent className=\"p-4\">\n                <Skeleton className=\"h-32 w-full mb-4\" />\n                <Skeleton className=\"h-4 w-3/4 mb-2\" />\n                <Skeleton className=\"h-4 w-1/2\" />\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n      ) : filteredProducts?.length === 0 ? (\n        <Card>\n          <CardContent className=\"flex flex-col items-center justify-center py-12\">\n            <Package className=\"h-12 w-12 text-muted-foreground mb-4\" />\n            <h3 className=\"text-lg font-medium mb-2\">{t(\"products.noProducts\")}</h3>\n            <p className=\"text-muted-foreground text-center mb-4\">\n              Get started by adding your first product\n            </p>\n            <Button onClick={() => setIsDialogOpen(true)}>\n              <Plus className=\"mr-2 h-4 w-4\" />\n              {t(\"products.addProduct\")}\n            </Button>\n          </CardContent>\n        </Card>\n      ) : viewMode === \"grid\" ? (\n        <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4\">\n          {filteredProducts?.map((product) => (\n            <Card key={product.id} className=\"overflow-hidden\" data-testid={`card-product-${product.id}`}>\n              <div className=\"aspect-square bg-muted flex items-center justify-center\">\n                {product.imageUrl ? (\n                  <img src={product.imageUrl} alt={product.name} className=\"w-full h-full object-cover\" />\n                ) : (\n                  <Package className=\"h-12 w-12 text-muted-foreground\" />\n                )}\n              </div>\n              <CardContent className=\"p-4\">\n                <div className=\"flex items-start justify-between gap-2\">\n                  <div className=\"flex-1 min-w-0\">\n                    <h3 className=\"font-medium truncate\">{product.name}</h3>\n                    {product.category && (\n                      <Badge variant=\"secondary\" className=\"mt-1\">\n                        {product.category}\n                      </Badge>\n                    )}\n                  </div>\n                  <DropdownMenu>\n                    <DropdownMenuTrigger asChild>\n                      <Button variant=\"ghost\" size=\"icon\" data-testid={`button-product-menu-${product.id}`}>\n                        <MoreHorizontal className=\"h-4 w-4\" />\n                      </Button>\n                    </DropdownMenuTrigger>\n                    <DropdownMenuContent align=\"end\">\n                      <DropdownMenuItem onClick={() => handleEdit(product)}>\n                        <Pencil className=\"mr-2 h-4 w-4\" />\n                        {t(\"common.edit\")}\n                      </DropdownMenuItem>\n                      <DropdownMenuItem\n                        className=\"text-destructive\"\n                        onClick={() => deleteMutation.mutate(product.id)}\n                      >\n                        <Trash2 className=\"mr-2 h-4 w-4\" />\n                        {t(\"common.delete\")}\n                      </DropdownMenuItem>\n                    </DropdownMenuContent>\n                  </DropdownMenu>\n                </div>\n                <div className=\"mt-3 flex items-center gap-2\">\n                  {product.discountPrice ? (\n                    <>\n                      <span className=\"text-lg font-bold\">â‚¬{product.discountPrice}</span>\n                      <span className=\"text-sm text-muted-foreground line-through\">â‚¬{product.price}</span>\n                    </>\n                  ) : (\n                    <span className=\"text-lg font-bold\">â‚¬{product.price}</span>\n                  )}\n                </div>\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n      ) : (\n        <Card>\n          <CardContent className=\"p-0\">\n            <table className=\"w-full\">\n              <thead>\n                <tr className=\"border-b\">\n                  <th className=\"text-left p-4 font-medium\">{t(\"products.name\")}</th>\n                  <th className=\"text-left p-4 font-medium\">{t(\"products.category\")}</th>\n                  <th className=\"text-left p-4 font-medium\">{t(\"products.price\")}</th>\n                  <th className=\"text-left p-4 font-medium\">{t(\"products.sku\")}</th>\n                  <th className=\"text-right p-4 font-medium\">{t(\"products.actions\")}</th>\n                </tr>\n              </thead>\n              <tbody>\n                {filteredProducts?.map((product) => (\n                  <tr key={product.id} className=\"border-b last:border-0\" data-testid={`row-product-${product.id}`}>\n                    <td className=\"p-4\">\n                      <div className=\"flex items-center gap-3\">\n                        <div className=\"h-10 w-10 rounded-md bg-muted flex items-center justify-center\">\n                          {product.imageUrl ? (\n                            <img src={product.imageUrl} alt={product.name} className=\"h-10 w-10 rounded-md object-cover\" />\n                          ) : (\n                            <Package className=\"h-5 w-5 text-muted-foreground\" />\n                          )}\n                        </div>\n                        <span className=\"font-medium\">{product.name}</span>\n                      </div>\n                    </td>\n                    <td className=\"p-4\">\n                      {product.category && <Badge variant=\"secondary\">{product.category}</Badge>}\n                    </td>\n                    <td className=\"p-4\">\n                      {product.discountPrice ? (\n                        <div className=\"flex items-center gap-2\">\n                          <span className=\"font-medium\">â‚¬{product.discountPrice}</span>\n                          <span className=\"text-sm text-muted-foreground line-through\">â‚¬{product.price}</span>\n                        </div>\n                      ) : (\n                        <span className=\"font-medium\">â‚¬{product.price}</span>\n                      )}\n                    </td>\n                    <td className=\"p-4 text-muted-foreground\">{product.sku || \"-\"}</td>\n                    <td className=\"p-4 text-right\">\n                      <DropdownMenu>\n                        <DropdownMenuTrigger asChild>\n                          <Button variant=\"ghost\" size=\"icon\">\n                            <MoreHorizontal className=\"h-4 w-4\" />\n                          </Button>\n                        </DropdownMenuTrigger>\n                        <DropdownMenuContent align=\"end\">\n                          <DropdownMenuItem onClick={() => handleEdit(product)}>\n                            <Pencil className=\"mr-2 h-4 w-4\" />\n                            {t(\"common.edit\")}\n                          </DropdownMenuItem>\n                          <DropdownMenuItem\n                            className=\"text-destructive\"\n                            onClick={() => deleteMutation.mutate(product.id)}\n                          >\n                            <Trash2 className=\"mr-2 h-4 w-4\" />\n                            {t(\"common.delete\")}\n                          </DropdownMenuItem>\n                        </DropdownMenuContent>\n                      </DropdownMenu>\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </CardContent>\n        </Card>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":23709,"size_tokens":null},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","path":null,"size_bytes":756,"size_tokens":null},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","path":null,"size_bytes":3848,"size_tokens":null},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","path":null,"size_bytes":7428,"size_tokens":null},"client/src/pages/messages.tsx":{"content":"import { useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { \n  Send, \n  Inbox, \n  Mail, \n  Search, \n  Plus,\n  User,\n  Check,\n  CheckCheck\n} from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { Separator } from \"@/components/ui/separator\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogFooter,\n} from \"@/components/ui/dialog\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Tabs, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport type { Message, User as UserType } from \"@shared/schema\";\n\ninterface MessageWithUser extends Message {\n  sender?: UserType;\n  receiver?: UserType;\n}\n\nexport default function MessagesPage() {\n  const { t } = useTranslation();\n  const [activeTab, setActiveTab] = useState<\"inbox\" | \"sent\">(\"inbox\");\n  const [selectedMessage, setSelectedMessage] = useState<MessageWithUser | null>(null);\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [composeDialogOpen, setComposeDialogOpen] = useState(false);\n  const [newMessage, setNewMessage] = useState({\n    recipientId: \"\",\n    subject: \"\",\n    content: \"\",\n  });\n\n  const { data: messages, isLoading: loadingMessages } = useQuery<MessageWithUser[]>({\n    queryKey: [\"/api/messages\", activeTab],\n  });\n\n  const { data: users } = useQuery<UserType[]>({\n    queryKey: [\"/api/users\"],\n  });\n\n  const filteredMessages = messages?.filter((message) => {\n    const searchLower = searchQuery.toLowerCase();\n    return (\n      message.subject?.toLowerCase().includes(searchLower) ||\n      message.content.toLowerCase().includes(searchLower)\n    );\n  });\n\n  const formatDate = (date: string | Date) => {\n    const d = new Date(date);\n    const now = new Date();\n    const diff = now.getTime() - d.getTime();\n    const days = Math.floor(diff / (1000 * 60 * 60 * 24));\n\n    if (days === 0) {\n      return d.toLocaleTimeString([], { hour: \"2-digit\", minute: \"2-digit\" });\n    } else if (days === 1) {\n      return \"Yesterday\";\n    } else if (days < 7) {\n      return d.toLocaleDateString([], { weekday: \"short\" });\n    } else {\n      return d.toLocaleDateString([], { month: \"short\", day: \"numeric\" });\n    }\n  };\n\n  const handleSendMessage = () => {\n    setComposeDialogOpen(false);\n    setNewMessage({ recipientId: \"\", subject: \"\", content: \"\" });\n  };\n\n  return (\n    <div className=\"flex h-full\">\n      <div className=\"w-80 border-r flex flex-col\">\n        <div className=\"p-4 border-b\">\n          <div className=\"flex items-center justify-between gap-2 mb-4\">\n            <h1 className=\"text-xl font-semibold\" data-testid=\"text-messages-title\">\n              {t(\"messages.title\")}\n            </h1>\n            <Button\n              size=\"icon\"\n              onClick={() => setComposeDialogOpen(true)}\n              data-testid=\"button-compose-message\"\n            >\n              <Plus className=\"h-4 w-4\" />\n            </Button>\n          </div>\n          <div className=\"relative\">\n            <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n            <Input\n              placeholder={t(\"common.search\")}\n              value={searchQuery}\n              onChange={(e) => setSearchQuery(e.target.value)}\n              className=\"pl-9\"\n              data-testid=\"input-search-messages\"\n            />\n          </div>\n        </div>\n\n        <Tabs value={activeTab} onValueChange={(v) => setActiveTab(v as \"inbox\" | \"sent\")} className=\"px-4 pt-2\">\n          <TabsList className=\"w-full\">\n            <TabsTrigger value=\"inbox\" className=\"flex-1\" data-testid=\"tab-inbox\">\n              <Inbox className=\"h-4 w-4 mr-2\" />\n              {t(\"messages.inbox\")}\n            </TabsTrigger>\n            <TabsTrigger value=\"sent\" className=\"flex-1\" data-testid=\"tab-sent\">\n              <Send className=\"h-4 w-4 mr-2\" />\n              {t(\"messages.sent\")}\n            </TabsTrigger>\n          </TabsList>\n        </Tabs>\n\n        <ScrollArea className=\"flex-1\">\n          <div className=\"p-2\">\n            {loadingMessages ? (\n              Array.from({ length: 5 }).map((_, i) => (\n                <div key={i} className=\"p-3 mb-2\">\n                  <div className=\"flex items-center gap-3\">\n                    <Skeleton className=\"h-10 w-10 rounded-full\" />\n                    <div className=\"flex-1\">\n                      <Skeleton className=\"h-4 w-24 mb-2\" />\n                      <Skeleton className=\"h-3 w-full\" />\n                    </div>\n                  </div>\n                </div>\n              ))\n            ) : !filteredMessages?.length ? (\n              <div className=\"flex flex-col items-center justify-center py-12 text-muted-foreground\">\n                <Mail className=\"h-10 w-10 mb-3\" />\n                <p className=\"text-sm\">{t(\"messages.noMessages\")}</p>\n              </div>\n            ) : (\n              filteredMessages.map((message) => {\n                const otherUser = activeTab === \"inbox\" ? message.sender : message.receiver;\n                const isSelected = selectedMessage?.id === message.id;\n                const isUnread = activeTab === \"inbox\" && !message.isRead;\n\n                return (\n                  <button\n                    key={message.id}\n                    className={`w-full text-left p-3 rounded-md mb-1 hover-elevate active-elevate-2 transition-colors ${\n                      isSelected ? \"bg-accent\" : \"\"\n                    } ${isUnread ? \"bg-primary/5\" : \"\"}`}\n                    onClick={() => setSelectedMessage(message)}\n                    data-testid={`message-item-${message.id}`}\n                  >\n                    <div className=\"flex items-start gap-3\">\n                      <Avatar className=\"h-10 w-10\">\n                        <AvatarFallback className=\"text-xs\">\n                          {otherUser?.firstName?.[0]}{otherUser?.lastName?.[0]}\n                        </AvatarFallback>\n                      </Avatar>\n                      <div className=\"flex-1 min-w-0\">\n                        <div className=\"flex items-center justify-between gap-2\">\n                          <span className={`text-sm truncate ${isUnread ? \"font-semibold\" : \"\"}`}>\n                            {otherUser?.firstName} {otherUser?.lastName}\n                          </span>\n                          <span className=\"text-xs text-muted-foreground flex-shrink-0\">\n                            {formatDate(message.createdAt)}\n                          </span>\n                        </div>\n                        {message.subject && (\n                          <p className={`text-sm truncate ${isUnread ? \"font-medium\" : \"text-muted-foreground\"}`}>\n                            {message.subject}\n                          </p>\n                        )}\n                        <p className=\"text-xs text-muted-foreground truncate\">\n                          {message.content}\n                        </p>\n                      </div>\n                      {isUnread && (\n                        <Badge variant=\"default\" className=\"h-2 w-2 p-0 rounded-full\" />\n                      )}\n                    </div>\n                  </button>\n                );\n              })\n            )}\n          </div>\n        </ScrollArea>\n      </div>\n\n      <div className=\"flex-1 flex flex-col\">\n        {selectedMessage ? (\n          <>\n            <div className=\"p-4 border-b\">\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center gap-3\">\n                  <Avatar>\n                    <AvatarFallback>\n                      {activeTab === \"inbox\"\n                        ? `${selectedMessage.sender?.firstName?.[0]}${selectedMessage.sender?.lastName?.[0]}`\n                        : `${selectedMessage.receiver?.firstName?.[0]}${selectedMessage.receiver?.lastName?.[0]}`}\n                    </AvatarFallback>\n                  </Avatar>\n                  <div>\n                    <p className=\"font-medium\" data-testid=\"text-message-sender\">\n                      {activeTab === \"inbox\"\n                        ? `${selectedMessage.sender?.firstName} ${selectedMessage.sender?.lastName}`\n                        : `${selectedMessage.receiver?.firstName} ${selectedMessage.receiver?.lastName}`}\n                    </p>\n                    <p className=\"text-sm text-muted-foreground\">\n                      {formatDate(selectedMessage.createdAt)}\n                    </p>\n                  </div>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  {activeTab === \"sent\" && (\n                    selectedMessage.isRead ? (\n                      <CheckCheck className=\"h-4 w-4 text-primary\" />\n                    ) : (\n                      <Check className=\"h-4 w-4 text-muted-foreground\" />\n                    )\n                  )}\n                </div>\n              </div>\n              {selectedMessage.subject && (\n                <h2 className=\"text-lg font-semibold mt-3\" data-testid=\"text-message-subject\">\n                  {selectedMessage.subject}\n                </h2>\n              )}\n            </div>\n\n            <ScrollArea className=\"flex-1 p-6\">\n              <p className=\"whitespace-pre-wrap\" data-testid=\"text-message-content\">\n                {selectedMessage.content}\n              </p>\n            </ScrollArea>\n\n            {activeTab === \"inbox\" && (\n              <div className=\"p-4 border-t\">\n                <div className=\"flex gap-2\">\n                  <Textarea\n                    placeholder={t(\"messages.reply\")}\n                    className=\"resize-none\"\n                    data-testid=\"input-reply-message\"\n                  />\n                  <Button size=\"icon\" data-testid=\"button-send-reply\">\n                    <Send className=\"h-4 w-4\" />\n                  </Button>\n                </div>\n              </div>\n            )}\n          </>\n        ) : (\n          <div className=\"flex-1 flex flex-col items-center justify-center text-muted-foreground\">\n            <Mail className=\"h-16 w-16 mb-4\" />\n            <p className=\"text-lg\">Select a message to read</p>\n          </div>\n        )}\n      </div>\n\n      <Dialog open={composeDialogOpen} onOpenChange={setComposeDialogOpen}>\n        <DialogContent className=\"sm:max-w-lg\">\n          <DialogHeader>\n            <DialogTitle>{t(\"messages.newMessage\")}</DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div>\n              <label className=\"text-sm font-medium mb-1 block\">{t(\"messages.to\")}</label>\n              <Select\n                value={newMessage.recipientId}\n                onValueChange={(v) => setNewMessage({ ...newMessage, recipientId: v })}\n              >\n                <SelectTrigger data-testid=\"select-recipient\">\n                  <SelectValue placeholder={t(\"messages.selectRecipient\")} />\n                </SelectTrigger>\n                <SelectContent>\n                  {users?.map((user) => (\n                    <SelectItem key={user.id} value={user.id}>\n                      <div className=\"flex items-center gap-2\">\n                        <User className=\"h-4 w-4\" />\n                        {user.firstName} {user.lastName}\n                      </div>\n                    </SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            </div>\n            <div>\n              <label className=\"text-sm font-medium mb-1 block\">{t(\"messages.subject\")}</label>\n              <Input\n                value={newMessage.subject}\n                onChange={(e) => setNewMessage({ ...newMessage, subject: e.target.value })}\n                placeholder={t(\"messages.subject\")}\n                data-testid=\"input-message-subject\"\n              />\n            </div>\n            <div>\n              <label className=\"text-sm font-medium mb-1 block\">{t(\"messages.message\")}</label>\n              <Textarea\n                value={newMessage.content}\n                onChange={(e) => setNewMessage({ ...newMessage, content: e.target.value })}\n                placeholder={t(\"messages.message\")}\n                rows={6}\n                className=\"resize-none\"\n                data-testid=\"input-message-content\"\n              />\n            </div>\n          </div>\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => setComposeDialogOpen(false)}>\n              {t(\"common.cancel\")}\n            </Button>\n            <Button onClick={handleSendMessage} data-testid=\"button-send-message\">\n              <Send className=\"h-4 w-4 mr-2\" />\n              {t(\"messages.send\")}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","path":null,"size_bytes":13165,"size_tokens":null},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","path":null,"size_bytes":1723,"size_tokens":null},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","path":null,"size_bytes":1251,"size_tokens":null},"client/src/lib/i18n.ts":{"content":"import i18n from \"i18next\";\nimport { initReactI18next } from \"react-i18next\";\nimport LanguageDetector from \"i18next-browser-languagedetector\";\n\nconst resources = {\n  en: {\n    translation: {\n      app: {\n        name: \"e-Brochure\",\n        tagline: \"Create stunning digital brochures\",\n      },\n      nav: {\n        dashboard: \"Dashboard\",\n        products: \"Products\",\n        templates: \"Templates\",\n        campaigns: \"Campaigns\",\n        sharing: \"Sharing\",\n        messages: \"Messages\",\n        suggestions: \"Suggestions\",\n        tutorials: \"Tutorials\",\n        account: \"Account\",\n        users: \"Users\",\n        organization: \"Organization\",\n        tenants: \"Tenants\",\n        settings: \"Settings\",\n        superAdmin: \"Super Admin\",\n        logout: \"Logout\",\n      },\n      auth: {\n        login: \"Login\",\n        register: \"Register\",\n        forgotPassword: \"Forgot Password?\",\n        resetPassword: \"Reset Password\",\n        email: \"Email\",\n        password: \"Password\",\n        confirmPassword: \"Confirm Password\",\n        firstName: \"First Name\",\n        lastName: \"Last Name\",\n        mobilePhone: \"Mobile Phone\",\n        captcha: \"Captcha\",\n        rememberMe: \"Remember me\",\n        noAccount: \"Don't have an account?\",\n        hasAccount: \"Already have an account?\",\n        signUp: \"Sign Up\",\n        signIn: \"Sign In\",\n        twoFactor: \"Two-Factor Authentication\",\n        enterCode: \"Enter the 6-digit code from your authenticator app\",\n        scanQr: \"Scan this QR code with your authenticator app\",\n        verifyCode: \"Verify Code\",\n        setupTotp: \"Set up Two-Factor Authentication\",\n        resetEmailSent: \"If this email exists in our system, a password reset email has been sent.\",\n        activationRequired: \"Please check your email to activate your account.\",\n        invalidCredentials: \"Invalid email or password\",\n      },\n      subscription: {\n        title: \"Choose Your Plan\",\n        subtitle: \"Select the plan that works best for you\",\n        monthly: \"Monthly\",\n        sixMonth: \"6 Months\",\n        yearly: \"12 Months\",\n        perMonth: \"/month\",\n        popular: \"Most Popular\",\n        bestValue: \"Best Value\",\n        features: {\n          unlimitedCampaigns: \"Unlimited Campaigns\",\n          allTemplates: \"Access to All Templates\",\n          prioritySupport: \"Priority Support\",\n          teamMembers: \"Team Members\",\n          analytics: \"Advanced Analytics\",\n          socialIntegration: \"Social Media Integration\",\n        },\n        selectPlan: \"Select Plan\",\n        proceedToPayment: \"Proceed to Payment\",\n      },\n      dashboard: {\n        title: \"Dashboard\",\n        welcome: \"Welcome back\",\n        totalCampaigns: \"Total Campaigns\",\n        activeCampaigns: \"Active Campaigns\",\n        totalProducts: \"Total Products\",\n        totalTemplates: \"Total Templates\",\n        recentActivity: \"Recent Activity\",\n        campaignStats: \"Campaign Statistics\",\n        productUsage: \"Product Usage\",\n        quickActions: \"Quick Actions\",\n        createCampaign: \"Create Campaign\",\n        addProduct: \"Add Product\",\n        viewTemplates: \"View Templates\",\n      },\n      products: {\n        title: \"Products\",\n        addProduct: \"Add Product\",\n        editProduct: \"Edit Product\",\n        deleteProduct: \"Delete Product\",\n        search: \"Search products...\",\n        filter: \"Filter\",\n        category: \"Category\",\n        allCategories: \"All Categories\",\n        name: \"Name\",\n        description: \"Description\",\n        price: \"Price\",\n        discountPrice: \"Discount Price\",\n        discountPercentage: \"Discount %\",\n        sku: \"SKU\",\n        image: \"Image\",\n        global: \"Global\",\n        tenant: \"Tenant\",\n        actions: \"Actions\",\n        noProducts: \"No products found\",\n        confirmDelete: \"Are you sure you want to delete this product?\",\n        external: \"External\",\n      },\n      templates: {\n        title: \"Templates\",\n        addTemplate: \"Add Template\",\n        editTemplate: \"Edit Template\",\n        deleteTemplate: \"Delete Template\",\n        singlePage: \"Single Page\",\n        multiPage: \"Multi Page\",\n        templateName: \"Template Name\",\n        templateType: \"Template Type\",\n        font: \"Font\",\n        textColor: \"Text Color\",\n        backgroundColor: \"Background Color\",\n        coverPage: \"Cover Page\",\n        innerPage: \"Inner Page\",\n        backPage: \"Back Page\",\n        priceTemplate: \"Price Template\",\n        noTemplates: \"No templates found\",\n        preview: \"Preview\",\n      },\n      campaigns: {\n        title: \"Campaigns\",\n        createCampaign: \"Create Campaign\",\n        editCampaign: \"Edit Campaign\",\n        deleteCampaign: \"Delete Campaign\",\n        campaignName: \"Campaign Name\",\n        description: \"Description\",\n        template: \"Template\",\n        status: \"Status\",\n        startDate: \"Start Date\",\n        endDate: \"End Date\",\n        draft: \"Draft\",\n        active: \"Active\",\n        scheduled: \"Scheduled\",\n        completed: \"Completed\",\n        paused: \"Paused\",\n        noCampaigns: \"No campaigns found\",\n        openEditor: \"Open Editor\",\n        share: \"Share\",\n        duplicate: \"Duplicate\",\n        saveCampaign: \"Save Campaign\",\n        enterCampaignName: \"Please enter a name for your campaign before saving.\",\n        enterName: \"Enter campaign name...\",\n        nameRequired: \"Campaign name is required\",\n        savedSuccessfully: \"Campaign saved successfully\",\n        saveFailed: \"Failed to save campaign\",\n        untitled: \"Untitled Campaign\",\n      },\n      editor: {\n        title: \"Brochure Editor\",\n        save: \"Save\",\n        undo: \"Undo\",\n        redo: \"Redo\",\n        preview: \"Preview\",\n        publish: \"Publish\",\n        addProduct: \"Add Product\",\n        addText: \"Add Text\",\n        addShape: \"Add Shape\",\n        addImage: \"Add Image\",\n        layers: \"Layers\",\n        properties: \"Properties\",\n        position: \"Position\",\n        size: \"Size\",\n        rotation: \"Rotation\",\n        opacity: \"Opacity\",\n        pages: \"Pages\",\n        page: \"Page\",\n        addPage: \"Add Page\",\n        deletePage: \"Delete Page\",\n        zoom: \"Zoom\",\n        zoomIn: \"Zoom In\",\n        zoomOut: \"Zoom Out\",\n        canvasSize: \"Canvas Size\",\n        selectTool: \"Select Tool\",\n        textTool: \"Text Tool\",\n        drawTool: \"Drawing Tool\",\n        selectMode: \"Select Mode\",\n        selectModeHelp: \"Click on elements to select and move them. Use the properties panel to edit.\",\n        textOptions: \"Text Options\",\n        textColor: \"Text Color\",\n        clickCanvasToAddText: \"Click on the canvas to add text\",\n        shapeOptions: \"Shape Options\",\n        fillColor: \"Fill Color\",\n        strokeColor: \"Stroke Color\",\n        clickCanvasToAddShape: \"Click on the canvas to add a shape\",\n        drawOptions: \"Drawing Options\",\n        brushColor: \"Brush Color\",\n        brushSize: \"Brush Size\",\n        dragToDraw: \"Click and drag on the canvas to draw\",\n        headerFooter: \"Header & Footer\",\n        headerHeight: \"Header Height\",\n        footerHeight: \"Footer Height\",\n        toggleHeader: \"Toggle Header Zone\",\n        toggleFooter: \"Toggle Footer Zone\",\n        headerZone: \"Header Zone\",\n        footerZone: \"Footer Zone\",\n        canvasEmpty: \"Drag products here or use tools to design\",\n        addedToCanvas: \"added to canvas\",\n        sampleText: \"Double-click to edit text\",\n        rectangle: \"Rectangle\",\n        circle: \"Circle\",\n        triangle: \"Triangle\",\n        line: \"Line\",\n        textContent: \"Text Content\",\n        fontFamily: \"Font Family\",\n        fontSize: \"Font Size\",\n        backgroundColor: \"Background Color\",\n        transparent: \"Transparent\",\n        strokeWidth: \"Stroke Width\",\n        width: \"Width\",\n        height: \"Height\",\n        selectElementHelp: \"Select an element to edit its properties\",\n        noLayers: \"No layers yet\",\n        emptyCanvas: \"Canvas is empty\",\n      },\n      messages: {\n        title: \"Messages\",\n        compose: \"Compose\",\n        inbox: \"Inbox\",\n        sent: \"Sent\",\n        to: \"To\",\n        from: \"From\",\n        subject: \"Subject\",\n        message: \"Message\",\n        send: \"Send\",\n        reply: \"Reply\",\n        noMessages: \"No messages found\",\n        newMessage: \"New Message\",\n        selectRecipient: \"Select recipient\",\n      },\n      suggestions: {\n        title: \"Suggestions\",\n        submit: \"Submit Suggestion\",\n        yourSuggestion: \"Your Suggestion\",\n        suggestionTitle: \"Title\",\n        suggestionContent: \"Description\",\n        status: \"Status\",\n        pending: \"Pending\",\n        reviewed: \"Reviewed\",\n        implemented: \"Implemented\",\n        noSuggestions: \"No suggestions found\",\n      },\n      tutorials: {\n        title: \"Tutorials & Guides\",\n        videos: \"Videos\",\n        documents: \"Documents\",\n        announcements: \"Announcements\",\n        watch: \"Watch\",\n        download: \"Download\",\n        readMore: \"Read More\",\n        noTutorials: \"No tutorials found\",\n      },\n      account: {\n        title: \"Account Settings\",\n        profile: \"Profile\",\n        subscription: \"Subscription\",\n        security: \"Security\",\n        updateProfile: \"Update Profile\",\n        changePassword: \"Change Password\",\n        currentPassword: \"Current Password\",\n        newPassword: \"New Password\",\n        confirmNewPassword: \"Confirm New Password\",\n        twoFactorAuth: \"Two-Factor Authentication\",\n        enable2fa: \"Enable 2FA\",\n        disable2fa: \"Disable 2FA\",\n        subscriptionStatus: \"Subscription Status\",\n        expiresOn: \"Expires on\",\n        upgradePlan: \"Upgrade Plan\",\n      },\n      users: {\n        title: \"User Management\",\n        addUser: \"Add User\",\n        editUser: \"Edit User\",\n        deleteUser: \"Delete User\",\n        role: \"Role\",\n        tenantAdmin: \"Tenant Admin\",\n        tenantUser: \"Tenant User\",\n        superAdmin: \"Super Admin\",\n        active: \"Active\",\n        inactive: \"Inactive\",\n        noUsers: \"No users found\",\n        inviteUser: \"Invite User\",\n      },\n      tenants: {\n        title: \"Tenant Management\",\n        description: \"Manage all tenants in the system\",\n        create: \"Create Tenant\",\n        createTitle: \"Create New Tenant\",\n        editTitle: \"Edit Tenant\",\n        deleteTitle: \"Delete Tenant\",\n        deleteDescription: \"Are you sure you want to delete {{name}}? This action cannot be undone and will remove all associated data.\",\n        allTenants: \"All Tenants\",\n        totalCount: \"{{count}} tenant(s) total\",\n        name: \"Tenant Name\",\n        namePlaceholder: \"Enter tenant name\",\n        slug: \"Slug\",\n        slugPlaceholder: \"tenant-slug\",\n        code: \"Code\",\n        users: \"Users\",\n        subscription: \"Subscription\",\n        createdAt: \"Created At\",\n        noTenants: \"No tenants found\",\n        noSubscription: \"No Subscription\",\n        createSuccess: \"Tenant created successfully\",\n        createError: \"Failed to create tenant\",\n        updateSuccess: \"Tenant updated successfully\",\n        updateError: \"Failed to update tenant\",\n        deleteSuccess: \"Tenant deleted successfully\",\n        deleteError: \"Failed to delete tenant\",\n        viewAsTenant: \"View as Tenant\",\n        impersonateSuccess: \"Now viewing as {{name}}\",\n        impersonateError: \"Failed to switch to tenant view\",\n      },\n      settings: {\n        title: \"System Settings\",\n        description: \"Configure payment gateway, product synchronization, and email settings\",\n        paymentGateway: \"Payment Gateway\",\n        productSync: \"Product Sync\",\n        emailSettings: \"Email Settings\",\n        iyzicoTitle: \"iyzico Payment Gateway\",\n        iyzicoDescription: \"Configure iyzico payment integration for subscription payments\",\n        testMode: \"Test Mode\",\n        apiKey: \"API Key\",\n        apiKeyPlaceholder: \"Enter your iyzico API key\",\n        secretKey: \"Secret Key\",\n        secretKeyPlaceholder: \"Enter your iyzico secret key\",\n        baseUrl: \"Base URL\",\n        productApiTitle: \"Product Sync API\",\n        productApiDescription: \"Configure external product API for automatic product synchronization\",\n        enableSync: \"Enable Sync\",\n        apiEndpoint: \"API Endpoint\",\n        httpMethod: \"HTTP Method\",\n        headers: \"Headers (JSON)\",\n        syncSchedule: \"Sync Schedule (Cron)\",\n        cronHint: \"Use cron format: minute hour day month weekday (e.g., 0 0 * * * for daily at midnight)\",\n        syncNow: \"Sync Now\",\n        saveSuccess: \"Settings saved successfully\",\n        saveError: \"Failed to save settings\",\n        syncSuccess: \"Product sync started successfully\",\n        syncError: \"Failed to start product sync\",\n        emailTitle: \"Email Configuration\",\n        emailDescription: \"Configure SMTP settings for sending emails (activation, password reset, etc.)\",\n        enableEmail: \"Enable Email Sending\",\n        smtpHost: \"SMTP Host\",\n        smtpPort: \"SMTP Port\",\n        smtpUser: \"SMTP Username\",\n        smtpUserPlaceholder: \"Enter your SMTP username\",\n        smtpPass: \"SMTP Password\",\n        smtpPassPlaceholder: \"Enter your SMTP password\",\n        smtpFrom: \"From Email Address\",\n        appUrl: \"Application URL\",\n        appUrlHint: \"The base URL of your application (used in email links)\",\n        testEmail: \"Send Test Email\",\n        testEmailSuccess: \"Test email sent successfully\",\n        testEmailError: \"Failed to send test email\",\n        productConnectors: \"Product Connectors\",\n        productConnectorsTitle: \"Product Connectors\",\n        productConnectorsDescription: \"Configure external APIs to fetch products dynamically for campaigns\",\n        addConnector: \"Add Connector\",\n        editConnector: \"Edit Connector\",\n        connectorCreated: \"Connector created successfully\",\n        connectorUpdated: \"Connector updated successfully\",\n        connectorDeleted: \"Connector deleted successfully\",\n        connectorError: \"Failed to save connector\",\n        noConnectors: \"No connectors configured\",\n        noConnectorsHint: \"Add a connector to fetch products from external APIs\",\n        connectorDialogDescription: \"Configure the API endpoint and field mappings\",\n        connectorName: \"Connector Name\",\n        connectorNamePlaceholder: \"e.g., Product API\",\n        connectorDescription: \"Description\",\n        connectorDescriptionPlaceholder: \"Brief description of this connector\",\n        connectorEnabled: \"Enabled\",\n        requestMethod: \"Request Method\",\n        requestUrl: \"Request URL\",\n        requestUrlPlaceholder: \"https://api.example.com/products\",\n        requestParams: \"Request Parameters\",\n        requestParamsHint: \"Use {{search}} as placeholder for search query\",\n        paramKey: \"Key\",\n        paramValue: \"Value\",\n        requestBody: \"Request Body (JSON)\",\n        requestBodyHint: \"For POST/PUT requests. Use {{search}} for search query.\",\n        responseParser: \"Response Parser\",\n        responseParserHint: \"JSONPath to extract array of products (e.g., $.data.products)\",\n        fieldMappings: \"Field Mappings\",\n        fieldMappingsHint: \"Map API response fields to product properties\",\n        fieldName: \"Name Field\",\n        fieldImage: \"Image Field\",\n        fieldPrice: \"Price Field\",\n        fieldSku: \"SKU Field\",\n        testConnector: \"Test Connector\",\n        testQueryPlaceholder: \"Enter search query...\",\n        test: \"Test\",\n        testResults: \"Test Results\",\n        testSuccess: \"Connector test successful\",\n        testError: \"Connector test failed\",\n      },\n      impersonation: {\n        viewingAs: \"Viewing as\",\n        switchBack: \"Switch Back to SuperAdmin\",\n      },\n      organizationSettings: {\n        title: \"Organization Settings\",\n        organizationInfo: \"Organization Information\",\n        organizationInfoDesc: \"View your organization details\",\n        organizationName: \"Organization Name\",\n        organizationCode: \"Organization Code\",\n        logoTitle: \"Organization Logo\",\n        logoDesc: \"Upload your organization's logo to personalize your brochures and campaigns\",\n        uploadLogo: \"Upload Logo\",\n        removeLogo: \"Remove Logo\",\n        logoUploadSuccess: \"Logo uploaded successfully\",\n        logoUploadError: \"Failed to upload logo\",\n        logoRemoveSuccess: \"Logo removed successfully\",\n        logoRemoveError: \"Failed to remove logo\",\n        logoRequirements: \"Recommended: Square image, at least 200x200px. Max 5MB. Formats: JPG, PNG, GIF, WebP\",\n        fileTooLarge: \"File is too large. Maximum size is 5MB\",\n        invalidFileType: \"Invalid file type. Only JPG, PNG, GIF, and WebP are allowed\",\n      },\n      common: {\n        save: \"Save\",\n        saving: \"Saving...\",\n        cancel: \"Cancel\",\n        delete: \"Delete\",\n        edit: \"Edit\",\n        add: \"Add\",\n        create: \"Create\",\n        update: \"Update\",\n        search: \"Search\",\n        filter: \"Filter\",\n        loading: \"Loading...\",\n        noData: \"No data available\",\n        success: \"Success\",\n        error: \"Error\",\n        confirm: \"Confirm\",\n        back: \"Back\",\n        next: \"Next\",\n        submit: \"Submit\",\n        close: \"Close\",\n        view: \"View\",\n        download: \"Download\",\n        upload: \"Upload\",\n        select: \"Select\",\n        all: \"All\",\n        none: \"None\",\n        yes: \"Yes\",\n        no: \"No\",\n        or: \"or\",\n        and: \"and\",\n        actions: \"Actions\",\n        status: \"Status\",\n        date: \"Date\",\n        name: \"Name\",\n        description: \"Description\",\n        required: \"Required\",\n        optional: \"Optional\",\n        enabled: \"Enabled\",\n        disabled: \"Disabled\",\n        uploading: \"Uploading...\",\n        accessDenied: \"You do not have permission to access this page\",\n      },\n      errors: {\n        required: \"This field is required\",\n        invalidEmail: \"Invalid email address\",\n        passwordTooShort: \"Password must be at least 8 characters\",\n        passwordMismatch: \"Passwords do not match\",\n        somethingWentWrong: \"Something went wrong. Please try again.\",\n        unauthorized: \"You are not authorized to perform this action\",\n        notFound: \"Resource not found\",\n        serverError: \"Server error. Please try again later.\",\n      },\n    },\n  },\n  tr: {\n    translation: {\n      app: {\n        name: \"e-Brochure\",\n        tagline: \"Etkileyici dijital brosurler olusturun\",\n      },\n      nav: {\n        dashboard: \"Kontrol Paneli\",\n        products: \"Urunler\",\n        templates: \"Sablonlar\",\n        campaigns: \"Kampanyalar\",\n        sharing: \"Paylasim\",\n        messages: \"Mesajlar\",\n        suggestions: \"Oneriler\",\n        tutorials: \"Egitimler\",\n        account: \"Hesap\",\n        users: \"Kullanicilar\",\n        organization: \"Organizasyon\",\n        tenants: \"Kiracilar\",\n        settings: \"Ayarlar\",\n        superAdmin: \"Super Admin\",\n        logout: \"Cikis Yap\",\n      },\n      auth: {\n        login: \"Giris Yap\",\n        register: \"Kayit Ol\",\n        forgotPassword: \"Sifremi Unuttum\",\n        resetPassword: \"Sifreyi Sifirla\",\n        email: \"E-posta\",\n        password: \"Sifre\",\n        confirmPassword: \"Sifreyi Onayla\",\n        firstName: \"Ad\",\n        lastName: \"Soyad\",\n        mobilePhone: \"Cep Telefonu\",\n        captcha: \"Captcha\",\n        rememberMe: \"Beni hatirla\",\n        noAccount: \"Hesabiniz yok mu?\",\n        hasAccount: \"Zaten hesabiniz var mi?\",\n        signUp: \"Kayit Ol\",\n        signIn: \"Giris Yap\",\n        twoFactor: \"Iki Faktorlu Dogrulama\",\n        enterCode: \"Dogrulama uygulamanizdan 6 haneli kodu girin\",\n        scanQr: \"Bu QR kodunu dogrulama uygulamanizla tarayin\",\n        verifyCode: \"Kodu Dogrula\",\n        setupTotp: \"Iki Faktorlu Dogrulamayi Ayarla\",\n        resetEmailSent: \"Bu e-posta sistemimizde mevcutsa, sifre sifirlama e-postasi gonderildi.\",\n        activationRequired: \"Hesabinizi aktive etmek icin e-postanizi kontrol edin.\",\n        invalidCredentials: \"Gecersiz e-posta veya sifre\",\n      },\n      subscription: {\n        title: \"Planinizi Secin\",\n        subtitle: \"Size en uygun plani secin\",\n        monthly: \"Aylik\",\n        sixMonth: \"6 Ay\",\n        yearly: \"12 Ay\",\n        perMonth: \"/ay\",\n        popular: \"En Populer\",\n        bestValue: \"En Iyi Deger\",\n        features: {\n          unlimitedCampaigns: \"Sinirsiz Kampanya\",\n          allTemplates: \"Tum Sablonlara Erisim\",\n          prioritySupport: \"Oncelikli Destek\",\n          teamMembers: \"Takim Uyeleri\",\n          analytics: \"Gelismis Analitik\",\n          socialIntegration: \"Sosyal Medya Entegrasyonu\",\n        },\n        selectPlan: \"Plan Sec\",\n        proceedToPayment: \"Odemeye Devam Et\",\n      },\n      dashboard: {\n        title: \"Kontrol Paneli\",\n        welcome: \"Tekrar hos geldiniz\",\n        totalCampaigns: \"Toplam Kampanya\",\n        activeCampaigns: \"Aktif Kampanyalar\",\n        totalProducts: \"Toplam Urun\",\n        totalTemplates: \"Toplam Sablon\",\n        recentActivity: \"Son Aktiviteler\",\n        campaignStats: \"Kampanya Istatistikleri\",\n        productUsage: \"Urun Kullanimi\",\n        quickActions: \"Hizli Islemler\",\n        createCampaign: \"Kampanya Olustur\",\n        addProduct: \"Urun Ekle\",\n        viewTemplates: \"Sablonlari Gor\",\n      },\n      products: {\n        title: \"Urunler\",\n        addProduct: \"Urun Ekle\",\n        editProduct: \"Urun Duzenle\",\n        deleteProduct: \"Urun Sil\",\n        search: \"Urun ara...\",\n        filter: \"Filtrele\",\n        category: \"Kategori\",\n        allCategories: \"Tum Kategoriler\",\n        name: \"Ad\",\n        description: \"Aciklama\",\n        price: \"Fiyat\",\n        discountPrice: \"Indirimli Fiyat\",\n        discountPercentage: \"Indirim %\",\n        sku: \"Stok Kodu\",\n        image: \"Gorsel\",\n        global: \"Global\",\n        tenant: \"Kiraciya Ozel\",\n        actions: \"Islemler\",\n        noProducts: \"Urun bulunamadi\",\n        confirmDelete: \"Bu urunu silmek istediginizden emin misiniz?\",\n        external: \"Harici\",\n      },\n      templates: {\n        title: \"Sablonlar\",\n        addTemplate: \"Sablon Ekle\",\n        editTemplate: \"Sablon Duzenle\",\n        deleteTemplate: \"Sablon Sil\",\n        singlePage: \"Tek Sayfa\",\n        multiPage: \"Cok Sayfa\",\n        templateName: \"Sablon Adi\",\n        templateType: \"Sablon Turu\",\n        font: \"Yazi Tipi\",\n        textColor: \"Metin Rengi\",\n        backgroundColor: \"Arka Plan Rengi\",\n        coverPage: \"Kapak Sayfasi\",\n        innerPage: \"Ic Sayfa\",\n        backPage: \"Arka Sayfa\",\n        priceTemplate: \"Fiyat Sablonu\",\n        noTemplates: \"Sablon bulunamadi\",\n        preview: \"Onizleme\",\n      },\n      campaigns: {\n        title: \"Kampanyalar\",\n        createCampaign: \"Kampanya Olustur\",\n        editCampaign: \"Kampanya Duzenle\",\n        deleteCampaign: \"Kampanya Sil\",\n        campaignName: \"Kampanya Adi\",\n        description: \"Aciklama\",\n        template: \"Sablon\",\n        status: \"Durum\",\n        startDate: \"Baslangic Tarihi\",\n        endDate: \"Bitis Tarihi\",\n        draft: \"Taslak\",\n        active: \"Aktif\",\n        scheduled: \"Planlanmis\",\n        completed: \"Tamamlandi\",\n        paused: \"Duraklatildi\",\n        noCampaigns: \"Kampanya bulunamadi\",\n        openEditor: \"Editoru Ac\",\n        share: \"Paylas\",\n        duplicate: \"Kopyala\",\n        saveCampaign: \"Kampanyayi Kaydet\",\n        enterCampaignName: \"Lutfen kaydetmeden once kampanya icin bir isim girin.\",\n        enterName: \"Kampanya adini girin...\",\n        nameRequired: \"Kampanya adi gereklidir\",\n        savedSuccessfully: \"Kampanya basariyla kaydedildi\",\n        saveFailed: \"Kampanya kaydedilemedi\",\n        untitled: \"Isimsiz Kampanya\",\n      },\n      editor: {\n        title: \"Brosur Editoru\",\n        save: \"Kaydet\",\n        undo: \"Geri Al\",\n        redo: \"Ileri Al\",\n        preview: \"Onizleme\",\n        publish: \"Yayinla\",\n        addProduct: \"Urun Ekle\",\n        addText: \"Metin Ekle\",\n        addShape: \"Sekil Ekle\",\n        addImage: \"Gorsel Ekle\",\n        layers: \"Katmanlar\",\n        properties: \"Ozellikler\",\n        position: \"Konum\",\n        size: \"Boyut\",\n        rotation: \"Dondurme\",\n        opacity: \"Opaklik\",\n        pages: \"Sayfalar\",\n        page: \"Sayfa\",\n        addPage: \"Sayfa Ekle\",\n        deletePage: \"Sayfa Sil\",\n        zoom: \"Yakinlastir\",\n        zoomIn: \"Yakinlastir\",\n        zoomOut: \"Uzaklastir\",\n        canvasSize: \"Tuval Boyutu\",\n        selectTool: \"Secim Araci\",\n        textTool: \"Metin Araci\",\n        drawTool: \"Cizim Araci\",\n        selectMode: \"Secim Modu\",\n        selectModeHelp: \"Secmek ve tasimak icin elemanlara tiklayin. Duzenlemek icin ozellikler panelini kullanin.\",\n        textOptions: \"Metin Secenekleri\",\n        textColor: \"Metin Rengi\",\n        clickCanvasToAddText: \"Metin eklemek icin tuvale tiklayin\",\n        shapeOptions: \"Sekil Secenekleri\",\n        fillColor: \"Dolgu Rengi\",\n        strokeColor: \"Cizgi Rengi\",\n        clickCanvasToAddShape: \"Sekil eklemek icin tuvale tiklayin\",\n        drawOptions: \"Cizim Secenekleri\",\n        brushColor: \"Firca Rengi\",\n        brushSize: \"Firca Boyutu\",\n        dragToDraw: \"Cizmek icin tuvalde surukleyin\",\n        headerFooter: \"Ust ve Alt Bilgi\",\n        headerHeight: \"Ust Bilgi Yuksekligi\",\n        footerHeight: \"Alt Bilgi Yuksekligi\",\n        toggleHeader: \"Ust Bilgi Alanini Ac/Kapat\",\n        toggleFooter: \"Alt Bilgi Alanini Ac/Kapat\",\n        headerZone: \"Ust Bilgi Alani\",\n        footerZone: \"Alt Bilgi Alani\",\n        canvasEmpty: \"Urunleri buraya surukleyin veya tasarim araclari kullanin\",\n        addedToCanvas: \"tuvale eklendi\",\n        sampleText: \"Metni duzenlemek icin cift tiklayin\",\n        rectangle: \"Dikdortgen\",\n        circle: \"Daire\",\n        triangle: \"Ucgen\",\n        line: \"Cizgi\",\n        textContent: \"Metin Icerigi\",\n        fontFamily: \"Yazi Tipi\",\n        fontSize: \"Yazi Boyutu\",\n        backgroundColor: \"Arka Plan Rengi\",\n        transparent: \"Saydam\",\n        strokeWidth: \"Cizgi Kalinligi\",\n        width: \"Genislik\",\n        height: \"Yukseklik\",\n        selectElementHelp: \"Ozelliklerini duzenlemek icin bir eleman secin\",\n        noLayers: \"Henuz katman yok\",\n        emptyCanvas: \"Tuval bos\",\n      },\n      messages: {\n        title: \"Mesajlar\",\n        compose: \"Yaz\",\n        inbox: \"Gelen Kutusu\",\n        sent: \"Gonderilenler\",\n        to: \"Kime\",\n        from: \"Kimden\",\n        subject: \"Konu\",\n        message: \"Mesaj\",\n        send: \"Gonder\",\n        reply: \"Yanitla\",\n        noMessages: \"Mesaj bulunamadi\",\n        newMessage: \"Yeni Mesaj\",\n        selectRecipient: \"Alici sec\",\n      },\n      suggestions: {\n        title: \"Oneriler\",\n        submit: \"Oneri Gonder\",\n        yourSuggestion: \"Oneriniz\",\n        suggestionTitle: \"Baslik\",\n        suggestionContent: \"Aciklama\",\n        status: \"Durum\",\n        pending: \"Beklemede\",\n        reviewed: \"Incelendi\",\n        implemented: \"Uyguland\",\n        noSuggestions: \"Oneri bulunamadi\",\n      },\n      tutorials: {\n        title: \"Egitimler ve Kilavuzlar\",\n        videos: \"Videolar\",\n        documents: \"Belgeler\",\n        announcements: \"Duyurular\",\n        watch: \"Izle\",\n        download: \"Indir\",\n        readMore: \"Devamini Oku\",\n        noTutorials: \"Egitim bulunamadi\",\n      },\n      account: {\n        title: \"Hesap Ayarlari\",\n        profile: \"Profil\",\n        subscription: \"Abonelik\",\n        security: \"Guvenlik\",\n        updateProfile: \"Profili Guncelle\",\n        changePassword: \"Sifre Degistir\",\n        currentPassword: \"Mevcut Sifre\",\n        newPassword: \"Yeni Sifre\",\n        confirmNewPassword: \"Yeni Sifreyi Onayla\",\n        twoFactorAuth: \"Iki Faktorlu Dogrulama\",\n        enable2fa: \"2FA Etkinlestir\",\n        disable2fa: \"2FA Devre Disi Birak\",\n        subscriptionStatus: \"Abonelik Durumu\",\n        expiresOn: \"Bitis tarihi\",\n        upgradePlan: \"Plani Yukselt\",\n      },\n      users: {\n        title: \"Kullanici Yonetimi\",\n        addUser: \"Kullanici Ekle\",\n        editUser: \"Kullanici Duzenle\",\n        deleteUser: \"Kullanici Sil\",\n        role: \"Rol\",\n        tenantAdmin: \"KiracÄ± Yonetici\",\n        tenantUser: \"KiracÄ± Kullanici\",\n        superAdmin: \"Super Admin\",\n        active: \"Aktif\",\n        inactive: \"Pasif\",\n        noUsers: \"Kullanici bulunamadi\",\n        inviteUser: \"Kullanici Davet Et\",\n      },\n      tenants: {\n        title: \"Kiraci Yonetimi\",\n        description: \"Sistemdeki tum kiracilari yonetin\",\n        create: \"Kiraci Olustur\",\n        createTitle: \"Yeni Kiraci Olustur\",\n        editTitle: \"Kiraci Duzenle\",\n        deleteTitle: \"Kiraci Sil\",\n        deleteDescription: \"{{name}} silmek istediginizden emin misiniz? Bu islem geri alinamaz ve tum ilgili veriler silinir.\",\n        allTenants: \"Tum Kiracilar\",\n        totalCount: \"Toplam {{count}} kiraci\",\n        name: \"Kiraci Adi\",\n        namePlaceholder: \"Kiraci adi girin\",\n        slug: \"Slug\",\n        slugPlaceholder: \"kiraci-slug\",\n        code: \"Kod\",\n        users: \"Kullanicilar\",\n        subscription: \"Abonelik\",\n        createdAt: \"Olusturulma Tarihi\",\n        noTenants: \"Kiraci bulunamadi\",\n        noSubscription: \"Abonelik Yok\",\n        createSuccess: \"Kiraci basariyla olusturuldu\",\n        createError: \"Kiraci olusturulamadi\",\n        updateSuccess: \"Kiraci basariyla guncellendi\",\n        updateError: \"Kiraci guncellenemedi\",\n        deleteSuccess: \"Kiraci basariyla silindi\",\n        deleteError: \"Kiraci silinemedi\",\n        viewAsTenant: \"Kiraci olarak gor\",\n        impersonateSuccess: \"Simdi {{name}} olarak goruntuleniyor\",\n        impersonateError: \"Kiraci gorunumune gecilemedi\",\n      },\n      settings: {\n        title: \"Sistem Ayarlari\",\n        description: \"Odeme gecidi, urun senkronizasyonu ve e-posta ayarlarini yapilandirin\",\n        paymentGateway: \"Odeme Gecidi\",\n        productSync: \"Urun Senkronizasyonu\",\n        emailSettings: \"E-posta Ayarlari\",\n        iyzicoTitle: \"iyzico Odeme Gecidi\",\n        iyzicoDescription: \"Abonelik odemeleri icin iyzico entegrasyonunu yapilandirin\",\n        testMode: \"Test Modu\",\n        apiKey: \"API Anahtari\",\n        apiKeyPlaceholder: \"iyzico API anahtarinizi girin\",\n        secretKey: \"Gizli Anahtar\",\n        secretKeyPlaceholder: \"iyzico gizli anahtarinizi girin\",\n        baseUrl: \"Temel URL\",\n        productApiTitle: \"Urun Senkronizasyon API\",\n        productApiDescription: \"Otomatik urun senkronizasyonu icin harici urun API yapilandirin\",\n        enableSync: \"Senkronizasyonu Etkinlestir\",\n        apiEndpoint: \"API UÃ§ Noktasi\",\n        httpMethod: \"HTTP Metodu\",\n        headers: \"Basliklar (JSON)\",\n        syncSchedule: \"Senkronizasyon Zamanlama (Cron)\",\n        cronHint: \"Cron formati kullanin: dakika saat gun ay haftanin gunu (orn: 0 0 * * * her gun gece yarisi)\",\n        syncNow: \"Simdi Senkronize Et\",\n        saveSuccess: \"Ayarlar basariyla kaydedildi\",\n        saveError: \"Ayarlar kaydedilemedi\",\n        syncSuccess: \"Urun senkronizasyonu basariyla basladi\",\n        syncError: \"Urun senkronizasyonu baslatÄ±lamadÄ±\",\n        emailTitle: \"E-posta Yapilandirmasi\",\n        emailDescription: \"E-posta gondermek icin SMTP ayarlarini yapilandirin (aktivasyon, sifre sifirlama, vb.)\",\n        enableEmail: \"E-posta Gondermeyi Etkinlestir\",\n        smtpHost: \"SMTP Sunucusu\",\n        smtpPort: \"SMTP Port\",\n        smtpUser: \"SMTP Kullanici Adi\",\n        smtpUserPlaceholder: \"SMTP kullanici adinizi girin\",\n        smtpPass: \"SMTP Sifresi\",\n        smtpPassPlaceholder: \"SMTP sifrenizi girin\",\n        smtpFrom: \"Gonderen E-posta Adresi\",\n        appUrl: \"Uygulama URL\",\n        appUrlHint: \"Uygulamanizin temel URL'si (e-posta baglantilarinda kullanilir)\",\n        testEmail: \"Test E-postasi Gonder\",\n        testEmailSuccess: \"Test e-postasi basariyla gonderildi\",\n        testEmailError: \"Test e-postasi gonderilemedi\",\n        productConnectors: \"Urun Baglantilari\",\n        productConnectorsTitle: \"Urun Baglantilari\",\n        productConnectorsDescription: \"Kampanyalar icin harici API'lerden urun cekmeyi yapilandirin\",\n        addConnector: \"Baglanti Ekle\",\n        editConnector: \"Baglanti Duzenle\",\n        connectorCreated: \"Baglanti basariyla olusturuldu\",\n        connectorUpdated: \"Baglanti basariyla guncellendi\",\n        connectorDeleted: \"Baglanti basariyla silindi\",\n        connectorError: \"Baglanti kaydedilemedi\",\n        noConnectors: \"Yapilandilmis baglanti yok\",\n        noConnectorsHint: \"Harici API'lerden urun cekmek icin baglanti ekleyin\",\n        connectorDialogDescription: \"API uÃ§ noktasini ve alan eslemelerini yapilandirin\",\n        connectorName: \"Baglanti Adi\",\n        connectorNamePlaceholder: \"orn: Urun API\",\n        connectorDescription: \"Aciklama\",\n        connectorDescriptionPlaceholder: \"Bu baglanti icin kisa aciklama\",\n        connectorEnabled: \"Etkin\",\n        requestMethod: \"Istek Metodu\",\n        requestUrl: \"Istek URL\",\n        requestUrlPlaceholder: \"https://api.example.com/products\",\n        requestParams: \"Istek Parametreleri\",\n        requestParamsHint: \"Arama sorgusu icin {{search}} yer tutucusunu kullanin\",\n        paramKey: \"Anahtar\",\n        paramValue: \"Deger\",\n        requestBody: \"Istek Govdesi (JSON)\",\n        requestBodyHint: \"POST/PUT istekleri icin. Arama sorgusu icin {{search}} kullanin.\",\n        responseParser: \"Yanit Ayristirici\",\n        responseParserHint: \"Urun dizisini ayiklamak icin JSONPath (orn: $.data.products)\",\n        fieldMappings: \"Alan Eslemeleri\",\n        fieldMappingsHint: \"API yanit alanlarini urun ozelliklerine esleyin\",\n        fieldName: \"Ad Alani\",\n        fieldImage: \"Gorsel Alani\",\n        fieldPrice: \"Fiyat Alani\",\n        fieldSku: \"SKU Alani\",\n        testConnector: \"Baglanti Test Et\",\n        testQueryPlaceholder: \"Arama sorgusu girin...\",\n        test: \"Test\",\n        testResults: \"Test Sonuclari\",\n        testSuccess: \"Baglanti testi basarili\",\n        testError: \"Baglanti testi basarisiz\",\n      },\n      impersonation: {\n        viewingAs: \"Goruntuleniyor\",\n        switchBack: \"SuperAdmin'e Don\",\n      },\n      organizationSettings: {\n        title: \"Organizasyon Ayarlari\",\n        organizationInfo: \"Organizasyon Bilgileri\",\n        organizationInfoDesc: \"Organizasyon detaylarinizi goruntuleyun\",\n        organizationName: \"Organizasyon Adi\",\n        organizationCode: \"Organizasyon Kodu\",\n        logoTitle: \"Organizasyon Logosu\",\n        logoDesc: \"Brosurlerinizi ve kampanyalarinizi kisisellesturmek icin organizasyonunuzun logosunu yukleyin\",\n        uploadLogo: \"Logo Yukle\",\n        removeLogo: \"Logoyu Kaldir\",\n        logoUploadSuccess: \"Logo basariyla yuklendi\",\n        logoUploadError: \"Logo yuklenemedi\",\n        logoRemoveSuccess: \"Logo basariyla kaldirildi\",\n        logoRemoveError: \"Logo kaldirilamadi\",\n        logoRequirements: \"Onerilen: Kare gorsel, en az 200x200px. Maks 5MB. Formatlar: JPG, PNG, GIF, WebP\",\n        fileTooLarge: \"Dosya cok buyuk. Maksimum boyut 5MB\",\n        invalidFileType: \"Gecersiz dosya turu. Sadece JPG, PNG, GIF ve WebP desteklenir\",\n      },\n      common: {\n        save: \"Kaydet\",\n        saving: \"Kaydediliyor...\",\n        cancel: \"Iptal\",\n        delete: \"Sil\",\n        edit: \"Duzenle\",\n        add: \"Ekle\",\n        create: \"Olustur\",\n        update: \"Guncelle\",\n        search: \"Ara\",\n        filter: \"Filtrele\",\n        loading: \"Yukleniyor...\",\n        noData: \"Veri bulunamadi\",\n        success: \"Basarili\",\n        error: \"Hata\",\n        confirm: \"Onayla\",\n        back: \"Geri\",\n        next: \"Ileri\",\n        submit: \"Gonder\",\n        close: \"Kapat\",\n        view: \"Gor\",\n        download: \"Indir\",\n        upload: \"Yukle\",\n        select: \"Sec\",\n        all: \"Tumu\",\n        none: \"Hicbiri\",\n        yes: \"Evet\",\n        no: \"Hayir\",\n        or: \"veya\",\n        and: \"ve\",\n        actions: \"Islemler\",\n        status: \"Durum\",\n        date: \"Tarih\",\n        name: \"Ad\",\n        description: \"Aciklama\",\n        required: \"Zorunlu\",\n        optional: \"Istege Bagli\",\n        enabled: \"Etkin\",\n        disabled: \"Devre Disi\",\n        uploading: \"Yukleniyor...\",\n        accessDenied: \"Bu sayfaya erisme izniniz yok\",\n      },\n      errors: {\n        required: \"Bu alan zorunludur\",\n        invalidEmail: \"Gecersiz e-posta adresi\",\n        passwordTooShort: \"Sifre en az 8 karakter olmali\",\n        passwordMismatch: \"Sifreler eslesmiyor\",\n        somethingWentWrong: \"Bir seyler ters gitti. Lutfen tekrar deneyin.\",\n        unauthorized: \"Bu islemi yapmaya yetkiniz yok\",\n        notFound: \"Kaynak bulunamadi\",\n        serverError: \"Sunucu hatasi. Lutfen daha sonra tekrar deneyin.\",\n      },\n    },\n  },\n  de: {\n    translation: {\n      app: {\n        name: \"e-Brochure\",\n        tagline: \"Erstellen Sie atemberaubende digitale Broschuren\",\n      },\n      nav: {\n        dashboard: \"Dashboard\",\n        products: \"Produkte\",\n        templates: \"Vorlagen\",\n        campaigns: \"Kampagnen\",\n        sharing: \"Teilen\",\n        messages: \"Nachrichten\",\n        suggestions: \"Vorschlage\",\n        tutorials: \"Anleitungen\",\n        account: \"Konto\",\n        users: \"Benutzer\",\n        organization: \"Organisation\",\n        tenants: \"Mandanten\",\n        settings: \"Einstellungen\",\n        superAdmin: \"Super Admin\",\n        logout: \"Abmelden\",\n      },\n      auth: {\n        login: \"Anmelden\",\n        register: \"Registrieren\",\n        forgotPassword: \"Passwort vergessen?\",\n        resetPassword: \"Passwort zurucksetzen\",\n        email: \"E-Mail\",\n        password: \"Passwort\",\n        confirmPassword: \"Passwort bestatigen\",\n        firstName: \"Vorname\",\n        lastName: \"Nachname\",\n        mobilePhone: \"Handynummer\",\n        captcha: \"Captcha\",\n        rememberMe: \"Angemeldet bleiben\",\n        noAccount: \"Noch kein Konto?\",\n        hasAccount: \"Bereits ein Konto?\",\n        signUp: \"Registrieren\",\n        signIn: \"Anmelden\",\n        twoFactor: \"Zwei-Faktor-Authentifizierung\",\n        enterCode: \"Geben Sie den 6-stelligen Code aus Ihrer Authenticator-App ein\",\n        scanQr: \"Scannen Sie diesen QR-Code mit Ihrer Authenticator-App\",\n        verifyCode: \"Code bestatigen\",\n        setupTotp: \"Zwei-Faktor-Authentifizierung einrichten\",\n        resetEmailSent: \"Falls diese E-Mail in unserem System existiert, wurde eine Passwortzurucksetzungs-E-Mail gesendet.\",\n        activationRequired: \"Bitte uberprufen Sie Ihre E-Mail, um Ihr Konto zu aktivieren.\",\n        invalidCredentials: \"Ungultige E-Mail oder Passwort\",\n      },\n      subscription: {\n        title: \"Wahlen Sie Ihren Plan\",\n        subtitle: \"Wahlen Sie den Plan, der am besten zu Ihnen passt\",\n        monthly: \"Monatlich\",\n        sixMonth: \"6 Monate\",\n        yearly: \"12 Monate\",\n        perMonth: \"/Monat\",\n        popular: \"Beliebteste\",\n        bestValue: \"Bester Wert\",\n        features: {\n          unlimitedCampaigns: \"Unbegrenzte Kampagnen\",\n          allTemplates: \"Zugang zu allen Vorlagen\",\n          prioritySupport: \"Prioritatssupport\",\n          teamMembers: \"Teammitglieder\",\n          analytics: \"Erweiterte Analysen\",\n          socialIntegration: \"Social-Media-Integration\",\n        },\n        selectPlan: \"Plan auswahlen\",\n        proceedToPayment: \"Zur Zahlung\",\n      },\n      dashboard: {\n        title: \"Dashboard\",\n        welcome: \"Willkommen zuruck\",\n        totalCampaigns: \"Gesamte Kampagnen\",\n        activeCampaigns: \"Aktive Kampagnen\",\n        totalProducts: \"Gesamte Produkte\",\n        totalTemplates: \"Gesamte Vorlagen\",\n        recentActivity: \"Letzte Aktivitaten\",\n        campaignStats: \"Kampagnenstatistiken\",\n        productUsage: \"Produktnutzung\",\n        quickActions: \"Schnellaktionen\",\n        createCampaign: \"Kampagne erstellen\",\n        addProduct: \"Produkt hinzufugen\",\n        viewTemplates: \"Vorlagen anzeigen\",\n      },\n      products: {\n        title: \"Produkte\",\n        addProduct: \"Produkt hinzufugen\",\n        editProduct: \"Produkt bearbeiten\",\n        deleteProduct: \"Produkt loschen\",\n        search: \"Produkte suchen...\",\n        filter: \"Filtern\",\n        category: \"Kategorie\",\n        allCategories: \"Alle Kategorien\",\n        name: \"Name\",\n        description: \"Beschreibung\",\n        price: \"Preis\",\n        discountPrice: \"Rabattpreis\",\n        discountPercentage: \"Rabatt %\",\n        sku: \"Artikelnummer\",\n        image: \"Bild\",\n        global: \"Global\",\n        tenant: \"Mandant\",\n        actions: \"Aktionen\",\n        noProducts: \"Keine Produkte gefunden\",\n        confirmDelete: \"Sind Sie sicher, dass Sie dieses Produkt loschen mochten?\",\n      },\n      templates: {\n        title: \"Vorlagen\",\n        addTemplate: \"Vorlage hinzufugen\",\n        editTemplate: \"Vorlage bearbeiten\",\n        deleteTemplate: \"Vorlage loschen\",\n        singlePage: \"Einzelseite\",\n        multiPage: \"Mehrseite\",\n        templateName: \"Vorlagenname\",\n        templateType: \"Vorlagentyp\",\n        font: \"Schriftart\",\n        textColor: \"Textfarbe\",\n        backgroundColor: \"Hintergrundfarbe\",\n        coverPage: \"Titelseite\",\n        innerPage: \"Innenseite\",\n        backPage: \"Ruckseite\",\n        priceTemplate: \"Preisvorlage\",\n        noTemplates: \"Keine Vorlagen gefunden\",\n        preview: \"Vorschau\",\n      },\n      campaigns: {\n        title: \"Kampagnen\",\n        createCampaign: \"Kampagne erstellen\",\n        editCampaign: \"Kampagne bearbeiten\",\n        deleteCampaign: \"Kampagne loschen\",\n        campaignName: \"Kampagnenname\",\n        description: \"Beschreibung\",\n        template: \"Vorlage\",\n        status: \"Status\",\n        startDate: \"Startdatum\",\n        endDate: \"Enddatum\",\n        draft: \"Entwurf\",\n        active: \"Aktiv\",\n        scheduled: \"Geplant\",\n        completed: \"Abgeschlossen\",\n        paused: \"Pausiert\",\n        noCampaigns: \"Keine Kampagnen gefunden\",\n        openEditor: \"Editor offnen\",\n        share: \"Teilen\",\n        duplicate: \"Duplizieren\",\n        saveCampaign: \"Kampagne speichern\",\n        enterCampaignName: \"Bitte geben Sie einen Namen fur Ihre Kampagne ein.\",\n        enterName: \"Kampagnenname eingeben...\",\n        nameRequired: \"Kampagnenname ist erforderlich\",\n        savedSuccessfully: \"Kampagne erfolgreich gespeichert\",\n        saveFailed: \"Kampagne konnte nicht gespeichert werden\",\n        untitled: \"Unbenannte Kampagne\",\n      },\n      editor: {\n        title: \"Broschureneditor\",\n        save: \"Speichern\",\n        undo: \"Ruckgangig\",\n        redo: \"Wiederholen\",\n        preview: \"Vorschau\",\n        publish: \"Veroffentlichen\",\n        addProduct: \"Produkt hinzufugen\",\n        addText: \"Text hinzufugen\",\n        addShape: \"Form hinzufugen\",\n        addImage: \"Bild hinzufugen\",\n        layers: \"Ebenen\",\n        properties: \"Eigenschaften\",\n        position: \"Position\",\n        size: \"Grose\",\n        rotation: \"Rotation\",\n        opacity: \"Deckkraft\",\n        pages: \"Seiten\",\n        addPage: \"Seite hinzufugen\",\n        deletePage: \"Seite loschen\",\n        zoom: \"Zoom\",\n      },\n      messages: {\n        title: \"Nachrichten\",\n        compose: \"Verfassen\",\n        inbox: \"Posteingang\",\n        sent: \"Gesendet\",\n        to: \"An\",\n        from: \"Von\",\n        subject: \"Betreff\",\n        message: \"Nachricht\",\n        send: \"Senden\",\n        reply: \"Antworten\",\n        noMessages: \"Keine Nachrichten gefunden\",\n        newMessage: \"Neue Nachricht\",\n        selectRecipient: \"Empfanger auswahlen\",\n      },\n      suggestions: {\n        title: \"Vorschlage\",\n        submit: \"Vorschlag einreichen\",\n        yourSuggestion: \"Ihr Vorschlag\",\n        suggestionTitle: \"Titel\",\n        suggestionContent: \"Beschreibung\",\n        status: \"Status\",\n        pending: \"Ausstehend\",\n        reviewed: \"Uberpruft\",\n        implemented: \"Umgesetzt\",\n        noSuggestions: \"Keine Vorschlage gefunden\",\n      },\n      tutorials: {\n        title: \"Anleitungen & Leitfaden\",\n        videos: \"Videos\",\n        documents: \"Dokumente\",\n        announcements: \"Ankundigungen\",\n        watch: \"Ansehen\",\n        download: \"Herunterladen\",\n        readMore: \"Mehr lesen\",\n        noTutorials: \"Keine Anleitungen gefunden\",\n      },\n      account: {\n        title: \"Kontoeinstellungen\",\n        profile: \"Profil\",\n        subscription: \"Abonnement\",\n        security: \"Sicherheit\",\n        updateProfile: \"Profil aktualisieren\",\n        changePassword: \"Passwort andern\",\n        currentPassword: \"Aktuelles Passwort\",\n        newPassword: \"Neues Passwort\",\n        confirmNewPassword: \"Neues Passwort bestatigen\",\n        twoFactorAuth: \"Zwei-Faktor-Authentifizierung\",\n        enable2fa: \"2FA aktivieren\",\n        disable2fa: \"2FA deaktivieren\",\n        subscriptionStatus: \"Abonnementstatus\",\n        expiresOn: \"Lauft ab am\",\n        upgradePlan: \"Plan upgraden\",\n      },\n      users: {\n        title: \"Benutzerverwaltung\",\n        addUser: \"Benutzer hinzufugen\",\n        editUser: \"Benutzer bearbeiten\",\n        deleteUser: \"Benutzer loschen\",\n        role: \"Rolle\",\n        tenantAdmin: \"Mandantenadministrator\",\n        tenantUser: \"Mandantenbenutzer\",\n        superAdmin: \"Superadministrator\",\n        active: \"Aktiv\",\n        inactive: \"Inaktiv\",\n        noUsers: \"Keine Benutzer gefunden\",\n        inviteUser: \"Benutzer einladen\",\n      },\n      tenants: {\n        title: \"Mandantenverwaltung\",\n        description: \"Alle Mandanten im System verwalten\",\n        create: \"Mandant erstellen\",\n        createTitle: \"Neuen Mandanten erstellen\",\n        editTitle: \"Mandant bearbeiten\",\n        deleteTitle: \"Mandant loschen\",\n        deleteDescription: \"Sind Sie sicher, dass Sie {{name}} loschen mochten? Diese Aktion kann nicht ruckgangig gemacht werden.\",\n        allTenants: \"Alle Mandanten\",\n        totalCount: \"{{count}} Mandant(en) insgesamt\",\n        name: \"Mandantenname\",\n        namePlaceholder: \"Mandantenname eingeben\",\n        slug: \"Slug\",\n        slugPlaceholder: \"mandanten-slug\",\n        code: \"Code\",\n        users: \"Benutzer\",\n        subscription: \"Abonnement\",\n        createdAt: \"Erstellt am\",\n        noTenants: \"Keine Mandanten gefunden\",\n        noSubscription: \"Kein Abonnement\",\n        createSuccess: \"Mandant erfolgreich erstellt\",\n        createError: \"Mandant konnte nicht erstellt werden\",\n        updateSuccess: \"Mandant erfolgreich aktualisiert\",\n        updateError: \"Mandant konnte nicht aktualisiert werden\",\n        deleteSuccess: \"Mandant erfolgreich geloscht\",\n        deleteError: \"Mandant konnte nicht geloscht werden\",\n      },\n      settings: {\n        title: \"Systemeinstellungen\",\n        description: \"Zahlungsgateway, Produktsynchronisierung und E-Mail-Einstellungen konfigurieren\",\n        paymentGateway: \"Zahlungsgateway\",\n        productSync: \"Produktsynchronisierung\",\n        emailSettings: \"E-Mail-Einstellungen\",\n        iyzicoTitle: \"iyzico Zahlungsgateway\",\n        iyzicoDescription: \"iyzico-Zahlungsintegration fur Abonnementzahlungen konfigurieren\",\n        testMode: \"Testmodus\",\n        apiKey: \"API-Schlussel\",\n        apiKeyPlaceholder: \"Geben Sie Ihren iyzico API-Schlussel ein\",\n        secretKey: \"Geheimer Schlussel\",\n        secretKeyPlaceholder: \"Geben Sie Ihren iyzico geheimen Schlussel ein\",\n        baseUrl: \"Basis-URL\",\n        productApiTitle: \"Produktsynchronisierungs-API\",\n        productApiDescription: \"Externe Produkt-API fur automatische Produktsynchronisierung konfigurieren\",\n        enableSync: \"Synchronisierung aktivieren\",\n        apiEndpoint: \"API-Endpunkt\",\n        httpMethod: \"HTTP-Methode\",\n        headers: \"Header (JSON)\",\n        syncSchedule: \"Synchronisierungszeitplan (Cron)\",\n        cronHint: \"Verwenden Sie das Cron-Format: Minute Stunde Tag Monat Wochentag (z.B. 0 0 * * * fur taglich um Mitternacht)\",\n        syncNow: \"Jetzt synchronisieren\",\n        saveSuccess: \"Einstellungen erfolgreich gespeichert\",\n        saveError: \"Einstellungen konnten nicht gespeichert werden\",\n        syncSuccess: \"Produktsynchronisierung erfolgreich gestartet\",\n        syncError: \"Produktsynchronisierung konnte nicht gestartet werden\",\n        emailTitle: \"E-Mail-Konfiguration\",\n        emailDescription: \"SMTP-Einstellungen fur E-Mail-Versand konfigurieren (Aktivierung, Passwortzurucksetzung, usw.)\",\n        enableEmail: \"E-Mail-Versand aktivieren\",\n        smtpHost: \"SMTP-Server\",\n        smtpPort: \"SMTP-Port\",\n        smtpUser: \"SMTP-Benutzername\",\n        smtpUserPlaceholder: \"Geben Sie Ihren SMTP-Benutzernamen ein\",\n        smtpPass: \"SMTP-Passwort\",\n        smtpPassPlaceholder: \"Geben Sie Ihr SMTP-Passwort ein\",\n        smtpFrom: \"Absender-E-Mail-Adresse\",\n        appUrl: \"Anwendungs-URL\",\n        appUrlHint: \"Die Basis-URL Ihrer Anwendung (wird in E-Mail-Links verwendet)\",\n        testEmail: \"Test-E-Mail senden\",\n        testEmailSuccess: \"Test-E-Mail erfolgreich gesendet\",\n        testEmailError: \"Test-E-Mail konnte nicht gesendet werden\",\n      },\n      organizationSettings: {\n        title: \"Organisationseinstellungen\",\n        organizationInfo: \"Organisationsinformationen\",\n        organizationInfoDesc: \"Sehen Sie Ihre Organisationsdetails\",\n        organizationName: \"Organisationsname\",\n        organizationCode: \"Organisationscode\",\n        logoTitle: \"Organisationslogo\",\n        logoDesc: \"Laden Sie das Logo Ihrer Organisation hoch, um Ihre Broschuren und Kampagnen zu personalisieren\",\n        uploadLogo: \"Logo hochladen\",\n        removeLogo: \"Logo entfernen\",\n        logoUploadSuccess: \"Logo erfolgreich hochgeladen\",\n        logoUploadError: \"Logo konnte nicht hochgeladen werden\",\n        logoRemoveSuccess: \"Logo erfolgreich entfernt\",\n        logoRemoveError: \"Logo konnte nicht entfernt werden\",\n        logoRequirements: \"Empfohlen: Quadratisches Bild, mindestens 200x200px. Max 5MB. Formate: JPG, PNG, GIF, WebP\",\n        fileTooLarge: \"Datei ist zu gros. Maximale Grose ist 5MB\",\n        invalidFileType: \"Ungultiger Dateityp. Nur JPG, PNG, GIF und WebP sind erlaubt\",\n      },\n      common: {\n        save: \"Speichern\",\n        saving: \"Speichern...\",\n        cancel: \"Abbrechen\",\n        delete: \"Loschen\",\n        edit: \"Bearbeiten\",\n        add: \"Hinzufugen\",\n        create: \"Erstellen\",\n        update: \"Aktualisieren\",\n        search: \"Suchen\",\n        filter: \"Filtern\",\n        loading: \"Laden...\",\n        noData: \"Keine Daten verfugbar\",\n        success: \"Erfolg\",\n        error: \"Fehler\",\n        confirm: \"Bestatigen\",\n        back: \"Zuruck\",\n        next: \"Weiter\",\n        submit: \"Absenden\",\n        close: \"Schliesen\",\n        view: \"Anzeigen\",\n        download: \"Herunterladen\",\n        upload: \"Hochladen\",\n        select: \"Auswahlen\",\n        all: \"Alle\",\n        none: \"Keine\",\n        yes: \"Ja\",\n        no: \"Nein\",\n        or: \"oder\",\n        and: \"und\",\n        actions: \"Aktionen\",\n        status: \"Status\",\n        date: \"Datum\",\n        name: \"Name\",\n        description: \"Beschreibung\",\n        required: \"Erforderlich\",\n        optional: \"Optional\",\n        enabled: \"Aktiviert\",\n        disabled: \"Deaktiviert\",\n        uploading: \"Hochladen...\",\n        accessDenied: \"Sie haben keine Berechtigung, auf diese Seite zuzugreifen\",\n      },\n      errors: {\n        required: \"Dieses Feld ist erforderlich\",\n        invalidEmail: \"Ungultige E-Mail-Adresse\",\n        passwordTooShort: \"Passwort muss mindestens 8 Zeichen haben\",\n        passwordMismatch: \"Passworter stimmen nicht uberein\",\n        somethingWentWrong: \"Etwas ist schiefgelaufen. Bitte versuchen Sie es erneut.\",\n        unauthorized: \"Sie sind nicht berechtigt, diese Aktion auszufuhren\",\n        notFound: \"Ressource nicht gefunden\",\n        serverError: \"Serverfehler. Bitte versuchen Sie es spater erneut.\",\n      },\n    },\n  },\n};\n\ni18n\n  .use(LanguageDetector)\n  .use(initReactI18next)\n  .init({\n    resources,\n    fallbackLng: \"en\",\n    interpolation: {\n      escapeValue: false,\n    },\n    detection: {\n      order: [\"localStorage\", \"navigator\"],\n      caches: [\"localStorage\"],\n    },\n  });\n\nexport default i18n;\n","path":null,"size_bytes":51487,"size_tokens":null},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","path":null,"size_bytes":8605,"size_tokens":null},"client/src/index.css":{"content":"@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n/* LIGHT MODE */\n:root {\n  --button-outline: rgba(0,0,0, .10);\n  --badge-outline: rgba(0,0,0, .05);\n  --opaque-button-border-intensity: -8;\n  --elevate-1: rgba(0,0,0, .03);\n  --elevate-2: rgba(0,0,0, .08);\n  --background: 0 0% 100%;\n  --foreground: 222 15% 12%;\n  --border: 220 13% 91%;\n  --card: 0 0% 98%;\n  --card-foreground: 222 15% 12%;\n  --card-border: 220 13% 94%;\n  --sidebar: 220 13% 96%;\n  --sidebar-foreground: 222 15% 12%;\n  --sidebar-border: 220 13% 92%;\n  --sidebar-primary: 217 91% 48%;\n  --sidebar-primary-foreground: 210 100% 98%;\n  --sidebar-accent: 220 14% 91%;\n  --sidebar-accent-foreground: 222 15% 12%;\n  --sidebar-ring: 217 91% 48%;\n  --popover: 0 0% 96%;\n  --popover-foreground: 222 15% 12%;\n  --popover-border: 220 13% 92%;\n  --primary: 217 91% 48%;\n  --primary-foreground: 210 100% 98%;\n  --secondary: 220 14% 93%;\n  --secondary-foreground: 222 15% 12%;\n  --muted: 220 14% 94%;\n  --muted-foreground: 215 16% 45%;\n  --accent: 220 14% 95%;\n  --accent-foreground: 222 15% 12%;\n  --destructive: 0 84% 48%;\n  --destructive-foreground: 0 0% 98%;\n  --input: 220 13% 85%;\n  --ring: 217 91% 48%;\n  --chart-1: 217 91% 48%;\n  --chart-2: 173 58% 39%;\n  --chart-3: 262 52% 47%;\n  --chart-4: 43 96% 56%;\n  --chart-5: 27 87% 57%;\n  --font-sans: Open Sans, sans-serif;\n  --font-serif: Georgia, serif;\n  --font-mono: Menlo, monospace;\n  --radius: .5rem;\n  --shadow-2xs: 0px 2px 0px 0px hsl(220 13% 13% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(220 13% 13% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(220 13% 13% / 0.00), 0px 1px 2px -1px hsl(220 13% 13% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(220 13% 13% / 0.00), 0px 1px 2px -1px hsl(220 13% 13% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(220 13% 13% / 0.00), 0px 2px 4px -1px hsl(220 13% 13% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(220 13% 13% / 0.00), 0px 4px 6px -1px hsl(220 13% 13% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(220 13% 13% / 0.00), 0px 8px 10px -1px hsl(220 13% 13% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(220 13% 13% / 0.00);\n  --tracking-normal: 0em;\n  --spacing: 0.25rem;\n\n/* Fallback for older browsers */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n.dark {\n  --button-outline: rgba(255,255,255, .10);\n  --badge-outline: rgba(255,255,255, .05);\n  --opaque-button-border-intensity: 9;\n  --elevate-1: rgba(255,255,255, .04);\n  --elevate-2: rgba(255,255,255, .09);\n  --background: 222 15% 8%;\n  --foreground: 210 20% 96%;\n  --border: 220 13% 18%;\n  --card: 222 15% 10%;\n  --card-foreground: 210 20% 96%;\n  --card-border: 220 13% 13%;\n  --sidebar: 220 13% 12%;\n  --sidebar-foreground: 210 20% 96%;\n  --sidebar-border: 220 13% 15%;\n  --sidebar-primary: 217 91% 55%;\n  --sidebar-primary-foreground: 210 100% 98%;\n  --sidebar-accent: 220 14% 15%;\n  --sidebar-accent-foreground: 210 20% 96%;\n  --sidebar-ring: 217 91% 55%;\n  --popover: 222 15% 13%;\n  --popover-foreground: 210 20% 96%;\n  --popover-border: 220 13% 16%;\n  --primary: 217 91% 48%;\n  --primary-foreground: 210 100% 98%;\n  --secondary: 220 14% 16%;\n  --secondary-foreground: 210 20% 96%;\n  --muted: 220 14% 14%;\n  --muted-foreground: 215 14% 65%;\n  --accent: 220 14% 13%;\n  --accent-foreground: 210 20% 96%;\n  --destructive: 0 84% 48%;\n  --destructive-foreground: 0 0% 98%;\n  --input: 220 13% 25%;\n  --ring: 217 91% 55%;\n  --chart-1: 217 91% 65%;\n  --chart-2: 173 58% 60%;\n  --chart-3: 262 52% 67%;\n  --chart-4: 43 96% 65%;\n  --chart-5: 27 87% 67%;\n  --shadow-2xs: 0px 2px 0px 0px hsl(220 13% 90% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(220 13% 90% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(220 13% 90% / 0.00), 0px 1px 2px -1px hsl(220 13% 90% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(220 13% 90% / 0.00), 0px 1px 2px -1px hsl(220 13% 90% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(220 13% 90% / 0.00), 0px 2px 4px -1px hsl(220 13% 90% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(220 13% 90% / 0.00), 0px 4px 6px -1px hsl(220 13% 90% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(220 13% 90% / 0.00), 0px 8px 10px -1px hsl(220 13% 90% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(220 13% 90% / 0.00);\n\n/* Fallback for older browsers */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n  }\n}\n\n/**\n * Using the elevate system.\n * Automatic contrast adjustment.\n *\n * <element className=\"hover-elevate\" />\n * <element className=\"active-elevate-2\" />\n *\n * // Using the tailwind utility when a data attribute is \"on\"\n * <element className=\"toggle-elevate data-[state=on]:toggle-elevated\" />\n * // Or manually controlling the toggle state\n * <element className=\"toggle-elevate toggle-elevated\" />\n *\n * Elevation systems have to handle many states.\n * - not-hovered, vs. hovered vs. active  (three mutually exclusive states)\n * - toggled or not\n * - focused or not (this is not handled with these utilities)\n *\n * Even without handling focused or not, this is six possible combinations that\n * need to be distinguished from eachother visually.\n */\n@layer utilities {\n\n  /* Hide ugly search cancel button in Chrome until we can style it properly */\n  input[type=\"search\"]::-webkit-search-cancel-button {\n    @apply hidden;\n  }\n\n  /* Placeholder styling for contentEditable div */\n  [contenteditable][data-placeholder]:empty::before {\n    content: attr(data-placeholder);\n    color: hsl(var(--muted-foreground));\n    pointer-events: none;\n  }\n\n  /* .no-default-hover-elevate/no-default-active-elevate is an escape hatch so consumers of\n   * buttons/badges can remove the automatic brightness adjustment on interactions\n   * and program their own. */\n  .no-default-hover-elevate {}\n\n  .no-default-active-elevate {}\n\n\n  /**\n   * Toggleable backgrounds go behind the content. Hoverable/active goes on top.\n   * This way they can stack/compound. Both will overlap the parent's borders!\n   * So borders will be automatically adjusted both on toggle, and hover/active,\n   * and they will be compounded.\n   */\n  .toggle-elevate::before,\n  .toggle-elevate-2::before {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    /*border-radius: inherit;   match rounded corners */\n    border-radius: inherit;\n    z-index: -1;\n    /* sits behind content but above backdrop */\n  }\n\n  .toggle-elevate.toggle-elevated::before {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.toggle-elevate::before {\n    inset: -1px;\n  }\n\n  /* Does not work on elements with overflow:hidden! */\n  .hover-elevate:not(.no-default-hover-elevate),\n  .active-elevate:not(.no-default-active-elevate),\n  .hover-elevate-2:not(.no-default-hover-elevate),\n  .active-elevate-2:not(.no-default-active-elevate) {\n    position: relative;\n    z-index: 0;\n  }\n\n  .hover-elevate:not(.no-default-hover-elevate)::after,\n  .active-elevate:not(.no-default-active-elevate)::after,\n  .hover-elevate-2:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:not(.no-default-active-elevate)::after {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    /*border-radius: inherit;   match rounded corners */\n    border-radius: inherit;\n    z-index: 999;\n    /* sits in front of content */\n  }\n\n  .hover-elevate:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-1);\n  }\n\n  .hover-elevate-2:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate-2:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate-2:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after {\n    inset: -1px;\n  }\n}\n","path":null,"size_bytes":10768,"size_tokens":null},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","path":null,"size_bytes":4281,"size_tokens":null},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","path":null,"size_bytes":80,"size_tokens":null},"client/src/pages/campaigns.tsx":{"content":"import { useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { Link } from \"wouter\";\nimport { \n  Plus, \n  Search, \n  LayoutGrid, \n  List, \n  Calendar, \n  MoreVertical,\n  Edit,\n  Trash2,\n  Copy,\n  Share2,\n  Eye\n} from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardFooter, CardHeader } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport type { Campaign } from \"@shared/schema\";\n\nexport default function CampaignsPage() {\n  const { t } = useTranslation();\n  const [viewMode, setViewMode] = useState<\"grid\" | \"list\">(\"grid\");\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [statusFilter, setStatusFilter] = useState<string>(\"all\");\n  const [deleteDialogOpen, setDeleteDialogOpen] = useState(false);\n  const [selectedCampaign, setSelectedCampaign] = useState<Campaign | null>(null);\n\n  const { data: campaigns, isLoading } = useQuery<Campaign[]>({\n    queryKey: [\"/api/campaigns\"],\n  });\n\n  const filteredCampaigns = campaigns?.filter((campaign) => {\n    const matchesSearch = campaign.name.toLowerCase().includes(searchQuery.toLowerCase());\n    const matchesStatus = statusFilter === \"all\" || campaign.status === statusFilter;\n    return matchesSearch && matchesStatus;\n  });\n\n  const getStatusBadgeVariant = (status: string) => {\n    switch (status) {\n      case \"active\":\n        return \"default\";\n      case \"draft\":\n        return \"secondary\";\n      case \"scheduled\":\n        return \"outline\";\n      case \"completed\":\n        return \"secondary\";\n      case \"paused\":\n        return \"destructive\";\n      default:\n        return \"secondary\";\n    }\n  };\n\n  const formatDate = (date: string | Date | null) => {\n    if (!date) return \"-\";\n    return new Date(date).toLocaleDateString();\n  };\n\n  const handleDelete = (campaign: Campaign) => {\n    setSelectedCampaign(campaign);\n    setDeleteDialogOpen(true);\n  };\n\n  const confirmDelete = () => {\n    setDeleteDialogOpen(false);\n    setSelectedCampaign(null);\n  };\n\n  return (\n    <div className=\"flex flex-col h-full\">\n      <div className=\"flex items-center justify-between gap-4 p-6 border-b\">\n        <h1 className=\"text-2xl font-semibold\" data-testid=\"text-page-title\">\n          {t(\"campaigns.title\")}\n        </h1>\n        <Button asChild data-testid=\"button-create-campaign\">\n          <Link href=\"/campaigns/new\">\n            <Plus className=\"h-4 w-4 mr-2\" />\n            {t(\"campaigns.createCampaign\")}\n          </Link>\n        </Button>\n      </div>\n\n      <div className=\"flex items-center gap-4 p-4 border-b\">\n        <div className=\"relative flex-1 max-w-sm\">\n          <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n          <Input\n            placeholder={t(\"common.search\")}\n            value={searchQuery}\n            onChange={(e) => setSearchQuery(e.target.value)}\n            className=\"pl-9\"\n            data-testid=\"input-search-campaigns\"\n          />\n        </div>\n        <Select value={statusFilter} onValueChange={setStatusFilter}>\n          <SelectTrigger className=\"w-[160px]\" data-testid=\"select-status-filter\">\n            <SelectValue placeholder={t(\"campaigns.status\")} />\n          </SelectTrigger>\n          <SelectContent>\n            <SelectItem value=\"all\">{t(\"common.all\")}</SelectItem>\n            <SelectItem value=\"draft\">{t(\"campaigns.draft\")}</SelectItem>\n            <SelectItem value=\"active\">{t(\"campaigns.active\")}</SelectItem>\n            <SelectItem value=\"scheduled\">{t(\"campaigns.scheduled\")}</SelectItem>\n            <SelectItem value=\"completed\">{t(\"campaigns.completed\")}</SelectItem>\n            <SelectItem value=\"paused\">{t(\"campaigns.paused\")}</SelectItem>\n          </SelectContent>\n        </Select>\n        <div className=\"flex gap-1 border rounded-md p-1\">\n          <Button\n            variant={viewMode === \"grid\" ? \"secondary\" : \"ghost\"}\n            size=\"icon\"\n            onClick={() => setViewMode(\"grid\")}\n            data-testid=\"button-view-grid\"\n          >\n            <LayoutGrid className=\"h-4 w-4\" />\n          </Button>\n          <Button\n            variant={viewMode === \"list\" ? \"secondary\" : \"ghost\"}\n            size=\"icon\"\n            onClick={() => setViewMode(\"list\")}\n            data-testid=\"button-view-list\"\n          >\n            <List className=\"h-4 w-4\" />\n          </Button>\n        </div>\n      </div>\n\n      <div className=\"flex-1 overflow-auto p-6\">\n        {isLoading ? (\n          viewMode === \"grid\" ? (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n              {Array.from({ length: 6 }).map((_, i) => (\n                <Card key={i}>\n                  <CardHeader className=\"p-0\">\n                    <Skeleton className=\"h-40 w-full rounded-t-lg\" />\n                  </CardHeader>\n                  <CardContent className=\"p-4\">\n                    <Skeleton className=\"h-5 w-3/4 mb-2\" />\n                    <Skeleton className=\"h-4 w-1/2\" />\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          ) : (\n            <div className=\"space-y-2\">\n              {Array.from({ length: 5 }).map((_, i) => (\n                <Skeleton key={i} className=\"h-16 w-full\" />\n              ))}\n            </div>\n          )\n        ) : !filteredCampaigns?.length ? (\n          <div className=\"flex flex-col items-center justify-center h-64 text-muted-foreground\">\n            <Calendar className=\"h-12 w-12 mb-4\" />\n            <p>{t(\"campaigns.noCampaigns\")}</p>\n            <Button asChild className=\"mt-4\" data-testid=\"button-create-first-campaign\">\n              <Link href=\"/campaigns/new\">\n                <Plus className=\"h-4 w-4 mr-2\" />\n                {t(\"campaigns.createCampaign\")}\n              </Link>\n            </Button>\n          </div>\n        ) : viewMode === \"grid\" ? (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {filteredCampaigns.map((campaign) => (\n              <Card key={campaign.id} className=\"overflow-hidden\" data-testid={`card-campaign-${campaign.id}`}>\n                <CardHeader className=\"p-0 relative\">\n                  <div className=\"h-40 bg-muted flex items-center justify-center\">\n                    {campaign.thumbnailUrl ? (\n                      <img\n                        src={campaign.thumbnailUrl}\n                        alt={campaign.name}\n                        className=\"w-full h-full object-cover\"\n                      />\n                    ) : (\n                      <Calendar className=\"h-12 w-12 text-muted-foreground\" />\n                    )}\n                  </div>\n                  <Badge\n                    variant={getStatusBadgeVariant(campaign.status)}\n                    className=\"absolute top-2 right-2\"\n                  >\n                    {t(`campaigns.${campaign.status}`)}\n                  </Badge>\n                </CardHeader>\n                <CardContent className=\"p-4\">\n                  <h3 className=\"font-medium truncate\" data-testid={`text-campaign-name-${campaign.id}`}>\n                    {campaign.name}\n                  </h3>\n                  {campaign.description && (\n                    <p className=\"text-sm text-muted-foreground line-clamp-2 mt-1\">\n                      {campaign.description}\n                    </p>\n                  )}\n                  <div className=\"flex items-center gap-2 mt-3 text-xs text-muted-foreground\">\n                    <Calendar className=\"h-3 w-3\" />\n                    <span>\n                      {formatDate(campaign.startDate)} - {formatDate(campaign.endDate)}\n                    </span>\n                  </div>\n                </CardContent>\n                <CardFooter className=\"p-4 pt-0 flex justify-between gap-2\">\n                  <Button variant=\"outline\" size=\"sm\" asChild data-testid={`button-view-campaign-${campaign.id}`}>\n                    <Link href={`/campaigns/${campaign.id}`}>\n                      <Eye className=\"h-4 w-4 mr-1\" />\n                      {t(\"common.view\")}\n                    </Link>\n                  </Button>\n                  <Button size=\"sm\" asChild data-testid={`button-edit-campaign-${campaign.id}`}>\n                    <Link href={`/campaigns/${campaign.id}/edit`}>\n                      <Edit className=\"h-4 w-4 mr-1\" />\n                      {t(\"campaigns.openEditor\")}\n                    </Link>\n                  </Button>\n                  <DropdownMenu>\n                    <DropdownMenuTrigger asChild>\n                      <Button variant=\"ghost\" size=\"icon\" data-testid={`button-campaign-menu-${campaign.id}`}>\n                        <MoreVertical className=\"h-4 w-4\" />\n                      </Button>\n                    </DropdownMenuTrigger>\n                    <DropdownMenuContent align=\"end\">\n                      <DropdownMenuItem asChild>\n                        <Link href={`/sharing?campaign=${campaign.id}`}>\n                          <Share2 className=\"h-4 w-4 mr-2\" />\n                          {t(\"campaigns.share\")}\n                        </Link>\n                      </DropdownMenuItem>\n                      <DropdownMenuItem>\n                        <Copy className=\"h-4 w-4 mr-2\" />\n                        {t(\"campaigns.duplicate\")}\n                      </DropdownMenuItem>\n                      <DropdownMenuSeparator />\n                      <DropdownMenuItem\n                        className=\"text-destructive\"\n                        onClick={() => handleDelete(campaign)}\n                      >\n                        <Trash2 className=\"h-4 w-4 mr-2\" />\n                        {t(\"campaigns.deleteCampaign\")}\n                      </DropdownMenuItem>\n                    </DropdownMenuContent>\n                  </DropdownMenu>\n                </CardFooter>\n              </Card>\n            ))}\n          </div>\n        ) : (\n          <Table>\n            <TableHeader>\n              <TableRow>\n                <TableHead>{t(\"campaigns.campaignName\")}</TableHead>\n                <TableHead>{t(\"campaigns.status\")}</TableHead>\n                <TableHead>{t(\"campaigns.startDate\")}</TableHead>\n                <TableHead>{t(\"campaigns.endDate\")}</TableHead>\n                <TableHead className=\"text-right\">{t(\"common.actions\")}</TableHead>\n              </TableRow>\n            </TableHeader>\n            <TableBody>\n              {filteredCampaigns.map((campaign) => (\n                <TableRow key={campaign.id} data-testid={`row-campaign-${campaign.id}`}>\n                  <TableCell className=\"font-medium\">{campaign.name}</TableCell>\n                  <TableCell>\n                    <Badge variant={getStatusBadgeVariant(campaign.status)}>\n                      {t(`campaigns.${campaign.status}`)}\n                    </Badge>\n                  </TableCell>\n                  <TableCell>{formatDate(campaign.startDate)}</TableCell>\n                  <TableCell>{formatDate(campaign.endDate)}</TableCell>\n                  <TableCell className=\"text-right\">\n                    <div className=\"flex justify-end gap-2\">\n                      <Button variant=\"outline\" size=\"sm\" asChild>\n                        <Link href={`/campaigns/${campaign.id}/edit`}>\n                          <Edit className=\"h-4 w-4\" />\n                        </Link>\n                      </Button>\n                      <DropdownMenu>\n                        <DropdownMenuTrigger asChild>\n                          <Button variant=\"ghost\" size=\"icon\">\n                            <MoreVertical className=\"h-4 w-4\" />\n                          </Button>\n                        </DropdownMenuTrigger>\n                        <DropdownMenuContent align=\"end\">\n                          <DropdownMenuItem asChild>\n                            <Link href={`/sharing?campaign=${campaign.id}`}>\n                              <Share2 className=\"h-4 w-4 mr-2\" />\n                              {t(\"campaigns.share\")}\n                            </Link>\n                          </DropdownMenuItem>\n                          <DropdownMenuItem>\n                            <Copy className=\"h-4 w-4 mr-2\" />\n                            {t(\"campaigns.duplicate\")}\n                          </DropdownMenuItem>\n                          <DropdownMenuSeparator />\n                          <DropdownMenuItem\n                            className=\"text-destructive\"\n                            onClick={() => handleDelete(campaign)}\n                          >\n                            <Trash2 className=\"h-4 w-4 mr-2\" />\n                            {t(\"campaigns.deleteCampaign\")}\n                          </DropdownMenuItem>\n                        </DropdownMenuContent>\n                      </DropdownMenu>\n                    </div>\n                  </TableCell>\n                </TableRow>\n              ))}\n            </TableBody>\n          </Table>\n        )}\n      </div>\n\n      <Dialog open={deleteDialogOpen} onOpenChange={setDeleteDialogOpen}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>{t(\"campaigns.deleteCampaign\")}</DialogTitle>\n            <DialogDescription>\n              {t(\"products.confirmDelete\")}\n            </DialogDescription>\n          </DialogHeader>\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => setDeleteDialogOpen(false)}>\n              {t(\"common.cancel\")}\n            </Button>\n            <Button variant=\"destructive\" onClick={confirmDelete} data-testid=\"button-confirm-delete\">\n              {t(\"common.delete\")}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","path":null,"size_bytes":14367,"size_tokens":null},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","path":null,"size_bytes":4120,"size_tokens":null},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"shadcn-card rounded-xl border bg-card border-card-border text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n));\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n));\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n));\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardDescription,\n  CardContent,\n}\n","path":null,"size_bytes":1904,"size_tokens":null},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","path":null,"size_bytes":791,"size_tokens":null},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","path":null,"size_bytes":2712,"size_tokens":null},"client/src/components/theme-toggle.tsx":{"content":"import { Moon, Sun } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { useTheme } from \"@/lib/theme-provider\";\n\nexport function ThemeToggle() {\n  const { theme, toggleTheme } = useTheme();\n\n  return (\n    <Button\n      variant=\"ghost\"\n      size=\"icon\"\n      onClick={toggleTheme}\n      data-testid=\"button-theme-toggle\"\n    >\n      {theme === \"light\" ? (\n        <Moon className=\"h-5 w-5\" />\n      ) : (\n        <Sun className=\"h-5 w-5\" />\n      )}\n      <span className=\"sr-only\">Toggle theme</span>\n    </Button>\n  );\n}\n","path":null,"size_bytes":552,"size_tokens":null},"client/src/App.tsx":{"content":"import { Switch, Route, Redirect, useLocation } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { ThemeProvider } from \"@/lib/theme-provider\";\nimport { AuthProvider, useAuth } from \"@/lib/auth-context\";\nimport { SidebarProvider, SidebarTrigger } from \"@/components/ui/sidebar\";\nimport { AppSidebar } from \"@/components/app-sidebar\";\nimport { ThemeToggle } from \"@/components/theme-toggle\";\nimport { LanguageSelector } from \"@/components/language-selector\";\nimport { useTranslation } from \"react-i18next\";\nimport \"@/lib/i18n\";\n\nimport NotFound from \"@/pages/not-found\";\nimport LoginPage from \"@/pages/login\";\nimport RegisterPage from \"@/pages/register\";\nimport ResetPasswordPage from \"@/pages/reset-password\";\nimport VerifyEmailPage from \"@/pages/verify-email\";\nimport Setup2FAPage from \"@/pages/setup-2fa\";\nimport SetupTenantPage from \"@/pages/setup-tenant\";\nimport SubscriptionPage from \"@/pages/subscription\";\nimport DashboardPage from \"@/pages/dashboard\";\nimport ProductsPage from \"@/pages/products\";\nimport TemplatesPage from \"@/pages/templates\";\nimport CampaignsPage from \"@/pages/campaigns\";\nimport CampaignEditorPage from \"@/pages/campaign-editor\";\nimport MessagesPage from \"@/pages/messages\";\nimport SuggestionsPage from \"@/pages/suggestions\";\nimport TutorialsPage from \"@/pages/tutorials\";\nimport AccountPage from \"@/pages/account\";\nimport UsersPage from \"@/pages/users\";\nimport SharingPage from \"@/pages/sharing\";\nimport TenantsPage from \"@/pages/tenants\";\nimport SettingsPage from \"@/pages/settings\";\nimport OrganizationSettingsPage from \"@/pages/organization-settings\";\n\nfunction ProtectedRoute({ component: Component }: { component: () => JSX.Element }) {\n  const { isAuthenticated, isLoading } = useAuth();\n  \n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center h-screen\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary\"></div>\n      </div>\n    );\n  }\n  \n  if (!isAuthenticated) {\n    return <Redirect to=\"/login\" />;\n  }\n  \n  return <Component />;\n}\n\nfunction AuthRoute({ component: Component }: { component: () => JSX.Element }) {\n  const { isAuthenticated, isLoading } = useAuth();\n  \n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center h-screen\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary\"></div>\n      </div>\n    );\n  }\n  \n  if (isAuthenticated) {\n    return <Redirect to=\"/dashboard\" />;\n  }\n  \n  return <Component />;\n}\n\nfunction PublicRoutes() {\n  return (\n    <Switch>\n      <Route path=\"/\">\n        <Redirect to=\"/login\" />\n      </Route>\n      <Route path=\"/login\" component={() => <AuthRoute component={LoginPage} />} />\n      <Route path=\"/register\" component={() => <AuthRoute component={RegisterPage} />} />\n      <Route path=\"/reset-password\" component={() => <AuthRoute component={ResetPasswordPage} />} />\n      <Route path=\"/verify-email\" component={VerifyEmailPage} />\n      <Route path=\"/setup-2fa\" component={Setup2FAPage} />\n      <Route path=\"/setup-tenant\" component={SetupTenantPage} />\n      <Route path=\"/subscription\" component={SubscriptionPage} />\n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\nfunction ProtectedRoutes() {\n  return (\n    <Switch>\n      <Route path=\"/subscription\" component={() => <ProtectedRoute component={SubscriptionPage} />} />\n      <Route path=\"/dashboard\" component={() => <ProtectedRoute component={DashboardPage} />} />\n      <Route path=\"/products\" component={() => <ProtectedRoute component={ProductsPage} />} />\n      <Route path=\"/templates\" component={() => <ProtectedRoute component={TemplatesPage} />} />\n      <Route path=\"/campaigns\" component={() => <ProtectedRoute component={CampaignsPage} />} />\n      <Route path=\"/campaigns/new\" component={() => <ProtectedRoute component={CampaignEditorPage} />} />\n      <Route path=\"/campaigns/:id/edit\" component={() => <ProtectedRoute component={CampaignEditorPage} />} />\n      <Route path=\"/sharing\" component={() => <ProtectedRoute component={SharingPage} />} />\n      <Route path=\"/messages\" component={() => <ProtectedRoute component={MessagesPage} />} />\n      <Route path=\"/suggestions\" component={() => <ProtectedRoute component={SuggestionsPage} />} />\n      <Route path=\"/tutorials\" component={() => <ProtectedRoute component={TutorialsPage} />} />\n      <Route path=\"/account\" component={() => <ProtectedRoute component={AccountPage} />} />\n      <Route path=\"/users\" component={() => <ProtectedRoute component={UsersPage} />} />\n      <Route path=\"/organization\" component={() => <ProtectedRoute component={OrganizationSettingsPage} />} />\n      <Route path=\"/tenants\" component={() => <ProtectedRoute component={TenantsPage} />} />\n      <Route path=\"/settings\" component={() => <ProtectedRoute component={SettingsPage} />} />\n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\nfunction ImpersonationBanner() {\n  const { isImpersonating, originalSuperAdmin, stopImpersonation, user } = useAuth();\n  const [, setLocation] = useLocation();\n  const { t } = useTranslation();\n\n  if (!isImpersonating || !originalSuperAdmin) {\n    return null;\n  }\n\n  const handleSwitchBack = () => {\n    stopImpersonation();\n    setLocation(\"/tenants\");\n  };\n\n  return (\n    <div className=\"bg-amber-500 dark:bg-amber-600 text-white px-4 py-2 flex items-center justify-between gap-4 flex-wrap\">\n      <span className=\"text-sm font-medium\" data-testid=\"text-impersonation-info\">\n        {t(\"impersonation.viewingAs\")}: {user?.firstName} {user?.lastName} ({user?.email})\n      </span>\n      <button\n        onClick={handleSwitchBack}\n        className=\"text-sm font-medium bg-white/20 px-3 py-1 rounded-md\"\n        data-testid=\"button-switch-back\"\n      >\n        {t(\"impersonation.switchBack\")}\n      </button>\n    </div>\n  );\n}\n\nfunction AppLayout() {\n  const { isAuthenticated, user, isImpersonating } = useAuth();\n  \n  const sidebarStyle = {\n    \"--sidebar-width\": \"16rem\",\n    \"--sidebar-width-icon\": \"3rem\",\n  } as React.CSSProperties;\n\n  if (!isAuthenticated) {\n    return <PublicRoutes />;\n  }\n\n  if (user && !user.tenantId && user.role !== \"super_admin\" && !isImpersonating) {\n    return (\n      <Switch>\n        <Route path=\"/setup-tenant\" component={SetupTenantPage} />\n        <Route>\n          <Redirect to=\"/setup-tenant\" />\n        </Route>\n      </Switch>\n    );\n  }\n\n  return (\n    <SidebarProvider style={sidebarStyle}>\n      <div className=\"flex h-screen w-full\">\n        <AppSidebar />\n        <div className=\"flex flex-col flex-1 overflow-hidden\">\n          <ImpersonationBanner />\n          <header className=\"flex items-center justify-between gap-4 px-4 py-2 border-b bg-background sticky top-0 z-40\">\n            <SidebarTrigger data-testid=\"button-sidebar-toggle\" />\n            <div className=\"flex items-center gap-2\">\n              <LanguageSelector />\n              <ThemeToggle />\n            </div>\n          </header>\n          <main className=\"flex-1 overflow-auto\">\n            <Switch>\n              <Route path=\"/\">\n                <Redirect to=\"/dashboard\" />\n              </Route>\n            </Switch>\n            <ProtectedRoutes />\n          </main>\n        </div>\n      </div>\n    </SidebarProvider>\n  );\n}\n\nfunction App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <ThemeProvider>\n        <AuthProvider>\n          <TooltipProvider>\n            <AppLayout />\n            <Toaster />\n          </TooltipProvider>\n        </AuthProvider>\n      </ThemeProvider>\n    </QueryClientProvider>\n  );\n}\n\nexport default App;\n","path":null,"size_bytes":7759,"size_tokens":null},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","path":null,"size_bytes":2695,"size_tokens":null},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(`\n      after:content-[''] after:block after:absolute after:inset-0 after:rounded-full after:pointer-events-none after:border after:border-black/10 dark:after:border-white/10\n      relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full`,\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","path":null,"size_bytes":1592,"size_tokens":null},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \".5625rem\", /* 9px */\n        md: \".375rem\", /* 6px */\n        sm: \".1875rem\", /* 3px */\n      },\n      colors: {\n        // Flat / base colors (regular buttons)\n        background: \"hsl(var(--background) / <alpha-value>)\",\n        foreground: \"hsl(var(--foreground) / <alpha-value>)\",\n        border: \"hsl(var(--border) / <alpha-value>)\",\n        input: \"hsl(var(--input) / <alpha-value>)\",\n        card: {\n          DEFAULT: \"hsl(var(--card) / <alpha-value>)\",\n          foreground: \"hsl(var(--card-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--card-border) / <alpha-value>)\",\n        },\n        popover: {\n          DEFAULT: \"hsl(var(--popover) / <alpha-value>)\",\n          foreground: \"hsl(var(--popover-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--popover-border) / <alpha-value>)\",\n        },\n        primary: {\n          DEFAULT: \"hsl(var(--primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--primary-foreground) / <alpha-value>)\",\n          border: \"var(--primary-border)\",\n        },\n        secondary: {\n          DEFAULT: \"hsl(var(--secondary) / <alpha-value>)\",\n          foreground: \"hsl(var(--secondary-foreground) / <alpha-value>)\",\n          border: \"var(--secondary-border)\",\n        },\n        muted: {\n          DEFAULT: \"hsl(var(--muted) / <alpha-value>)\",\n          foreground: \"hsl(var(--muted-foreground) / <alpha-value>)\",\n          border: \"var(--muted-border)\",\n        },\n        accent: {\n          DEFAULT: \"hsl(var(--accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--accent-foreground) / <alpha-value>)\",\n          border: \"var(--accent-border)\",\n        },\n        destructive: {\n          DEFAULT: \"hsl(var(--destructive) / <alpha-value>)\",\n          foreground: \"hsl(var(--destructive-foreground) / <alpha-value>)\",\n          border: \"var(--destructive-border)\",\n        },\n        ring: \"hsl(var(--ring) / <alpha-value>)\",\n        chart: {\n          \"1\": \"hsl(var(--chart-1) / <alpha-value>)\",\n          \"2\": \"hsl(var(--chart-2) / <alpha-value>)\",\n          \"3\": \"hsl(var(--chart-3) / <alpha-value>)\",\n          \"4\": \"hsl(var(--chart-4) / <alpha-value>)\",\n          \"5\": \"hsl(var(--chart-5) / <alpha-value>)\",\n        },\n        sidebar: {\n          ring: \"hsl(var(--sidebar-ring) / <alpha-value>)\",\n          DEFAULT: \"hsl(var(--sidebar) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--sidebar-border) / <alpha-value>)\",\n        },\n        \"sidebar-primary\": {\n          DEFAULT: \"hsl(var(--sidebar-primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-primary-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-primary-border)\",\n        },\n        \"sidebar-accent\": {\n          DEFAULT: \"hsl(var(--sidebar-accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-accent-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-accent-border)\"\n        },\n        status: {\n          online: \"rgb(34 197 94)\",\n          away: \"rgb(245 158 11)\",\n          busy: \"rgb(239 68 68)\",\n          offline: \"rgb(156 163 175)\",\n        },\n      },\n      fontFamily: {\n        sans: [\"Inter\", \"var(--font-sans)\", \"system-ui\", \"sans-serif\"],\n        serif: [\"var(--font-serif)\"],\n        mono: [\"JetBrains Mono\", \"var(--font-mono)\", \"monospace\"],\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: { height: \"0\" },\n          to: { height: \"var(--radix-accordion-content-height)\" },\n        },\n        \"accordion-up\": {\n          from: { height: \"var(--radix-accordion-content-height)\" },\n          to: { height: \"0\" },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","path":null,"size_bytes":4117,"size_tokens":null},"server/email.ts":{"content":"import nodemailer from \"nodemailer\";\nimport crypto from \"crypto\";\nimport type { IStorage } from \"./storage\";\n\ninterface EmailConfig {\n  smtpHost: string;\n  smtpPort: number;\n  smtpUser: string;\n  smtpPass: string;\n  smtpFrom: string;\n  appUrl: string;\n  isEnabled: boolean;\n}\n\nasync function getEmailConfig(storage: IStorage): Promise<EmailConfig | null> {\n  try {\n    const config = await storage.getSystemConfig(\"email\");\n    if (config?.value) {\n      return config.value as EmailConfig;\n    }\n  } catch (error) {\n    console.error(\"Failed to get email config:\", error);\n  }\n  return null;\n}\n\nfunction createTransporter(config: EmailConfig) {\n  return nodemailer.createTransport({\n    host: config.smtpHost,\n    port: config.smtpPort,\n    secure: config.smtpPort === 465,\n    auth: {\n      user: config.smtpUser,\n      pass: config.smtpPass,\n    },\n  });\n}\n\nexport function generateActivationToken(): string {\n  return crypto.randomBytes(32).toString(\"hex\");\n}\n\nexport function getActivationTokenExpiry(): Date {\n  return new Date(Date.now() + 24 * 60 * 60 * 1000);\n}\n\nexport async function sendActivationEmail(\n  email: string,\n  firstName: string,\n  activationToken: string,\n  storage: IStorage\n): Promise<boolean> {\n  const config = await getEmailConfig(storage);\n  \n  if (!config || !config.isEnabled) {\n    console.warn(\"Email not configured or disabled. Email not sent.\");\n    const fallbackUrl = process.env.APP_URL || \"http://localhost:5000\";\n    console.log(\"Activation URL (for testing):\", `${fallbackUrl}/verify-email?token=${activationToken}`);\n    return true;\n  }\n\n  const activationUrl = `${config.appUrl}/verify-email?token=${activationToken}`;\n\n  const mailOptions = {\n    from: config.smtpFrom,\n    to: email,\n    subject: \"Verify Your Email Address - eBrochure\",\n    html: `\n      <!DOCTYPE html>\n      <html>\n      <head>\n        <meta charset=\"utf-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n      </head>\n      <body style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto; padding: 20px;\">\n        <div style=\"background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 30px; text-align: center; border-radius: 8px 8px 0 0;\">\n          <h1 style=\"color: white; margin: 0; font-size: 28px;\">Welcome to eBrochure</h1>\n        </div>\n        <div style=\"background: #f9f9f9; padding: 30px; border-radius: 0 0 8px 8px;\">\n          <h2 style=\"color: #333; margin-top: 0;\">Hi ${firstName},</h2>\n          <p>Thank you for registering with eBrochure. Please verify your email address by clicking the button below:</p>\n          <div style=\"text-align: center; margin: 30px 0;\">\n            <a href=\"${activationUrl}\" style=\"background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 14px 30px; text-decoration: none; border-radius: 6px; font-weight: bold; display: inline-block;\">Verify Email Address</a>\n          </div>\n          <p style=\"color: #666; font-size: 14px;\">If the button doesn't work, copy and paste this link into your browser:</p>\n          <p style=\"word-break: break-all; color: #667eea; font-size: 14px;\">${activationUrl}</p>\n          <hr style=\"border: none; border-top: 1px solid #ddd; margin: 30px 0;\">\n          <p style=\"color: #888; font-size: 12px;\">This link will expire in 24 hours. If you didn't create an account with eBrochure, please ignore this email.</p>\n        </div>\n      </body>\n      </html>\n    `,\n    text: `\nHi ${firstName},\n\nThank you for registering with eBrochure. Please verify your email address by clicking the link below:\n\n${activationUrl}\n\nThis link will expire in 24 hours.\n\nIf you didn't create an account with eBrochure, please ignore this email.\n    `,\n  };\n\n  try {\n    if (!config.smtpHost || !config.smtpUser || !config.smtpPass) {\n      console.warn(\"SMTP credentials not configured. Email not sent.\");\n      console.log(\"Activation URL (for testing):\", activationUrl);\n      return true;\n    }\n\n    const transporter = createTransporter(config);\n    await transporter.sendMail(mailOptions);\n    console.log(`Activation email sent to ${email}`);\n    return true;\n  } catch (error) {\n    console.error(\"Failed to send activation email:\", error);\n    return false;\n  }\n}\n\nexport async function sendPasswordResetEmail(\n  email: string,\n  firstName: string,\n  resetToken: string,\n  storage: IStorage\n): Promise<boolean> {\n  const config = await getEmailConfig(storage);\n  \n  if (!config || !config.isEnabled) {\n    console.warn(\"Email not configured or disabled. Email not sent.\");\n    const fallbackUrl = process.env.APP_URL || \"http://localhost:5000\";\n    console.log(\"Reset URL (for testing):\", `${fallbackUrl}/reset-password?token=${resetToken}`);\n    return true;\n  }\n\n  const resetUrl = `${config.appUrl}/reset-password?token=${resetToken}`;\n\n  const mailOptions = {\n    from: config.smtpFrom,\n    to: email,\n    subject: \"Reset Your Password - eBrochure\",\n    html: `\n      <!DOCTYPE html>\n      <html>\n      <head>\n        <meta charset=\"utf-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n      </head>\n      <body style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto; padding: 20px;\">\n        <div style=\"background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 30px; text-align: center; border-radius: 8px 8px 0 0;\">\n          <h1 style=\"color: white; margin: 0; font-size: 28px;\">eBrochure</h1>\n        </div>\n        <div style=\"background: #f9f9f9; padding: 30px; border-radius: 0 0 8px 8px;\">\n          <h2 style=\"color: #333; margin-top: 0;\">Hi ${firstName},</h2>\n          <p>We received a request to reset your password. Click the button below to create a new password:</p>\n          <div style=\"text-align: center; margin: 30px 0;\">\n            <a href=\"${resetUrl}\" style=\"background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 14px 30px; text-decoration: none; border-radius: 6px; font-weight: bold; display: inline-block;\">Reset Password</a>\n          </div>\n          <p style=\"color: #666; font-size: 14px;\">If the button doesn't work, copy and paste this link into your browser:</p>\n          <p style=\"word-break: break-all; color: #667eea; font-size: 14px;\">${resetUrl}</p>\n          <hr style=\"border: none; border-top: 1px solid #ddd; margin: 30px 0;\">\n          <p style=\"color: #888; font-size: 12px;\">This link will expire in 1 hour. If you didn't request a password reset, please ignore this email.</p>\n        </div>\n      </body>\n      </html>\n    `,\n    text: `\nHi ${firstName},\n\nWe received a request to reset your password. Click the link below to create a new password:\n\n${resetUrl}\n\nThis link will expire in 1 hour.\n\nIf you didn't request a password reset, please ignore this email.\n    `,\n  };\n\n  try {\n    if (!config.smtpHost || !config.smtpUser || !config.smtpPass) {\n      console.warn(\"SMTP credentials not configured. Email not sent.\");\n      console.log(\"Reset URL (for testing):\", resetUrl);\n      return true;\n    }\n\n    const transporter = createTransporter(config);\n    await transporter.sendMail(mailOptions);\n    console.log(`Password reset email sent to ${email}`);\n    return true;\n  } catch (error) {\n    console.error(\"Failed to send password reset email:\", error);\n    return false;\n  }\n}\n\nexport async function sendTestEmail(\n  email: string,\n  firstName: string,\n  storage: IStorage\n): Promise<boolean> {\n  const config = await getEmailConfig(storage);\n  \n  if (!config || !config.isEnabled) {\n    console.warn(\"Email not configured or disabled.\");\n    return false;\n  }\n\n  const mailOptions = {\n    from: config.smtpFrom,\n    to: email,\n    subject: \"Test Email - eBrochure\",\n    html: `\n      <!DOCTYPE html>\n      <html>\n      <head>\n        <meta charset=\"utf-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n      </head>\n      <body style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto; padding: 20px;\">\n        <div style=\"background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 30px; text-align: center; border-radius: 8px 8px 0 0;\">\n          <h1 style=\"color: white; margin: 0; font-size: 28px;\">eBrochure</h1>\n        </div>\n        <div style=\"background: #f9f9f9; padding: 30px; border-radius: 0 0 8px 8px;\">\n          <h2 style=\"color: #333; margin-top: 0;\">Hi ${firstName},</h2>\n          <p>This is a test email to verify your email configuration is working correctly.</p>\n          <p style=\"color: #666;\">If you received this email, your SMTP settings are configured correctly!</p>\n          <hr style=\"border: none; border-top: 1px solid #ddd; margin: 30px 0;\">\n          <p style=\"color: #888; font-size: 12px;\">This email was sent from eBrochure System Settings.</p>\n        </div>\n      </body>\n      </html>\n    `,\n    text: `\nHi ${firstName},\n\nThis is a test email to verify your email configuration is working correctly.\n\nIf you received this email, your SMTP settings are configured correctly!\n\nThis email was sent from eBrochure System Settings.\n    `,\n  };\n\n  try {\n    if (!config.smtpHost || !config.smtpUser || !config.smtpPass) {\n      console.warn(\"SMTP credentials not configured.\");\n      return false;\n    }\n\n    const transporter = createTransporter(config);\n    await transporter.sendMail(mailOptions);\n    console.log(`Test email sent to ${email}`);\n    return true;\n  } catch (error) {\n    console.error(\"Failed to send test email:\", error);\n    return false;\n  }\n}\n","path":null,"size_bytes":9600,"size_tokens":null},"client/src/pages/tenants.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useTranslation } from \"react-i18next\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogFooter,\n} from \"@/components/ui/dialog\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\nimport { Plus, Pencil, Trash2, Building2, Users, CreditCard, Eye } from \"lucide-react\";\nimport { format } from \"date-fns\";\nimport { useAuth } from \"@/lib/auth-context\";\nimport { useLocation } from \"wouter\";\nimport type { Tenant, Subscription, User } from \"@shared/schema\";\n\ninterface TenantWithDetails extends Tenant {\n  userCount: number;\n  subscription: Subscription | null;\n}\n\nexport default function TenantsPage() {\n  const { t } = useTranslation();\n  const { toast } = useToast();\n  const { user, token, startImpersonation } = useAuth();\n  const [, setLocation] = useLocation();\n  const [isCreateOpen, setIsCreateOpen] = useState(false);\n  const [editingTenant, setEditingTenant] = useState<TenantWithDetails | null>(null);\n  const [deletingTenant, setDeletingTenant] = useState<TenantWithDetails | null>(null);\n  const [formData, setFormData] = useState({ name: \"\", slug: \"\" });\n\n  const { data: tenants, isLoading } = useQuery<TenantWithDetails[]>({\n    queryKey: [\"/api/admin/tenants\"],\n  });\n\n  const createMutation = useMutation({\n    mutationFn: async (data: { name: string; slug: string }) => {\n      return apiRequest(\"POST\", \"/api/admin/tenants\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/tenants\"] });\n      setIsCreateOpen(false);\n      setFormData({ name: \"\", slug: \"\" });\n      toast({ title: t(\"tenants.createSuccess\") });\n    },\n    onError: () => {\n      toast({ title: t(\"tenants.createError\"), variant: \"destructive\" });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: async ({ id, data }: { id: string; data: Partial<Tenant> }) => {\n      return apiRequest(\"PATCH\", `/api/admin/tenants/${id}`, data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/tenants\"] });\n      setEditingTenant(null);\n      setFormData({ name: \"\", slug: \"\" });\n      toast({ title: t(\"tenants.updateSuccess\") });\n    },\n    onError: () => {\n      toast({ title: t(\"tenants.updateError\"), variant: \"destructive\" });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return apiRequest(\"DELETE\", `/api/admin/tenants/${id}`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/tenants\"] });\n      setDeletingTenant(null);\n      toast({ title: t(\"tenants.deleteSuccess\") });\n    },\n    onError: () => {\n      toast({ title: t(\"tenants.deleteError\"), variant: \"destructive\" });\n    },\n  });\n\n  const impersonateMutation = useMutation({\n    mutationFn: async (id: string) => {\n      const data = await apiRequest(\"POST\", `/api/admin/tenants/${id}/impersonate`);\n      return data as { user: User; token: string; tenant: Tenant };\n    },\n    onSuccess: (data: { user: User; token: string; tenant: Tenant }) => {\n      if (user && token) {\n        startImpersonation(data.user, data.token, user, token);\n        toast({ title: t(\"tenants.impersonateSuccess\", { name: data.tenant.name }) });\n        setLocation(\"/dashboard\");\n      }\n    },\n    onError: () => {\n      toast({ title: t(\"tenants.impersonateError\"), variant: \"destructive\" });\n    },\n  });\n\n  const handleImpersonate = (tenantId: string) => {\n    impersonateMutation.mutate(tenantId);\n  };\n\n  const handleCreate = () => {\n    createMutation.mutate(formData);\n  };\n\n  const handleUpdate = () => {\n    if (editingTenant) {\n      updateMutation.mutate({ id: editingTenant.id, data: formData });\n    }\n  };\n\n  const handleDelete = () => {\n    if (deletingTenant) {\n      deleteMutation.mutate(deletingTenant.id);\n    }\n  };\n\n  const openEditDialog = (tenant: TenantWithDetails) => {\n    setEditingTenant(tenant);\n    setFormData({ name: tenant.name, slug: tenant.slug });\n  };\n\n  const getSubscriptionBadge = (subscription: Subscription | null) => {\n    if (!subscription) {\n      return <Badge variant=\"outline\">{t(\"tenants.noSubscription\")}</Badge>;\n    }\n    const variant = subscription.status === \"active\" ? \"default\" : \"secondary\";\n    return <Badge variant={variant}>{subscription.status}</Badge>;\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"p-6 space-y-6\">\n        <Skeleton className=\"h-10 w-48\" />\n        <Skeleton className=\"h-64 w-full\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex items-center justify-between gap-4 flex-wrap\">\n        <div>\n          <h1 className=\"text-2xl font-bold\" data-testid=\"text-page-title\">{t(\"tenants.title\")}</h1>\n          <p className=\"text-muted-foreground\">{t(\"tenants.description\")}</p>\n        </div>\n        <Button onClick={() => setIsCreateOpen(true)} data-testid=\"button-create-tenant\">\n          <Plus className=\"h-4 w-4 mr-2\" />\n          {t(\"tenants.create\")}\n        </Button>\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Building2 className=\"h-5 w-5\" />\n            {t(\"tenants.allTenants\")}\n          </CardTitle>\n          <CardDescription>\n            {t(\"tenants.totalCount\", { count: tenants?.length || 0 })}\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <Table>\n            <TableHeader>\n              <TableRow>\n                <TableHead>{t(\"tenants.name\")}</TableHead>\n                <TableHead>{t(\"tenants.slug\")}</TableHead>\n                <TableHead>{t(\"tenants.code\")}</TableHead>\n                <TableHead>{t(\"tenants.users\")}</TableHead>\n                <TableHead>{t(\"tenants.subscription\")}</TableHead>\n                <TableHead>{t(\"tenants.createdAt\")}</TableHead>\n                <TableHead className=\"text-right\">{t(\"common.actions\")}</TableHead>\n              </TableRow>\n            </TableHeader>\n            <TableBody>\n              {tenants?.map((tenant) => (\n                <TableRow key={tenant.id} data-testid={`row-tenant-${tenant.id}`}>\n                  <TableCell className=\"font-medium\">{tenant.name}</TableCell>\n                  <TableCell className=\"text-muted-foreground\">{tenant.slug}</TableCell>\n                  <TableCell>\n                    <code className=\"bg-muted px-2 py-1 rounded text-sm\" data-testid={`text-tenant-code-${tenant.id}`}>\n                      {tenant.code || \"-\"}\n                    </code>\n                  </TableCell>\n                  <TableCell>\n                    <div className=\"flex items-center gap-1\">\n                      <Users className=\"h-4 w-4 text-muted-foreground\" />\n                      {tenant.userCount}\n                    </div>\n                  </TableCell>\n                  <TableCell>{getSubscriptionBadge(tenant.subscription)}</TableCell>\n                  <TableCell className=\"text-muted-foreground\">\n                    {format(new Date(tenant.createdAt), \"MMM d, yyyy\")}\n                  </TableCell>\n                  <TableCell className=\"text-right\">\n                    <div className=\"flex items-center justify-end gap-1\">\n                      <Button\n                        variant=\"ghost\"\n                        size=\"icon\"\n                        onClick={() => handleImpersonate(tenant.id)}\n                        disabled={impersonateMutation.isPending}\n                        data-testid={`button-view-tenant-${tenant.id}`}\n                        title={t(\"tenants.viewAsTenant\")}\n                      >\n                        <Eye className=\"h-4 w-4\" />\n                      </Button>\n                      <Button\n                        variant=\"ghost\"\n                        size=\"icon\"\n                        onClick={() => openEditDialog(tenant)}\n                        data-testid={`button-edit-tenant-${tenant.id}`}\n                      >\n                        <Pencil className=\"h-4 w-4\" />\n                      </Button>\n                      <Button\n                        variant=\"ghost\"\n                        size=\"icon\"\n                        onClick={() => setDeletingTenant(tenant)}\n                        data-testid={`button-delete-tenant-${tenant.id}`}\n                      >\n                        <Trash2 className=\"h-4 w-4\" />\n                      </Button>\n                    </div>\n                  </TableCell>\n                </TableRow>\n              ))}\n              {(!tenants || tenants.length === 0) && (\n                <TableRow>\n                  <TableCell colSpan={7} className=\"text-center text-muted-foreground py-8\">\n                    {t(\"tenants.noTenants\")}\n                  </TableCell>\n                </TableRow>\n              )}\n            </TableBody>\n          </Table>\n        </CardContent>\n      </Card>\n\n      <Dialog open={isCreateOpen} onOpenChange={setIsCreateOpen}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>{t(\"tenants.createTitle\")}</DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4 py-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"name\">{t(\"tenants.name\")}</Label>\n              <Input\n                id=\"name\"\n                value={formData.name}\n                onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                placeholder={t(\"tenants.namePlaceholder\")}\n                data-testid=\"input-tenant-name\"\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"slug\">{t(\"tenants.slug\")}</Label>\n              <Input\n                id=\"slug\"\n                value={formData.slug}\n                onChange={(e) => setFormData({ ...formData, slug: e.target.value.toLowerCase().replace(/[^a-z0-9-]/g, \"\") })}\n                placeholder={t(\"tenants.slugPlaceholder\")}\n                data-testid=\"input-tenant-slug\"\n              />\n            </div>\n          </div>\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => setIsCreateOpen(false)}>\n              {t(\"common.cancel\")}\n            </Button>\n            <Button onClick={handleCreate} disabled={createMutation.isPending} data-testid=\"button-submit-tenant\">\n              {createMutation.isPending ? t(\"common.saving\") : t(\"common.create\")}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      <Dialog open={!!editingTenant} onOpenChange={() => setEditingTenant(null)}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>{t(\"tenants.editTitle\")}</DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4 py-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"edit-name\">{t(\"tenants.name\")}</Label>\n              <Input\n                id=\"edit-name\"\n                value={formData.name}\n                onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                data-testid=\"input-edit-tenant-name\"\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"edit-slug\">{t(\"tenants.slug\")}</Label>\n              <Input\n                id=\"edit-slug\"\n                value={formData.slug}\n                onChange={(e) => setFormData({ ...formData, slug: e.target.value.toLowerCase().replace(/[^a-z0-9-]/g, \"\") })}\n                data-testid=\"input-edit-tenant-slug\"\n              />\n            </div>\n          </div>\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => setEditingTenant(null)}>\n              {t(\"common.cancel\")}\n            </Button>\n            <Button onClick={handleUpdate} disabled={updateMutation.isPending} data-testid=\"button-update-tenant\">\n              {updateMutation.isPending ? t(\"common.saving\") : t(\"common.save\")}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      <AlertDialog open={!!deletingTenant} onOpenChange={() => setDeletingTenant(null)}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>{t(\"tenants.deleteTitle\")}</AlertDialogTitle>\n            <AlertDialogDescription>\n              {t(\"tenants.deleteDescription\", { name: deletingTenant?.name })}\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>{t(\"common.cancel\")}</AlertDialogCancel>\n            <AlertDialogAction onClick={handleDelete} data-testid=\"button-confirm-delete\">\n              {t(\"common.delete\")}\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </div>\n  );\n}\n","path":null,"size_bytes":13521,"size_tokens":null},"client/src/pages/settings.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useTranslation } from \"react-i18next\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription, CardFooter } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter, DialogDescription } from \"@/components/ui/dialog\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { CreditCard, Database, RefreshCw, Eye, EyeOff, Mail, Send, Plus, Trash2, Edit, Link, TestTube } from \"lucide-react\";\nimport type { ProductConnector } from \"@shared/schema\";\n\ninterface IyzicoConfig {\n  apiKey: string;\n  secretKey: string;\n  baseUrl: string;\n  isTestMode: boolean;\n}\n\ninterface ProductApiConfig {\n  endpoint: string;\n  method: string;\n  headers: string;\n  syncSchedule: string;\n  isEnabled: boolean;\n}\n\ninterface EmailConfig {\n  smtpHost: string;\n  smtpPort: number;\n  smtpUser: string;\n  smtpPass: string;\n  smtpFrom: string;\n  appUrl: string;\n  isEnabled: boolean;\n}\n\ninterface RequestParam {\n  key: string;\n  value: string;\n}\n\ninterface FieldMappings {\n  name: string;\n  image: string;\n  price?: string;\n  sku?: string;\n}\n\ninterface ConnectorFormData {\n  name: string;\n  description: string;\n  isEnabled: boolean;\n  requestMethod: string;\n  requestUrl: string;\n  requestHeaders: Record<string, string>;\n  requestParams: RequestParam[];\n  requestBody: string;\n  responseParser: string;\n  fieldMappings: FieldMappings;\n}\n\nconst emptyConnectorForm: ConnectorFormData = {\n  name: \"\",\n  description: \"\",\n  isEnabled: true,\n  requestMethod: \"GET\",\n  requestUrl: \"\",\n  requestHeaders: {},\n  requestParams: [{ key: \"\", value: \"\" }],\n  requestBody: \"\",\n  responseParser: \"$.data\",\n  fieldMappings: { name: \"name\", image: \"imageUrl\", price: \"price\", sku: \"sku\" },\n};\n\nexport default function SettingsPage() {\n  const { t } = useTranslation();\n  const { toast } = useToast();\n  const [showSecrets, setShowSecrets] = useState(false);\n  const [connectorDialogOpen, setConnectorDialogOpen] = useState(false);\n  const [editingConnector, setEditingConnector] = useState<ProductConnector | null>(null);\n  const [connectorForm, setConnectorForm] = useState<ConnectorFormData>(emptyConnectorForm);\n  const [testQuery, setTestQuery] = useState(\"test\");\n  const [testResults, setTestResults] = useState<any[] | null>(null);\n\n  const [iyzicoForm, setIyzicoForm] = useState<IyzicoConfig>({\n    apiKey: \"\",\n    secretKey: \"\",\n    baseUrl: \"https://sandbox-api.iyzipay.com\",\n    isTestMode: true,\n  });\n\n  const [productApiForm, setProductApiForm] = useState<ProductApiConfig>({\n    endpoint: \"\",\n    method: \"GET\",\n    headers: \"{}\",\n    syncSchedule: \"0 0 * * *\",\n    isEnabled: false,\n  });\n\n  const [emailForm, setEmailForm] = useState<EmailConfig>({\n    smtpHost: \"\",\n    smtpPort: 587,\n    smtpUser: \"\",\n    smtpPass: \"\",\n    smtpFrom: \"noreply@example.com\",\n    appUrl: \"\",\n    isEnabled: false,\n  });\n\n  const { data: settings, isLoading } = useQuery<{\n    iyzico: IyzicoConfig | null;\n    productApi: ProductApiConfig | null;\n    email: EmailConfig | null;\n  }>({\n    queryKey: [\"/api/admin/settings\"],\n  });\n\n  const { data: connectors, isLoading: loadingConnectors } = useQuery<ProductConnector[]>({\n    queryKey: [\"/api/admin/product-connectors\"],\n  });\n\n  useEffect(() => {\n    if (settings?.iyzico) {\n      setIyzicoForm(settings.iyzico);\n    }\n    if (settings?.productApi) {\n      setProductApiForm(settings.productApi);\n    }\n    if (settings?.email) {\n      setEmailForm(settings.email);\n    }\n  }, [settings]);\n\n  const saveIyzicoMutation = useMutation({\n    mutationFn: async (data: IyzicoConfig) => {\n      return apiRequest(\"POST\", \"/api/admin/settings/iyzico\", { value: data });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/settings\"] });\n      toast({ title: t(\"settings.saveSuccess\") });\n    },\n    onError: () => {\n      toast({ title: t(\"settings.saveError\"), variant: \"destructive\" });\n    },\n  });\n\n  const saveProductApiMutation = useMutation({\n    mutationFn: async (data: ProductApiConfig) => {\n      return apiRequest(\"POST\", \"/api/admin/settings/product_api\", { value: data });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/settings\"] });\n      toast({ title: t(\"settings.saveSuccess\") });\n    },\n    onError: () => {\n      toast({ title: t(\"settings.saveError\"), variant: \"destructive\" });\n    },\n  });\n\n  const syncProductsMutation = useMutation({\n    mutationFn: async () => {\n      return apiRequest(\"POST\", \"/api/admin/sync-products\");\n    },\n    onSuccess: () => {\n      toast({ title: t(\"settings.syncSuccess\") });\n    },\n    onError: () => {\n      toast({ title: t(\"settings.syncError\"), variant: \"destructive\" });\n    },\n  });\n\n  const saveEmailMutation = useMutation({\n    mutationFn: async (data: EmailConfig) => {\n      return apiRequest(\"POST\", \"/api/admin/settings/email\", { value: data });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/settings\"] });\n      toast({ title: t(\"settings.saveSuccess\") });\n    },\n    onError: () => {\n      toast({ title: t(\"settings.saveError\"), variant: \"destructive\" });\n    },\n  });\n\n  const testEmailMutation = useMutation({\n    mutationFn: async () => {\n      return apiRequest(\"POST\", \"/api/admin/test-email\");\n    },\n    onSuccess: () => {\n      toast({ title: t(\"settings.testEmailSuccess\") });\n    },\n    onError: () => {\n      toast({ title: t(\"settings.testEmailError\"), variant: \"destructive\" });\n    },\n  });\n\n  const createConnectorMutation = useMutation({\n    mutationFn: async (data: ConnectorFormData) => {\n      return apiRequest(\"POST\", \"/api/admin/product-connectors\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/product-connectors\"] });\n      setConnectorDialogOpen(false);\n      setConnectorForm(emptyConnectorForm);\n      toast({ title: t(\"settings.connectorCreated\") });\n    },\n    onError: () => {\n      toast({ title: t(\"settings.connectorError\"), variant: \"destructive\" });\n    },\n  });\n\n  const updateConnectorMutation = useMutation({\n    mutationFn: async ({ id, data }: { id: string; data: ConnectorFormData }) => {\n      return apiRequest(\"PATCH\", `/api/admin/product-connectors/${id}`, data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/product-connectors\"] });\n      setConnectorDialogOpen(false);\n      setEditingConnector(null);\n      setConnectorForm(emptyConnectorForm);\n      toast({ title: t(\"settings.connectorUpdated\") });\n    },\n    onError: () => {\n      toast({ title: t(\"settings.connectorError\"), variant: \"destructive\" });\n    },\n  });\n\n  const deleteConnectorMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return apiRequest(\"DELETE\", `/api/admin/product-connectors/${id}`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/product-connectors\"] });\n      toast({ title: t(\"settings.connectorDeleted\") });\n    },\n    onError: () => {\n      toast({ title: t(\"settings.connectorError\"), variant: \"destructive\" });\n    },\n  });\n\n  const testConnectorMutation = useMutation({\n    mutationFn: async ({ id, searchQuery }: { id: string; searchQuery: string }) => {\n      return apiRequest(\"POST\", `/api/admin/product-connectors/${id}/test`, { searchQuery });\n    },\n    onSuccess: (data: any) => {\n      setTestResults(data.products || []);\n      toast({ title: t(\"settings.testSuccess\") });\n    },\n    onError: () => {\n      toast({ title: t(\"settings.testError\"), variant: \"destructive\" });\n    },\n  });\n\n  const openConnectorDialog = (connector?: ProductConnector) => {\n    if (connector) {\n      setEditingConnector(connector);\n      setConnectorForm({\n        name: connector.name,\n        description: connector.description || \"\",\n        isEnabled: connector.isEnabled ?? true,\n        requestMethod: connector.requestMethod,\n        requestUrl: connector.requestUrl,\n        requestHeaders: (connector.requestHeaders as Record<string, string>) || {},\n        requestParams: (connector.requestParams as RequestParam[]) || [{ key: \"\", value: \"\" }],\n        requestBody: connector.requestBody || \"\",\n        responseParser: connector.responseParser,\n        fieldMappings: (connector.fieldMappings as FieldMappings) || { name: \"\", image: \"\" },\n      });\n    } else {\n      setEditingConnector(null);\n      setConnectorForm(emptyConnectorForm);\n    }\n    setTestResults(null);\n    setConnectorDialogOpen(true);\n  };\n\n  const handleSaveConnector = () => {\n    const cleanParams = connectorForm.requestParams.filter(p => p.key.trim() !== \"\");\n    const formData = { ...connectorForm, requestParams: cleanParams };\n    \n    if (editingConnector) {\n      updateConnectorMutation.mutate({ id: editingConnector.id, data: formData });\n    } else {\n      createConnectorMutation.mutate(formData);\n    }\n  };\n\n  const addParam = () => {\n    setConnectorForm({\n      ...connectorForm,\n      requestParams: [...connectorForm.requestParams, { key: \"\", value: \"\" }],\n    });\n  };\n\n  const updateParam = (index: number, field: \"key\" | \"value\", value: string) => {\n    const newParams = [...connectorForm.requestParams];\n    newParams[index][field] = value;\n    setConnectorForm({ ...connectorForm, requestParams: newParams });\n  };\n\n  const removeParam = (index: number) => {\n    const newParams = connectorForm.requestParams.filter((_, i) => i !== index);\n    setConnectorForm({ ...connectorForm, requestParams: newParams.length ? newParams : [{ key: \"\", value: \"\" }] });\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"p-6 space-y-6\">\n        <Skeleton className=\"h-10 w-48\" />\n        <Skeleton className=\"h-96 w-full\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div>\n        <h1 className=\"text-2xl font-bold\" data-testid=\"text-page-title\">{t(\"settings.title\")}</h1>\n        <p className=\"text-muted-foreground\">{t(\"settings.description\")}</p>\n      </div>\n\n      <Tabs defaultValue=\"connectors\" className=\"space-y-6\">\n        <TabsList className=\"flex-wrap\">\n          <TabsTrigger value=\"connectors\" data-testid=\"tab-connectors\">\n            <Link className=\"h-4 w-4 mr-2\" />\n            {t(\"settings.productConnectors\")}\n          </TabsTrigger>\n          <TabsTrigger value=\"payment\" data-testid=\"tab-payment\">\n            <CreditCard className=\"h-4 w-4 mr-2\" />\n            {t(\"settings.paymentGateway\")}\n          </TabsTrigger>\n          <TabsTrigger value=\"products\" data-testid=\"tab-products\">\n            <Database className=\"h-4 w-4 mr-2\" />\n            {t(\"settings.productSync\")}\n          </TabsTrigger>\n          <TabsTrigger value=\"email\" data-testid=\"tab-email\">\n            <Mail className=\"h-4 w-4 mr-2\" />\n            {t(\"settings.emailSettings\")}\n          </TabsTrigger>\n        </TabsList>\n\n        <TabsContent value=\"connectors\">\n          <Card>\n            <CardHeader>\n              <div className=\"flex items-center justify-between gap-4 flex-wrap\">\n                <div>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Link className=\"h-5 w-5\" />\n                    {t(\"settings.productConnectorsTitle\")}\n                  </CardTitle>\n                  <CardDescription>{t(\"settings.productConnectorsDescription\")}</CardDescription>\n                </div>\n                <Button onClick={() => openConnectorDialog()} data-testid=\"button-add-connector\">\n                  <Plus className=\"h-4 w-4 mr-2\" />\n                  {t(\"settings.addConnector\")}\n                </Button>\n              </div>\n            </CardHeader>\n            <CardContent>\n              {loadingConnectors ? (\n                <div className=\"space-y-4\">\n                  {[1, 2].map(i => <Skeleton key={i} className=\"h-20 w-full\" />)}\n                </div>\n              ) : connectors?.length ? (\n                <div className=\"space-y-4\">\n                  {connectors.map((connector) => (\n                    <div\n                      key={connector.id}\n                      className=\"flex items-center justify-between gap-4 p-4 rounded-md border\"\n                      data-testid={`connector-item-${connector.id}`}\n                    >\n                      <div className=\"flex-1 min-w-0\">\n                        <div className=\"flex items-center gap-2\">\n                          <span className=\"font-medium truncate\">{connector.name}</span>\n                          <span className={`px-2 py-0.5 text-xs rounded-full ${connector.isEnabled ? \"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200\" : \"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200\"}`}>\n                            {connector.isEnabled ? t(\"common.enabled\") : t(\"common.disabled\")}\n                          </span>\n                        </div>\n                        <p className=\"text-sm text-muted-foreground truncate\">\n                          {connector.requestMethod} {connector.requestUrl}\n                        </p>\n                      </div>\n                      <div className=\"flex items-center gap-2\">\n                        <Button\n                          variant=\"ghost\"\n                          size=\"icon\"\n                          onClick={() => openConnectorDialog(connector)}\n                          data-testid={`button-edit-connector-${connector.id}`}\n                        >\n                          <Edit className=\"h-4 w-4\" />\n                        </Button>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"icon\"\n                          onClick={() => deleteConnectorMutation.mutate(connector.id)}\n                          data-testid={`button-delete-connector-${connector.id}`}\n                        >\n                          <Trash2 className=\"h-4 w-4\" />\n                        </Button>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              ) : (\n                <div className=\"text-center py-8 text-muted-foreground\">\n                  <Link className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n                  <p>{t(\"settings.noConnectors\")}</p>\n                  <p className=\"text-sm\">{t(\"settings.noConnectorsHint\")}</p>\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        <TabsContent value=\"payment\">\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <CreditCard className=\"h-5 w-5\" />\n                {t(\"settings.iyzicoTitle\")}\n              </CardTitle>\n              <CardDescription>{t(\"settings.iyzicoDescription\")}</CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"flex items-center justify-between\">\n                <Label htmlFor=\"test-mode\">{t(\"settings.testMode\")}</Label>\n                <Switch\n                  id=\"test-mode\"\n                  checked={iyzicoForm.isTestMode}\n                  onCheckedChange={(checked) => setIyzicoForm({ ...iyzicoForm, isTestMode: checked })}\n                  data-testid=\"switch-test-mode\"\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"api-key\">{t(\"settings.apiKey\")}</Label>\n                <div className=\"flex gap-2\">\n                  <Input\n                    id=\"api-key\"\n                    type={showSecrets ? \"text\" : \"password\"}\n                    value={iyzicoForm.apiKey}\n                    onChange={(e) => setIyzicoForm({ ...iyzicoForm, apiKey: e.target.value })}\n                    placeholder={t(\"settings.apiKeyPlaceholder\")}\n                    data-testid=\"input-api-key\"\n                  />\n                  <Button\n                    variant=\"outline\"\n                    size=\"icon\"\n                    onClick={() => setShowSecrets(!showSecrets)}\n                    data-testid=\"button-toggle-secrets\"\n                  >\n                    {showSecrets ? <EyeOff className=\"h-4 w-4\" /> : <Eye className=\"h-4 w-4\" />}\n                  </Button>\n                </div>\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"secret-key\">{t(\"settings.secretKey\")}</Label>\n                <Input\n                  id=\"secret-key\"\n                  type={showSecrets ? \"text\" : \"password\"}\n                  value={iyzicoForm.secretKey}\n                  onChange={(e) => setIyzicoForm({ ...iyzicoForm, secretKey: e.target.value })}\n                  placeholder={t(\"settings.secretKeyPlaceholder\")}\n                  data-testid=\"input-secret-key\"\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"base-url\">{t(\"settings.baseUrl\")}</Label>\n                <Input\n                  id=\"base-url\"\n                  value={iyzicoForm.baseUrl}\n                  onChange={(e) => setIyzicoForm({ ...iyzicoForm, baseUrl: e.target.value })}\n                  placeholder=\"https://api.iyzipay.com\"\n                  data-testid=\"input-base-url\"\n                />\n              </div>\n            </CardContent>\n            <CardFooter>\n              <Button\n                onClick={() => saveIyzicoMutation.mutate(iyzicoForm)}\n                disabled={saveIyzicoMutation.isPending}\n                data-testid=\"button-save-iyzico\"\n              >\n                {saveIyzicoMutation.isPending ? t(\"common.saving\") : t(\"common.save\")}\n              </Button>\n            </CardFooter>\n          </Card>\n        </TabsContent>\n\n        <TabsContent value=\"products\">\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Database className=\"h-5 w-5\" />\n                {t(\"settings.productApiTitle\")}\n              </CardTitle>\n              <CardDescription>{t(\"settings.productApiDescription\")}</CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"flex items-center justify-between\">\n                <Label htmlFor=\"sync-enabled\">{t(\"settings.enableSync\")}</Label>\n                <Switch\n                  id=\"sync-enabled\"\n                  checked={productApiForm.isEnabled}\n                  onCheckedChange={(checked) => setProductApiForm({ ...productApiForm, isEnabled: checked })}\n                  data-testid=\"switch-sync-enabled\"\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"endpoint\">{t(\"settings.apiEndpoint\")}</Label>\n                <Input\n                  id=\"endpoint\"\n                  value={productApiForm.endpoint}\n                  onChange={(e) => setProductApiForm({ ...productApiForm, endpoint: e.target.value })}\n                  placeholder=\"https://api.example.com/products\"\n                  data-testid=\"input-endpoint\"\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"method\">{t(\"settings.httpMethod\")}</Label>\n                <Input\n                  id=\"method\"\n                  value={productApiForm.method}\n                  onChange={(e) => setProductApiForm({ ...productApiForm, method: e.target.value })}\n                  placeholder=\"GET\"\n                  data-testid=\"input-method\"\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"headers\">{t(\"settings.headers\")}</Label>\n                <Textarea\n                  id=\"headers\"\n                  value={productApiForm.headers}\n                  onChange={(e) => setProductApiForm({ ...productApiForm, headers: e.target.value })}\n                  placeholder='{\"Authorization\": \"Bearer token\"}'\n                  rows={3}\n                  data-testid=\"input-headers\"\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"schedule\">{t(\"settings.syncSchedule\")}</Label>\n                <Input\n                  id=\"schedule\"\n                  value={productApiForm.syncSchedule}\n                  onChange={(e) => setProductApiForm({ ...productApiForm, syncSchedule: e.target.value })}\n                  placeholder=\"0 0 * * *\"\n                  data-testid=\"input-schedule\"\n                />\n                <p className=\"text-xs text-muted-foreground\">{t(\"settings.cronHint\")}</p>\n              </div>\n            </CardContent>\n            <CardFooter className=\"flex gap-2 flex-wrap\">\n              <Button\n                onClick={() => saveProductApiMutation.mutate(productApiForm)}\n                disabled={saveProductApiMutation.isPending}\n                data-testid=\"button-save-product-api\"\n              >\n                {saveProductApiMutation.isPending ? t(\"common.saving\") : t(\"common.save\")}\n              </Button>\n              <Button\n                variant=\"outline\"\n                onClick={() => syncProductsMutation.mutate()}\n                disabled={syncProductsMutation.isPending || !productApiForm.isEnabled}\n                data-testid=\"button-sync-products\"\n              >\n                <RefreshCw className={`h-4 w-4 mr-2 ${syncProductsMutation.isPending ? \"animate-spin\" : \"\"}`} />\n                {t(\"settings.syncNow\")}\n              </Button>\n            </CardFooter>\n          </Card>\n        </TabsContent>\n\n        <TabsContent value=\"email\">\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Mail className=\"h-5 w-5\" />\n                {t(\"settings.emailTitle\")}\n              </CardTitle>\n              <CardDescription>{t(\"settings.emailDescription\")}</CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"flex items-center justify-between\">\n                <Label htmlFor=\"email-enabled\">{t(\"settings.enableEmail\")}</Label>\n                <Switch\n                  id=\"email-enabled\"\n                  checked={emailForm.isEnabled}\n                  onCheckedChange={(checked) => setEmailForm({ ...emailForm, isEnabled: checked })}\n                  data-testid=\"switch-email-enabled\"\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"smtp-host\">{t(\"settings.smtpHost\")}</Label>\n                <Input\n                  id=\"smtp-host\"\n                  value={emailForm.smtpHost}\n                  onChange={(e) => setEmailForm({ ...emailForm, smtpHost: e.target.value })}\n                  placeholder=\"smtp.example.com\"\n                  data-testid=\"input-smtp-host\"\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"smtp-port\">{t(\"settings.smtpPort\")}</Label>\n                <Input\n                  id=\"smtp-port\"\n                  type=\"number\"\n                  value={emailForm.smtpPort}\n                  onChange={(e) => setEmailForm({ ...emailForm, smtpPort: parseInt(e.target.value) || 587 })}\n                  placeholder=\"587\"\n                  data-testid=\"input-smtp-port\"\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"smtp-user\">{t(\"settings.smtpUser\")}</Label>\n                <div className=\"flex gap-2\">\n                  <Input\n                    id=\"smtp-user\"\n                    type={showSecrets ? \"text\" : \"password\"}\n                    value={emailForm.smtpUser}\n                    onChange={(e) => setEmailForm({ ...emailForm, smtpUser: e.target.value })}\n                    placeholder={t(\"settings.smtpUserPlaceholder\")}\n                    data-testid=\"input-smtp-user\"\n                  />\n                  <Button\n                    variant=\"outline\"\n                    size=\"icon\"\n                    onClick={() => setShowSecrets(!showSecrets)}\n                    data-testid=\"button-toggle-email-secrets\"\n                  >\n                    {showSecrets ? <EyeOff className=\"h-4 w-4\" /> : <Eye className=\"h-4 w-4\" />}\n                  </Button>\n                </div>\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"smtp-pass\">{t(\"settings.smtpPass\")}</Label>\n                <Input\n                  id=\"smtp-pass\"\n                  type={showSecrets ? \"text\" : \"password\"}\n                  value={emailForm.smtpPass}\n                  onChange={(e) => setEmailForm({ ...emailForm, smtpPass: e.target.value })}\n                  placeholder={t(\"settings.smtpPassPlaceholder\")}\n                  data-testid=\"input-smtp-pass\"\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"smtp-from\">{t(\"settings.smtpFrom\")}</Label>\n                <Input\n                  id=\"smtp-from\"\n                  type=\"email\"\n                  value={emailForm.smtpFrom}\n                  onChange={(e) => setEmailForm({ ...emailForm, smtpFrom: e.target.value })}\n                  placeholder=\"noreply@example.com\"\n                  data-testid=\"input-smtp-from\"\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"app-url\">{t(\"settings.appUrl\")}</Label>\n                <Input\n                  id=\"app-url\"\n                  value={emailForm.appUrl}\n                  onChange={(e) => setEmailForm({ ...emailForm, appUrl: e.target.value })}\n                  placeholder=\"https://yourapp.com\"\n                  data-testid=\"input-app-url\"\n                />\n                <p className=\"text-xs text-muted-foreground\">{t(\"settings.appUrlHint\")}</p>\n              </div>\n            </CardContent>\n            <CardFooter className=\"flex gap-2 flex-wrap\">\n              <Button\n                onClick={() => saveEmailMutation.mutate(emailForm)}\n                disabled={saveEmailMutation.isPending}\n                data-testid=\"button-save-email\"\n              >\n                {saveEmailMutation.isPending ? t(\"common.saving\") : t(\"common.save\")}\n              </Button>\n              <Button\n                variant=\"outline\"\n                onClick={() => testEmailMutation.mutate()}\n                disabled={testEmailMutation.isPending || !emailForm.isEnabled}\n                data-testid=\"button-test-email\"\n              >\n                <Send className={`h-4 w-4 mr-2 ${testEmailMutation.isPending ? \"animate-spin\" : \"\"}`} />\n                {t(\"settings.testEmail\")}\n              </Button>\n            </CardFooter>\n          </Card>\n        </TabsContent>\n      </Tabs>\n\n      <Dialog open={connectorDialogOpen} onOpenChange={setConnectorDialogOpen}>\n        <DialogContent className=\"max-w-2xl max-h-[90vh]\">\n          <DialogHeader>\n            <DialogTitle>\n              {editingConnector ? t(\"settings.editConnector\") : t(\"settings.addConnector\")}\n            </DialogTitle>\n            <DialogDescription>\n              {t(\"settings.connectorDialogDescription\")}\n            </DialogDescription>\n          </DialogHeader>\n          <ScrollArea className=\"max-h-[60vh] pr-4\">\n            <div className=\"space-y-4\">\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div className=\"space-y-2\">\n                  <Label>{t(\"settings.connectorName\")}</Label>\n                  <Input\n                    value={connectorForm.name}\n                    onChange={(e) => setConnectorForm({ ...connectorForm, name: e.target.value })}\n                    placeholder={t(\"settings.connectorNamePlaceholder\")}\n                    data-testid=\"input-connector-name\"\n                  />\n                </div>\n                <div className=\"space-y-2 flex flex-col justify-end\">\n                  <div className=\"flex items-center gap-2\">\n                    <Switch\n                      checked={connectorForm.isEnabled}\n                      onCheckedChange={(checked) => setConnectorForm({ ...connectorForm, isEnabled: checked })}\n                      data-testid=\"switch-connector-enabled\"\n                    />\n                    <Label>{t(\"settings.connectorEnabled\")}</Label>\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label>{t(\"settings.connectorDescription\")}</Label>\n                <Input\n                  value={connectorForm.description}\n                  onChange={(e) => setConnectorForm({ ...connectorForm, description: e.target.value })}\n                  placeholder={t(\"settings.connectorDescriptionPlaceholder\")}\n                  data-testid=\"input-connector-description\"\n                />\n              </div>\n\n              <div className=\"grid grid-cols-4 gap-4\">\n                <div className=\"space-y-2\">\n                  <Label>{t(\"settings.requestMethod\")}</Label>\n                  <Select\n                    value={connectorForm.requestMethod}\n                    onValueChange={(value) => setConnectorForm({ ...connectorForm, requestMethod: value })}\n                  >\n                    <SelectTrigger data-testid=\"select-request-method\">\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"GET\">GET</SelectItem>\n                      <SelectItem value=\"POST\">POST</SelectItem>\n                      <SelectItem value=\"PUT\">PUT</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n                <div className=\"col-span-3 space-y-2\">\n                  <Label>{t(\"settings.requestUrl\")}</Label>\n                  <Input\n                    value={connectorForm.requestUrl}\n                    onChange={(e) => setConnectorForm({ ...connectorForm, requestUrl: e.target.value })}\n                    placeholder=\"https://api.example.com/products\"\n                    data-testid=\"input-request-url\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"space-y-2\">\n                <div className=\"flex items-center justify-between\">\n                  <Label>{t(\"settings.requestParams\")}</Label>\n                  <Button variant=\"ghost\" size=\"sm\" onClick={addParam} data-testid=\"button-add-param\">\n                    <Plus className=\"h-4 w-4 mr-1\" />\n                    {t(\"common.add\")}\n                  </Button>\n                </div>\n                <p className=\"text-xs text-muted-foreground\">{t(\"settings.requestParamsHint\")}</p>\n                <div className=\"space-y-2\">\n                  {connectorForm.requestParams.map((param, index) => (\n                    <div key={index} className=\"flex gap-2\">\n                      <Input\n                        value={param.key}\n                        onChange={(e) => updateParam(index, \"key\", e.target.value)}\n                        placeholder={t(\"settings.paramKey\")}\n                        data-testid={`input-param-key-${index}`}\n                      />\n                      <Input\n                        value={param.value}\n                        onChange={(e) => updateParam(index, \"value\", e.target.value)}\n                        placeholder={t(\"settings.paramValue\")}\n                        data-testid={`input-param-value-${index}`}\n                      />\n                      <Button\n                        variant=\"ghost\"\n                        size=\"icon\"\n                        onClick={() => removeParam(index)}\n                        data-testid={`button-remove-param-${index}`}\n                      >\n                        <Trash2 className=\"h-4 w-4\" />\n                      </Button>\n                    </div>\n                  ))}\n                </div>\n              </div>\n\n              {connectorForm.requestMethod !== \"GET\" && (\n                <div className=\"space-y-2\">\n                  <Label>{t(\"settings.requestBody\")}</Label>\n                  <Textarea\n                    value={connectorForm.requestBody}\n                    onChange={(e) => setConnectorForm({ ...connectorForm, requestBody: e.target.value })}\n                    placeholder='{\"query\": \"{{search}}\"}'\n                    rows={3}\n                    data-testid=\"input-request-body\"\n                  />\n                  <p className=\"text-xs text-muted-foreground\">{t(\"settings.requestBodyHint\")}</p>\n                </div>\n              )}\n\n              <div className=\"space-y-2\">\n                <Label>{t(\"settings.responseParser\")}</Label>\n                <Input\n                  value={connectorForm.responseParser}\n                  onChange={(e) => setConnectorForm({ ...connectorForm, responseParser: e.target.value })}\n                  placeholder=\"$.data.products\"\n                  data-testid=\"input-response-parser\"\n                />\n                <p className=\"text-xs text-muted-foreground\">{t(\"settings.responseParserHint\")}</p>\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label>{t(\"settings.fieldMappings\")}</Label>\n                <p className=\"text-xs text-muted-foreground\">{t(\"settings.fieldMappingsHint\")}</p>\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div className=\"space-y-2\">\n                    <Label className=\"text-sm\">{t(\"settings.fieldName\")}</Label>\n                    <Input\n                      value={connectorForm.fieldMappings.name}\n                      onChange={(e) => setConnectorForm({\n                        ...connectorForm,\n                        fieldMappings: { ...connectorForm.fieldMappings, name: e.target.value }\n                      })}\n                      placeholder=\"name\"\n                      data-testid=\"input-field-name\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label className=\"text-sm\">{t(\"settings.fieldImage\")}</Label>\n                    <Input\n                      value={connectorForm.fieldMappings.image}\n                      onChange={(e) => setConnectorForm({\n                        ...connectorForm,\n                        fieldMappings: { ...connectorForm.fieldMappings, image: e.target.value }\n                      })}\n                      placeholder=\"imageUrl\"\n                      data-testid=\"input-field-image\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label className=\"text-sm\">{t(\"settings.fieldPrice\")}</Label>\n                    <Input\n                      value={connectorForm.fieldMappings.price || \"\"}\n                      onChange={(e) => setConnectorForm({\n                        ...connectorForm,\n                        fieldMappings: { ...connectorForm.fieldMappings, price: e.target.value }\n                      })}\n                      placeholder=\"price\"\n                      data-testid=\"input-field-price\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label className=\"text-sm\">{t(\"settings.fieldSku\")}</Label>\n                    <Input\n                      value={connectorForm.fieldMappings.sku || \"\"}\n                      onChange={(e) => setConnectorForm({\n                        ...connectorForm,\n                        fieldMappings: { ...connectorForm.fieldMappings, sku: e.target.value }\n                      })}\n                      placeholder=\"sku\"\n                      data-testid=\"input-field-sku\"\n                    />\n                  </div>\n                </div>\n              </div>\n\n              {editingConnector && (\n                <div className=\"space-y-2 border-t pt-4\">\n                  <Label>{t(\"settings.testConnector\")}</Label>\n                  <div className=\"flex gap-2\">\n                    <Input\n                      value={testQuery}\n                      onChange={(e) => setTestQuery(e.target.value)}\n                      placeholder={t(\"settings.testQueryPlaceholder\")}\n                      data-testid=\"input-test-query\"\n                    />\n                    <Button\n                      variant=\"outline\"\n                      onClick={() => testConnectorMutation.mutate({ id: editingConnector.id, searchQuery: testQuery })}\n                      disabled={testConnectorMutation.isPending}\n                      data-testid=\"button-test-connector\"\n                    >\n                      <TestTube className=\"h-4 w-4 mr-2\" />\n                      {t(\"settings.test\")}\n                    </Button>\n                  </div>\n                  {testResults && (\n                    <div className=\"mt-2 p-3 bg-muted rounded-md\">\n                      <p className=\"text-sm font-medium mb-2\">{t(\"settings.testResults\")} ({testResults.length})</p>\n                      <div className=\"space-y-2 max-h-40 overflow-y-auto\">\n                        {testResults.slice(0, 5).map((product, i) => (\n                          <div key={i} className=\"flex items-center gap-2 text-sm\">\n                            {product.imageUrl && (\n                              <img src={product.imageUrl} alt=\"\" className=\"w-8 h-8 object-cover rounded\" />\n                            )}\n                            <span className=\"truncate\">{product.name}</span>\n                          </div>\n                        ))}\n                        {testResults.length > 5 && (\n                          <p className=\"text-xs text-muted-foreground\">\n                            +{testResults.length - 5} {t(\"common.more\")}\n                          </p>\n                        )}\n                      </div>\n                    </div>\n                  )}\n                </div>\n              )}\n            </div>\n          </ScrollArea>\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => setConnectorDialogOpen(false)}>\n              {t(\"common.cancel\")}\n            </Button>\n            <Button\n              onClick={handleSaveConnector}\n              disabled={createConnectorMutation.isPending || updateConnectorMutation.isPending || !connectorForm.name || !connectorForm.requestUrl}\n              data-testid=\"button-save-connector\"\n            >\n              {(createConnectorMutation.isPending || updateConnectorMutation.isPending) ? t(\"common.saving\") : t(\"common.save\")}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","path":null,"size_bytes":39196,"size_tokens":null},"client/src/pages/setup-tenant.tsx":{"content":"import { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { useMutation, useQuery } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { useTranslation } from \"react-i18next\";\nimport { Building2, Loader2, Users, Plus, Clock, CheckCircle, XCircle, LogOut } from \"lucide-react\";\nimport { useAuth } from \"@/lib/auth-context\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n} from \"@/components/ui/card\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n  FormDescription,\n} from \"@/components/ui/form\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nconst tenantSetupSchema = z.object({\n  name: z.string().min(2, \"Organization name must be at least 2 characters\"),\n  slug: z.string()\n    .min(3, \"Slug must be at least 3 characters\")\n    .max(50, \"Slug must be less than 50 characters\")\n    .regex(/^[a-z0-9-]+$/, \"Slug can only contain lowercase letters, numbers, and hyphens\"),\n});\n\nconst joinTenantSchema = z.object({\n  tenantCode: z.string().min(1, \"Organization code is required\").max(20),\n  message: z.string().max(500).optional(),\n});\n\ntype TenantSetupValues = z.infer<typeof tenantSetupSchema>;\ntype JoinTenantValues = z.infer<typeof joinTenantSchema>;\n\ntype SetupMode = \"choice\" | \"create\" | \"join\";\n\ninterface JoinRequestWithTenant {\n  id: string;\n  userId: string;\n  tenantId: string;\n  status: string;\n  message: string | null;\n  createdAt: string;\n  tenant: { id: string; name: string } | null;\n}\n\nexport default function SetupTenantPage() {\n  const { t } = useTranslation();\n  const { toast } = useToast();\n  const { user, updateUser, logout } = useAuth();\n  const [, setLocation] = useLocation();\n  const [mode, setMode] = useState<SetupMode>(\"choice\");\n\n  const createForm = useForm<TenantSetupValues>({\n    resolver: zodResolver(tenantSetupSchema),\n    defaultValues: {\n      name: \"\",\n      slug: \"\",\n    },\n  });\n\n  const joinForm = useForm<JoinTenantValues>({\n    resolver: zodResolver(joinTenantSchema),\n    defaultValues: {\n      tenantCode: \"\",\n      message: \"\",\n    },\n  });\n\n  const { data: myJoinRequests, isLoading: isLoadingRequests } = useQuery<JoinRequestWithTenant[]>({\n    queryKey: [\"/api/join-requests/my\"],\n  });\n\n  const hasPendingRequest = myJoinRequests?.some(r => r.status === \"pending\");\n\n  const generateSlug = (name: string) => {\n    return name\n      .toLowerCase()\n      .replace(/[^a-z0-9\\s-]/g, \"\")\n      .replace(/\\s+/g, \"-\")\n      .replace(/-+/g, \"-\")\n      .trim();\n  };\n\n  const handleNameChange = (value: string) => {\n    createForm.setValue(\"name\", value);\n    const currentSlug = createForm.getValues(\"slug\");\n    if (!currentSlug || currentSlug === generateSlug(createForm.getValues(\"name\").slice(0, -1))) {\n      createForm.setValue(\"slug\", generateSlug(value));\n    }\n  };\n\n  const setupTenantMutation = useMutation({\n    mutationFn: async (data: TenantSetupValues) => {\n      const response = await apiRequest(\"POST\", \"/api/tenant/setup\", data);\n      return response;\n    },\n    onSuccess: (data: any) => {\n      if (user) {\n        updateUser({ ...user, tenantId: data.tenant.id });\n      }\n      toast({\n        title: t(\"common.success\"),\n        description: \"Organization created successfully!\",\n      });\n      setLocation(\"/dashboard\");\n    },\n    onError: (error: any) => {\n      toast({\n        variant: \"destructive\",\n        title: t(\"common.error\"),\n        description: error.message || \"Failed to create organization\",\n      });\n    },\n  });\n\n  const joinTenantMutation = useMutation({\n    mutationFn: async (data: JoinTenantValues) => {\n      const response = await apiRequest(\"POST\", \"/api/join-requests\", {\n        tenantCode: data.tenantCode.toUpperCase(),\n        message: data.message || null,\n      });\n      return response;\n    },\n    onSuccess: () => {\n      toast({\n        title: t(\"common.success\"),\n        description: \"Join request submitted! The organization admin will review your request.\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/join-requests/my\"] });\n      setMode(\"choice\");\n      joinForm.reset();\n    },\n    onError: (error: any) => {\n      toast({\n        variant: \"destructive\",\n        title: t(\"common.error\"),\n        description: error.message || \"Failed to submit join request\",\n      });\n    },\n  });\n\n  const onCreateSubmit = (data: TenantSetupValues) => {\n    setupTenantMutation.mutate(data);\n  };\n\n  const onJoinSubmit = (data: JoinTenantValues) => {\n    joinTenantMutation.mutate(data);\n  };\n\n  const handleLogout = () => {\n    logout();\n    setLocation(\"/login\");\n  };\n\n  const getStatusBadge = (status: string) => {\n    switch (status) {\n      case \"pending\":\n        return <Badge variant=\"secondary\"><Clock className=\"h-3 w-3 mr-1\" />Pending</Badge>;\n      case \"approved\":\n        return <Badge variant=\"default\"><CheckCircle className=\"h-3 w-3 mr-1\" />Approved</Badge>;\n      case \"rejected\":\n        return <Badge variant=\"destructive\"><XCircle className=\"h-3 w-3 mr-1\" />Rejected</Badge>;\n      default:\n        return <Badge variant=\"outline\">{status}</Badge>;\n    }\n  };\n\n  if (mode === \"create\") {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center p-4 bg-background\">\n        <Card className=\"w-full max-w-md\">\n          <CardHeader className=\"text-center\">\n            <div className=\"mx-auto mb-4 flex h-14 w-14 items-center justify-center rounded-full bg-primary/10\">\n              <Plus className=\"h-7 w-7 text-primary\" />\n            </div>\n            <CardTitle className=\"text-2xl\">Create Your Organization</CardTitle>\n            <CardDescription className=\"text-base\">\n              Create a new organization to get started. You can invite team members later.\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            <Form {...createForm}>\n              <form onSubmit={createForm.handleSubmit(onCreateSubmit)} className=\"space-y-4\">\n                <FormField\n                  control={createForm.control}\n                  name=\"name\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Organization Name</FormLabel>\n                      <FormControl>\n                        <div className=\"relative\">\n                          <Building2 className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n                          <Input\n                            {...field}\n                            onChange={(e) => handleNameChange(e.target.value)}\n                            placeholder=\"Acme Corporation\"\n                            className=\"pl-10\"\n                            data-testid=\"input-org-name\"\n                          />\n                        </div>\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={createForm.control}\n                  name=\"slug\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Organization URL</FormLabel>\n                      <FormControl>\n                        <Input\n                          {...field}\n                          placeholder=\"acme-corporation\"\n                          data-testid=\"input-org-slug\"\n                        />\n                      </FormControl>\n                      <FormDescription>\n                        This will be used in your organization's URL\n                      </FormDescription>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <div className=\"flex flex-col gap-2\">\n                  <Button\n                    type=\"submit\"\n                    className=\"w-full\"\n                    disabled={setupTenantMutation.isPending}\n                    data-testid=\"button-create-org\"\n                  >\n                    {setupTenantMutation.isPending ? (\n                      <Loader2 className=\"h-4 w-4 animate-spin\" />\n                    ) : (\n                      \"Create Organization\"\n                    )}\n                  </Button>\n                  <Button\n                    type=\"button\"\n                    variant=\"ghost\"\n                    className=\"w-full\"\n                    onClick={() => setMode(\"choice\")}\n                    data-testid=\"button-back-to-choice\"\n                  >\n                    Back\n                  </Button>\n                </div>\n              </form>\n            </Form>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  if (mode === \"join\") {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center p-4 bg-background\">\n        <Card className=\"w-full max-w-md\">\n          <CardHeader className=\"text-center\">\n            <div className=\"mx-auto mb-4 flex h-14 w-14 items-center justify-center rounded-full bg-primary/10\">\n              <Users className=\"h-7 w-7 text-primary\" />\n            </div>\n            <CardTitle className=\"text-2xl\">Join an Organization</CardTitle>\n            <CardDescription className=\"text-base\">\n              Enter the organization code provided by your admin to request access.\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            <Form {...joinForm}>\n              <form onSubmit={joinForm.handleSubmit(onJoinSubmit)} className=\"space-y-4\">\n                <FormField\n                  control={joinForm.control}\n                  name=\"tenantCode\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Organization Code</FormLabel>\n                      <FormControl>\n                        <Input\n                          {...field}\n                          onChange={(e) => field.onChange(e.target.value.toUpperCase())}\n                          placeholder=\"ABCD1234\"\n                          className=\"uppercase tracking-wider font-mono text-center text-lg\"\n                          maxLength={20}\n                          data-testid=\"input-tenant-code\"\n                        />\n                      </FormControl>\n                      <FormDescription>\n                        Ask your organization admin for this code\n                      </FormDescription>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={joinForm.control}\n                  name=\"message\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Message (Optional)</FormLabel>\n                      <FormControl>\n                        <Textarea\n                          {...field}\n                          placeholder=\"Hi, I'd like to join your organization...\"\n                          className=\"resize-none\"\n                          rows={3}\n                          data-testid=\"input-join-message\"\n                        />\n                      </FormControl>\n                      <FormDescription>\n                        Include a message for the organization admin\n                      </FormDescription>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <div className=\"flex flex-col gap-2\">\n                  <Button\n                    type=\"submit\"\n                    className=\"w-full\"\n                    disabled={joinTenantMutation.isPending}\n                    data-testid=\"button-submit-join-request\"\n                  >\n                    {joinTenantMutation.isPending ? (\n                      <Loader2 className=\"h-4 w-4 animate-spin\" />\n                    ) : (\n                      \"Request to Join\"\n                    )}\n                  </Button>\n                  <Button\n                    type=\"button\"\n                    variant=\"ghost\"\n                    className=\"w-full\"\n                    onClick={() => setMode(\"choice\")}\n                    data-testid=\"button-back-to-choice-join\"\n                  >\n                    Back\n                  </Button>\n                </div>\n              </form>\n            </Form>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center p-4 bg-background\">\n      <div className=\"w-full max-w-2xl space-y-6\">\n        <Card>\n          <CardHeader className=\"text-center\">\n            <div className=\"mx-auto mb-4 flex h-14 w-14 items-center justify-center rounded-full bg-primary/10\">\n              <Building2 className=\"h-7 w-7 text-primary\" />\n            </div>\n            <CardTitle className=\"text-2xl\">Welcome to eBrochure</CardTitle>\n            <CardDescription className=\"text-base\">\n              To get started, create a new organization or join an existing one.\n            </CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <Card \n                className=\"cursor-pointer transition-all hover-elevate\"\n                onClick={() => setMode(\"create\")}\n                data-testid=\"card-create-org\"\n              >\n                <CardContent className=\"pt-6 text-center\">\n                  <div className=\"mx-auto mb-4 flex h-12 w-12 items-center justify-center rounded-full bg-primary/10\">\n                    <Plus className=\"h-6 w-6 text-primary\" />\n                  </div>\n                  <h3 className=\"font-semibold text-lg mb-2\">Create Organization</h3>\n                  <p className=\"text-sm text-muted-foreground\">\n                    Start fresh with a new organization and invite your team\n                  </p>\n                </CardContent>\n              </Card>\n\n              <Card \n                className=\"cursor-pointer transition-all hover-elevate\"\n                onClick={() => setMode(\"join\")}\n                data-testid=\"card-join-org\"\n              >\n                <CardContent className=\"pt-6 text-center\">\n                  <div className=\"mx-auto mb-4 flex h-12 w-12 items-center justify-center rounded-full bg-primary/10\">\n                    <Users className=\"h-6 w-6 text-primary\" />\n                  </div>\n                  <h3 className=\"font-semibold text-lg mb-2\">Join Organization</h3>\n                  <p className=\"text-sm text-muted-foreground\">\n                    Enter an organization code to request access\n                  </p>\n                </CardContent>\n              </Card>\n            </div>\n\n            <div className=\"text-center pt-2\">\n              <Button \n                variant=\"ghost\" \n                size=\"sm\" \n                onClick={handleLogout}\n                data-testid=\"button-logout\"\n              >\n                <LogOut className=\"h-4 w-4 mr-2\" />\n                Sign out\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n\n        {isLoadingRequests ? (\n          <div className=\"flex justify-center py-4\">\n            <Loader2 className=\"h-6 w-6 animate-spin text-muted-foreground\" />\n          </div>\n        ) : myJoinRequests && myJoinRequests.length > 0 ? (\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"text-lg\">Your Join Requests</CardTitle>\n              <CardDescription>\n                Track the status of your requests to join organizations\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-3\">\n                {myJoinRequests.map((request) => (\n                  <div \n                    key={request.id} \n                    className=\"flex items-center justify-between p-3 rounded-md bg-muted/50\"\n                    data-testid={`join-request-${request.id}`}\n                  >\n                    <div className=\"flex items-center gap-3\">\n                      <Building2 className=\"h-5 w-5 text-muted-foreground\" />\n                      <div>\n                        <p className=\"font-medium\" data-testid={`text-org-name-${request.id}`}>\n                          {request.tenant?.name || \"Unknown Organization\"}\n                        </p>\n                        <p className=\"text-sm text-muted-foreground\">\n                          Requested {new Date(request.createdAt).toLocaleDateString()}\n                        </p>\n                      </div>\n                    </div>\n                    {getStatusBadge(request.status)}\n                  </div>\n                ))}\n              </div>\n              {hasPendingRequest && (\n                <p className=\"text-sm text-muted-foreground mt-4 text-center\">\n                  Your request is being reviewed. The organization admin will approve or reject it.\n                </p>\n              )}\n            </CardContent>\n          </Card>\n        ) : null}\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":17425,"size_tokens":null},"client/src/pages/verify-email.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { Link, useLocation, useSearch } from \"wouter\";\nimport { CheckCircle, XCircle, Loader2, Mail } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { ThemeToggle } from \"@/components/theme-toggle\";\nimport { LanguageSelector } from \"@/components/language-selector\";\nimport { useMutation, useQuery } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\n\nexport default function VerifyEmailPage() {\n  const { t } = useTranslation();\n  const search = useSearch();\n  const params = new URLSearchParams(search);\n  const token = params.get(\"token\");\n  const [verificationStatus, setVerificationStatus] = useState<\"loading\" | \"success\" | \"error\">(\"loading\");\n  const [errorMessage, setErrorMessage] = useState(\"\");\n\n  const { data, isLoading, error } = useQuery({\n    queryKey: [\"/api/auth/verify-email\", token],\n    queryFn: async () => {\n      if (!token) {\n        throw new Error(\"No verification token provided\");\n      }\n      const response = await fetch(`/api/auth/verify-email?token=${token}`);\n      const data = await response.json();\n      if (!response.ok) {\n        throw new Error(data.error || \"Verification failed\");\n      }\n      return data;\n    },\n    enabled: !!token,\n    retry: false,\n  });\n\n  useEffect(() => {\n    if (data?.verified) {\n      setVerificationStatus(\"success\");\n    } else if (error) {\n      setVerificationStatus(\"error\");\n      setErrorMessage((error as Error).message);\n    } else if (!token) {\n      setVerificationStatus(\"error\");\n      setErrorMessage(\"No verification token provided\");\n    }\n  }, [data, error, token]);\n\n  return (\n    <div className=\"min-h-screen flex\">\n      <div className=\"hidden lg:flex lg:w-2/5 bg-gradient-to-br from-primary/90 to-primary/70 p-12 flex-col justify-between relative overflow-hidden\">\n        <div className=\"absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA2MCA2MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxnIGZpbGw9IiNmZmZmZmYiIGZpbGwtb3BhY2l0eT0iMC4wNSI+PHBhdGggZD0iTTM2IDM0djZoLTZ2LTZoNnptLTYtNnY2aC02di02aDZ6bTEyLTZ2Nmg2di02aC02em0tNiAwdi02aDZ2Nmg2djZoLTZ2NmgtNnYtNmgtNnYtNmg2em0tMTIgMHY2aC02di02aDZ6bTAgMTJ2LTZoNnY2aC02em0xMiAxMnYtNmg2djZoLTZ6Ii8+PC9nPjwvZz48L3N2Zz4=')] opacity-50\" />\n        <div className=\"relative z-10\">\n          <div className=\"flex items-center gap-3 mb-8\">\n            <div className=\"flex h-12 w-12 items-center justify-center rounded-lg bg-white/20 text-white font-bold text-xl backdrop-blur-sm\">\n              eB\n            </div>\n            <span className=\"text-white font-bold text-2xl\">{t(\"app.name\")}</span>\n          </div>\n          <h1 className=\"text-4xl font-bold text-white mb-4\">\n            Email Verification\n          </h1>\n          <p className=\"text-white/80 text-lg\">\n            Verify your email address to activate your account and start creating professional digital brochures.\n          </p>\n        </div>\n      </div>\n\n      <div className=\"flex-1 flex flex-col\">\n        <div className=\"flex justify-end items-center gap-2 p-4\">\n          <LanguageSelector />\n          <ThemeToggle />\n        </div>\n        \n        <div className=\"flex-1 flex items-center justify-center p-8\">\n          <Card className=\"w-full max-w-md\">\n            <CardHeader className=\"text-center\">\n              <div className=\"flex justify-center mb-4\">\n                {isLoading ? (\n                  <div className=\"flex h-16 w-16 items-center justify-center rounded-full bg-muted\">\n                    <Loader2 className=\"h-8 w-8 animate-spin text-muted-foreground\" />\n                  </div>\n                ) : verificationStatus === \"success\" ? (\n                  <div className=\"flex h-16 w-16 items-center justify-center rounded-full bg-green-100 dark:bg-green-900/30\">\n                    <CheckCircle className=\"h-8 w-8 text-green-600 dark:text-green-400\" />\n                  </div>\n                ) : (\n                  <div className=\"flex h-16 w-16 items-center justify-center rounded-full bg-red-100 dark:bg-red-900/30\">\n                    <XCircle className=\"h-8 w-8 text-red-600 dark:text-red-400\" />\n                  </div>\n                )}\n              </div>\n              <CardTitle className=\"text-2xl font-semibold\">\n                {isLoading ? \"Verifying Email...\" : verificationStatus === \"success\" ? \"Email Verified\" : \"Verification Failed\"}\n              </CardTitle>\n              <CardDescription>\n                {isLoading \n                  ? \"Please wait while we verify your email address.\"\n                  : verificationStatus === \"success\"\n                  ? \"Your email has been verified successfully. You can now log in to your account.\"\n                  : errorMessage\n                }\n              </CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              {!isLoading && (\n                <Link href=\"/login\" className=\"block\">\n                  <Button className=\"w-full\" data-testid=\"button-go-to-login\">\n                    {verificationStatus === \"success\" ? \"Go to Login\" : \"Back to Login\"}\n                  </Button>\n                </Link>\n              )}\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":5538,"size_tokens":null},"client/src/pages/organization-settings.tsx":{"content":"import { useState, useRef } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useAuth } from \"@/lib/auth-context\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Upload, Building2, Loader2, Trash2 } from \"lucide-react\";\nimport type { Tenant } from \"@shared/schema\";\n\ninterface TenantInfo extends Tenant {\n  code: string;\n}\n\nexport default function OrganizationSettingsPage() {\n  const { t } = useTranslation();\n  const { toast } = useToast();\n  const { user, token } = useAuth();\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const [isUploading, setIsUploading] = useState(false);\n\n  const { data: tenantInfo, isLoading } = useQuery<TenantInfo>({\n    queryKey: [\"/api/tenant/current\"],\n  });\n\n  const uploadLogoMutation = useMutation({\n    mutationFn: async (file: File) => {\n      const formData = new FormData();\n      formData.append(\"logo\", file);\n      \n      const response = await fetch(\"/api/tenant/logo\", {\n        method: \"POST\",\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n        body: formData,\n      });\n      \n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || \"Failed to upload logo\");\n      }\n      \n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/tenant/current\"] });\n      toast({\n        title: t(\"common.success\"),\n        description: t(\"organizationSettings.logoUploadSuccess\"),\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: t(\"common.error\"),\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const removeLogoMutation = useMutation({\n    mutationFn: async () => {\n      return apiRequest(\"DELETE\", \"/api/tenant/logo\");\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/tenant/current\"] });\n      toast({\n        title: t(\"common.success\"),\n        description: t(\"organizationSettings.logoRemoveSuccess\"),\n      });\n    },\n    onError: () => {\n      toast({\n        title: t(\"common.error\"),\n        description: t(\"organizationSettings.logoRemoveError\"),\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      if (file.size > 5 * 1024 * 1024) {\n        toast({\n          title: t(\"common.error\"),\n          description: t(\"organizationSettings.fileTooLarge\"),\n          variant: \"destructive\",\n        });\n        return;\n      }\n      \n      const allowedTypes = [\"image/jpeg\", \"image/png\", \"image/gif\", \"image/webp\"];\n      if (!allowedTypes.includes(file.type)) {\n        toast({\n          title: t(\"common.error\"),\n          description: t(\"organizationSettings.invalidFileType\"),\n          variant: \"destructive\",\n        });\n        return;\n      }\n      \n      setIsUploading(true);\n      uploadLogoMutation.mutate(file, {\n        onSettled: () => {\n          setIsUploading(false);\n          if (fileInputRef.current) {\n            fileInputRef.current.value = \"\";\n          }\n        },\n      });\n    }\n  };\n\n  const handleUploadClick = () => {\n    fileInputRef.current?.click();\n  };\n\n  const handleRemoveLogo = () => {\n    removeLogoMutation.mutate();\n  };\n\n  const isAdmin = user?.role === \"tenant_admin\" || user?.role === \"super_admin\";\n\n  if (!isAdmin) {\n    return (\n      <div className=\"flex flex-col h-full\">\n        <div className=\"flex items-center justify-between gap-4 p-6 border-b\">\n          <h1 className=\"text-2xl font-semibold\" data-testid=\"text-page-title\">\n            {t(\"organizationSettings.title\")}\n          </h1>\n        </div>\n        <div className=\"flex-1 flex items-center justify-center\">\n          <p className=\"text-muted-foreground\">{t(\"common.accessDenied\")}</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (isLoading) {\n    return (\n      <div className=\"flex flex-col h-full\">\n        <div className=\"flex items-center justify-between gap-4 p-6 border-b\">\n          <h1 className=\"text-2xl font-semibold\" data-testid=\"text-page-title\">\n            {t(\"organizationSettings.title\")}\n          </h1>\n        </div>\n        <div className=\"flex-1 flex items-center justify-center\">\n          <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"flex flex-col h-full\">\n      <div className=\"flex items-center justify-between gap-4 p-6 border-b\">\n        <h1 className=\"text-2xl font-semibold\" data-testid=\"text-page-title\">\n          {t(\"organizationSettings.title\")}\n        </h1>\n      </div>\n\n      <div className=\"flex-1 overflow-auto p-6\">\n        <div className=\"max-w-2xl space-y-6\">\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Building2 className=\"h-5 w-5\" />\n                {t(\"organizationSettings.organizationInfo\")}\n              </CardTitle>\n              <CardDescription>\n                {t(\"organizationSettings.organizationInfoDesc\")}\n              </CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div>\n                <label className=\"text-sm font-medium text-muted-foreground\">\n                  {t(\"organizationSettings.organizationName\")}\n                </label>\n                <p className=\"text-lg font-medium\" data-testid=\"text-org-name\">\n                  {tenantInfo?.name}\n                </p>\n              </div>\n              {tenantInfo?.code && (\n                <div>\n                  <label className=\"text-sm font-medium text-muted-foreground\">\n                    {t(\"organizationSettings.organizationCode\")}\n                  </label>\n                  <p className=\"text-lg font-mono\" data-testid=\"text-org-code\">\n                    {tenantInfo.code}\n                  </p>\n                </div>\n              )}\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader>\n              <CardTitle>{t(\"organizationSettings.logoTitle\")}</CardTitle>\n              <CardDescription>\n                {t(\"organizationSettings.logoDesc\")}\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex items-start gap-6\">\n                <Avatar className=\"h-24 w-24 rounded-md\">\n                  {tenantInfo?.logoUrl ? (\n                    <AvatarImage \n                      src={tenantInfo.logoUrl} \n                      alt={tenantInfo.name}\n                      className=\"object-cover\"\n                      data-testid=\"img-org-logo\"\n                    />\n                  ) : null}\n                  <AvatarFallback className=\"rounded-md bg-muted text-2xl\">\n                    {tenantInfo?.name?.slice(0, 2).toUpperCase()}\n                  </AvatarFallback>\n                </Avatar>\n\n                <div className=\"flex flex-col gap-3\">\n                  <input\n                    ref={fileInputRef}\n                    type=\"file\"\n                    accept=\"image/jpeg,image/png,image/gif,image/webp\"\n                    onChange={handleFileSelect}\n                    className=\"hidden\"\n                    data-testid=\"input-logo-file\"\n                  />\n                  \n                  <Button\n                    onClick={handleUploadClick}\n                    disabled={isUploading || uploadLogoMutation.isPending}\n                    data-testid=\"button-upload-logo\"\n                  >\n                    {isUploading || uploadLogoMutation.isPending ? (\n                      <>\n                        <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" />\n                        {t(\"common.uploading\")}\n                      </>\n                    ) : (\n                      <>\n                        <Upload className=\"h-4 w-4 mr-2\" />\n                        {t(\"organizationSettings.uploadLogo\")}\n                      </>\n                    )}\n                  </Button>\n\n                  {tenantInfo?.logoUrl && (\n                    <Button\n                      variant=\"outline\"\n                      onClick={handleRemoveLogo}\n                      disabled={removeLogoMutation.isPending}\n                      data-testid=\"button-remove-logo\"\n                    >\n                      {removeLogoMutation.isPending ? (\n                        <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" />\n                      ) : (\n                        <Trash2 className=\"h-4 w-4 mr-2\" />\n                      )}\n                      {t(\"organizationSettings.removeLogo\")}\n                    </Button>\n                  )}\n\n                  <p className=\"text-xs text-muted-foreground\">\n                    {t(\"organizationSettings.logoRequirements\")}\n                  </p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":9361,"size_tokens":null}},"version":2}